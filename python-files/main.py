import os
import hashlib
import argparse
import sys
import json
import requests
from colorama import init, Fore, Style
from datetime import datetime

init(autoreset=True)

# Definisani URL-ovi
LICENSE_KEYS_URL = "https://raw.githubusercontent.com/decrypted6532/bsprovere/main/license.json"
DISCORD_WEBHOOK_URL = "https://discord.com/api/webhooks/obrisano"
IMAGE_URL = "https://i.imgur.com/42lc901.png"
IMAGE_DIVIDER = "https://i.imgur.com/64wEbo2.png"

def fetch_license_keys(url):
    try:
        response = requests.get(url)
        response.raise_for_status()  # Prikazivanje error code-a u slučaju greške
        license_keys = response.text.strip().split('\n')  
        return set(license_keys)  
    except requests.RequestException:
        print(Fore.RED + "Došlo je do greške prilikom preuzimanja licence.")
        sys.exit(1)

def check_license_key(license_key, license_keys):
    if license_key in license_keys:
        print(Fore.GREEN + "Licensa je tačna. Proces skeniranja je pokrenut.")
        send_initial_message("**Proces skeniranja je pokrenut. Licensa je tačna.**", license_key, image_url=IMAGE_URL)
        return True
    else:
        print(Fore.RED + "Licensa za korišćenje je neispravna. IP adresa i podaci o računaru su uspešno prosleđeni na siguran server. Pokušavanje reverse engineering-a nad programom za provere može dovesti do blackliste servera.")
        send_initial_message("**Proces skeniranja je pokrenut. Licensa je pogrešna.**", license_key, image_url=IMAGE_URL)
        return False

def send_initial_message(message, license_key, image_url=None):
    ip_address = get_public_ip_address()
    current_time = datetime.now().strftime("%d.%m.%Y %H:%M")
    embed = {
        "title": "Skeniranje započeto",
        "description": message,
        "color": 0x0792f4,
        "fields": [
            {"name": "License Key:", "value": license_key, "inline": False},
            {"name": "IP Adresa:", "value": ip_address, "inline": False},
            {"name": "Vreme Skeniranja:", "value": current_time, "inline": False}
        ],
        "image": {"url": image_url} if image_url else None
    }
    
    data = {
        "embeds": [embed]
    }
    
    try:
        response = requests.post(DISCORD_WEBHOOK_URL, json=data)
        response.raise_for_status()
    except requests.RequestException as e:
        print(Fore.RED + f"GL1")

def send_scan_results(scan_results):
    current_time = datetime.now().strftime("%d.%m.%Y %H:%M")
    embed = {
        "title": "Rezultati Skeniranja",
        "description": scan_results,
        "color": 0x0792f4,
        "fields": [
            {"name": "Vreme Skeniranja:", "value": current_time, "inline": False}
        ],
        "image": {"url": IMAGE_DIVIDER}
    }
    
    data = {
        "embeds": [embed]
    }
    
    try:
        response = requests.post(DISCORD_WEBHOOK_URL, json=data)
        response.raise_for_status()
    except requests.RequestException as e:
        print(Fore.RED + f"GL2")

def get_public_ip_address():
    try:
        response = requests.get('https://api.ipify.org?format=json')
        response.raise_for_status()
        ip_data = response.json()
        return ip_data['ip']
    except requests.RequestException:
        return "Nepoznata"

HASHES = ["DE54307D78E030189CE38077609A40915299A3661F51D697F0EE9D468B34FD02",
    "7897C7B6F3071ED7CA7B9E14134A2054C0164830B128D03C639469BFBA8FC52A",
    "194BFB5C0F00846A0F514E3A8FD285DF02AE08315FDEC8086A3C7D66ECBBE628",
    "2142D05D509E926FEEBE48FB8403FDBCCF5E7D0F62CE668D2E2DCE24610FAF16",
    "564CCE5E981F0FD113680440F44741B12CAEB2E9377FF3056DCFF43CB421774E",
    "7457E3A75A2167C63B8795F2CD4C4958E7C2BC7727DD3A112AA49A1035B210B4",
    "F71295D216D25D168FE7E4A131E8E4E739E70415EC45C969C690F7B185EC936C",
    "32F8B8F639D295DF0E3C565A12F3EE80FEFF7CA2C7E6C0B2C1A13E954466C816",
    "4250EB73C148C7914D9F0A52AC08C1AB001DB7D62EF5367813D8C60186D31111",
    "3AF8C0FEA2B83EDFE4FCDC3536417649D888CA214C58E5112F368818ECFDD86C",
    "89D9612B0B5C27E10C390892F3AF534815D7FA1C53748895A3DBA0CC85D115D2",
    "22ADFBB2B5480933C08639D68383C3A9DC6651E695BEAFF7A46E7B4E2C35C934",
    "FE008B72FE9C248C83C09F31B5F2911B479192DC5FB290D318CDE7F26EB3E90B",
    "70BA3DD70D9744A453AD211EE1D9FAFBA0EC815A61D52357ED9FA3C073F72111",
    "39244740A356514477AF4B6CFC3A0191776B551874976E73C232C2BA3BC0D60A",
    "FAE8C4B75EEE972B76186FA0C4D430F8D1D5DA9DC2BB030854E69841D8E43C13",
    "E202692D35BDB2371AE06A57BF5D2A0541279F0CB39CC5617110E496B19E3199",
    "DC9C968B3C865671026D9D2A161DAACFAA1AC4283CDE08913C7FDC06F6197400",
    "46A27F8D468551804E75064974676C2D1BC94D411F0F63D91D359E768CAF7911",
    "70996528F309534DAE8D6359D26A1DF8D60D9B5AFB6F008D988186C45CA3637A",
    "A303A9200A45F69AA61B98BA77120C29313D9EDAC1589F99B475FA0C6F447E27",
    "CB12D523A05534F0F26FAFB7A0B2B2393C19AD1705155D2C213A64EA990F17D5",
    "6527894E49F5C85B14649ED27112B59B872A3D2661F2F735E4B12982EAF1A247",
    "93151A91A889570923931D727AB3970C3CFBDFB0BD9D4D851A5ED1C19B75028A",
    "697E080725BA3ACA5CD0B2FD1FE93EC96A5C5DB91F44FC61E54B93DCFFE8848F",
    "D665AED220156EB6713DDA0489E1C88725E5CB347A3833955C40D73514D0772B",
    "D9DE1E973525BC8B5BB96AC92B7C7E10E6BE12ED16171C6FC6D8CB45447B4647",
    "6511DF594D68BFB1436A39FE1B8D406F078BB7644B6AA2BB2D0A34176E7DEDD0",
    "46E5E98163BCF1585356E8AFC2750256BE04F89305CA96455DA1700FC20F04E6",
    "DCA6D05062E0F9426C1FB57D609FDD8320696F791A2B47115C657DCF29BFADAC",
    "05F49B3D89E067241B7DE0031F51EDAAEC33D2852CD5CFDA69D8429B80D2737B",
    "73EB81709A200CA5713D8A6AB1729B3E2216A21ECB6E8B4BC728C2A27347A78A",
    "335401F559AF9E80560DA8FCD9497C4B8523D1AEF34AD7F82BBE2F675122F636",
    "8F432D7A9E5DBAA40BC65129B18CBB7379B5BBD85CF67820402844F5E7F6BF49",
    "35584648D1BC7080BA26111C667F355FE6B17A2119A3015253BEEF39B726A473",
    "11774EEAF26B2D20F4F17E396A80C772D0BAC164FFE4470A564DECCC91D9BD88",
    "FC085FB674B70A232D8464FBE521DE10DA028422AB4E12DC5C9A2F6DE7FDCA16",
    "ED313F1B7C0AC1A6EF22C0F8E1EEE6DB40E8E1A3A2E475F6DC927740387B2D58",
    "555CA10871D19BFED4A59EB0563568C034964B67936137A626E14DA73EF6F261",
    "DD60C08BBEB6B4E06F8546FCB515A8726AD81314983476855B0113785203984B",
    "5B85D7E87A191F14D8F893C4694317BA4FB9B50F50CF7E1090AAF29443A95F95",
    "D800EEBB31260593A72540EC975BD475C9D15F800EDA4A4D7DD9469EDA19FF79",
    "7188855A48DD4FB9FE1B66F57D48E5298D07A28512E285E096133F396FA6407B",
    "6B85B93028D99D6354517EC5B048506258C45BF2D4E8F14C4DC17E5595C35FD1",
    "020A4923452B6C13B3099E3FF5B536D1D5AA06BFBCBD3F28A88D69738FEE62E4",
    "52D5A68843ED639555E2973C551B70763B090ADAB458CFA89CF7CDE4B6965EE3",
    "55C7689C9D658317B51AC21EA4DE3A21A43558D6FA677BE7CAD335CA479F92F0",
    "70BA3DD70D9744A453AD211EE1D9FAFBA0EC815A61D52357ED9FA3C073F72111",
    "B2FF0A199B503A8AE1BF96103C4B617A966147473F42B3561A65D15E8F12A4A9",
    "5DE6101B196EF57E1D644BFD1BF9E423E333E69B48B2E85AADEC17ADC05C3FF2",
    "46C35485AA7F815D18CC249AB5F814E704B6D35B3AB90913A80CE6E02BD899F3",
    "622E75F30517D057BE05FA4863FBF1D5435E4F79092A803DECD62D9DEF0E594B",
    "B5BF542F14C7B1F65B77F56913B6E9425E743FE82F4E50116897BB9FC4B6340D",
    "57AB7C5E80FAE29D178F9B99DA95728C71E607FE5CE715B166359548172835B9",
    "EC29CBD8853F9CE8839704692B71B29076F374F30A18EEE960288F6FDDF95BBC",
    "AD601A065D79A96ED6BC7F731712777774FCD071D834FD4C376ED70E617AD621",
    "DADD053208AF345CD7B38ED2DD22E33F1FA5DC17A11F0B5EECE2705D76F04F6C",
    "BA0C455F0DC32ACFD752F998F1D7B83945AD14C84B66A8B13BB3926C147DF2FE",
    "5D839420450962904C7FEB6EF54826C588B2BB75A44A267B317867B56E7B097D",
    "4433E1ABB2919325ED985C6BE20B2FED427BF7D9B7FF19737345C5FFF110C19D",
    "A75BA35281B0FF47805E92CDF15D04D21496C6FC11DD1EE6C08453DA57038764",
    "42D4955F025B59031C93199C160D20CFC7A6AECF0F8B63546E7D28F0DD251BF3",
    "E19BF0A72F08DE19A222EA56ABF04C01CF2788925ED8B668E90809735F1237FF",
    "63B3AB95449C92AA18A9A2244646FDF0456197AA4D96F7D59E83C11E7D3F813F",
    "F9051596F4DAF91E3416498B78A617AFF5048E268E0C9ACFC43FA5A8FF0CF3B5",
    "8B47CF51343112773B2B8E3E9B3C9BEAD796D7804727E52F321E094630E42954",
    "62802013F3D8A7D787D72D96945E0E091FB09C3134A64950C1BC41A44D98584D",
    "09B5D31BBD3D7CC977230789A8BBCD67A7ACB7DEBDF075FF5649166DA2263F6C",
    "B98257F90DC639705DB232D70F74E90CCB9507DAF37A654F6065A0190600ECA1",
    "811362BA9E4558F51063DA53F2B871B3F2D300FE08783A6A601656136F9C135A",
    "4239453CFF87F776012A5E801FFEE0F5CA6DE2DDBD1040DE3A73AD8C2251EE4C",
    "7B2919D9935020F6A4B3CC2A62AE4F542AA3F922D24501DD8C5BBECE45E9A8B4",
    "6EE2EC17986CBEDBC436CBC9C0C9CFF20AF3E8BB317EE675055917418A3E68CB",
    "BF0E882B13BFFD4678A153406F3B843EE79C6843A0006C641E34764DC8C3CB92",
    "39B79C0E7AC1DF0DD6BA981F426D1964BA31F3034D975CD61191CE1BAC9F3F11",
    "F54E93197EB72BB69262A7229885D06F8D30BB3C2584B9DFCB25BA63EFE9BB42",
    "C6A02BA1A1393A6D19B4E55F6CD29390330CF42370F29928C04A8B6422983412",
    "0E412206EAF33358899DF9747888C73D03EC7EFFF4E97D5847F942D53FA3D8C6",
    "A8AAE0716DABF4AF7CFA923EA3A5F53DC3B5338DE84057449F4A73D346AB5FF0",
    "407CB8C42105016853DDBF569537F3E75F3289166F50AE2369347CD5996717F0",
    "A51F9C33891AC132169B2B53F80284869BEF22F40123954B72558B45B5D4722F",
    "7F75887CFDA888155623FADFAECE1100CE3D235A7A73FA8E86D948E006A5060A",
    "194BFB5C0F00846A0F514E3A8FD285DF02AE08315FDEC8086A3C7D66ECBBE628",
    "5848B2156CC8C38E540AEC066186771BFA8FFC6D0BD98D7470570BE389713D99",
    "E702994511210AD6410EF5F4293D84EE40FEB9657DD323A5E5CA2C36819EA3FE",
    "2CE7B030128E6E6A2FA41D8811EAB2781CEBC56F9DDACD775257BEB58C3D470A",
    "CE343A364FF1D9E7A965BFD0D95B1C3B231663D30320EC6CC2182418A51A159B",
    "E91FBBA4DFD0AEDDDCD2509AA5DB53F78E605C4AB523C0BDD6DF2D590DC45404",
    "E91FBBA4DFD0AEDDDCD2509AA5DB53F78E605C4AB523C0BDD6DF2D590DC45404",
    "A623F6353F378CA6422841189BFE98C01A31FDF9964E4EAC62E8A9C7AE9080E3",
    "930C57B4E6579E4F9A18B891ECA8CBB95A3FE83CFED8778D297B63F7C25F0B32",
    "76D588683AB1BD0D583DE3767057EDA7FB172C13B6DFDF43BA30F59F0C49BA64",
    "76D588683AB1BD0D583DE3767057EDA7FB172C13B6DFDF43BA30F59F0C49BA64",
    "B01163A5FDFC616B76CAA72109B4EDC79E062E8C7C458CC32B33FE29000BE997",
    "76D588683AB1BD0D583DE3767057EDA7FB172C13B6DFDF43BA30F59F0C49BA64",
    "F7DC09C548147880A45813D1491FC0D21762FA02E5B862E74F2E30A3E7A397D7",
    "DE54307D78E030189CE38077609A40915299A3661F51D697F0EE9D468B34FD02",
    "ECF5FEA54EB04E18BCCF5BAA5DD4DD17A5B29AF57059070E88ED5AAAB7EE393C",
    "0EF361E11858E56E2A4A6E0547423C2CA11E0C3F8837FA96F5A1C5F5D8E5D8BA",
    "D6A15208F17CF31D03FCF6D8AE7DEB4AE4E7C06F378EC7361448A0C7C3280223",
    "C93C3A993C9466119FC5DA9FACD16BD677D772CA49C7273E0BB9B4B48E86EDFC",
    "AA48BBCE1CF6F1A1EE8628ABCFD1E8DA01229D4A0A7FA02646EF869782D14888",
    "6055CE23437A6E86F5D40E8EB4751F063C8C9779D1E0F8D4DEE74861E3B9142A",
    "885842B0322D5A3D6A22C26E9617A0447E9F1D49FE38939C2837D52F523BB5D5",
    "2E008C4873E696F75A8EFE50C652149D1B082619F89E8267FCF27C92E5C7A2A3",
    "FEA8B161DABBFBDFDE35032291492AF007FBCE98B1A4B3DAE521268C5A2515A3",
    "02627EDB8793C1E52376F42C7FCA01DB6B4564BC517C5467AD1CAB31A6A10B39",
    "F8393151C544DA6FFB15CA9979660CB32E597610CE4C7E8671FF54E92BE19321",
    "5E47C4CF08450EA73D10E705FDCE727ACE66F8BCF4984028B1B17C91B8F630A6",
    "CFC1C2B0B4EDAB503B5E504FF9DF0CFBCAF0CFEBDC4B88625FB10375945CC27E",
    "D50B55074466C46BCD73956C1124DB52889940A1C7C811E9ECA93CCF1370E688",
    "FEEE922F4376733972504819A62AE4934521D16F2F8C58CD1889D67EC58634FE",
    "F586B7A05D40BAE033B397738B13CF593B2AA129918D361EC0AD6105D187AFA4",
    "524542AA88FC06A1045499409FAE442CFFFF8B5A2AB9FBCC6EC57004B440B15B",
    "41F564E881CB17EDBA316D940DE3E83D34B266DD16E1D07B39F2921E5D95F444",
    "A6E03D53ADE942DB8E1A52EEAEAFF7D2E1030D546E55549A77947C2F25D5850A",
    "C80566307DA07B6AFBAB22F3902161DAC0BB1A9507991FB486992A38362ED9F2",
    "ADD072440617E0E07D2619FB1B9A6045DA805FCD147A1E6531E0E8E7A3FDFBB1",
    "1D648332D6ED8F2CDA3A7D323E6BA8B8A3D43EAA6690FE9449B4A464BFDEE1F5",
    "561D54DA36DD523D2E650D35C471465DE5DA3212D9641B6AE4DA0312ED630C1E",
    "C766C7D89618607369DC3341EB5D8AD8CFF4077533E6AA5B43BD8E2FE7619C67",
    "9963951CB2B281AE35F8646CE4B725721BD3EF9FDDCD51B75577E235F6EF2AAA",
    "1AAE8DEED0B5F65E86A59AB98FF37AE21F7E3EB11FE563DBBEA9E01DEBAED61B",
    "5416A3E9781F01D3FC8431723B615E00688A49EDD3652F9DBC3C0078B15BF301",
    "3BCD55E616284C59F85AADA46C891E44848B582C9A11E9096ED6C76C971CCF66",
    "E40C89D7F5D6CFFC306E1513514320238C8F8D66485971D7C0513BA10947A892",
    "09BD2F7393C7B94ADDC2D70822F16C0576E7A1FCBCF2569235A30B49D3F44AA8",
    "DF431D57C0010AD618CDFBD283ACCDA567C539E02D99EB272FF543B4E990FFD3",
    "306E54603B5727D92AD4C7832B98DE5ED89ACFB0599CE14C36A3C5C6989C5A40",
    "23850868AD79A98678A5F79479A971E77B7897406EDB05B544CB67F1CCEB9C1C",
    "AC529ACD1415C14ED4FF8D00E876B435BE184CD0F05E0DAA22BC040737DCE550",
    "531522FF825419815646A51D0BF79C4616E06E9ADE20885642E7AC8225862F21",
    "6882B39164386C94A780AB9E8CA76D0AC49E02FF6380A21D3137D24E3B3DCF89",
    "96CB5882FC1092B8EC579BFA5C5DC31AEC33863C35E8F8142D68CCD1A1EBC11F",
    "9F221BD335A9A330CBBCA0C43759DD34DFC1085FA28A4B77A8791CD029963804",
    "F3A268D80CCDF4C906B9E351375C62E2A91BFA5842A38292F53420700D800E3D",
    "D42F70C6F7A23DA0573039DEE909ED1058FFFA29F1583F0DC93597719C357AE7",
    "C8335F7427F40A021D14B70338E19264A99E9BE661CACEE3E17C9D96761F1E5A",
    "E05625A8E5F3F3B4615666BB16F4CCD5A2D8E150A14D4ACD7BEE319860571A63",
    "0B06CE8A7B5BE7E24A60C73F437D0476A99EA30EBC220890516B6BA3978C2B7A",
    "339789BDDFA0E3EFE7BE90D38712152DC89C557EEDF15D1B7F07B0C1BA6071BF",
    "0BD8138A4B9E095BBA97D8F6D83DC7AFAA88BAFEC217152A4732206A193E5EB2",
    "17EBE42BB194F176144C2F99C692102F244778FD820A909013F2278699012C4B",
    "E66EDC64A4C491B9BAF921D3F521F5A1F2A8EE743A39A47E6666640288BDCAAE",
    "498F5CEFE33F01CB27918A5374BA5CA88BCE18CDD8409D3555574892C5C4EEC4",
    "C53BEE109D9E3E8CAE4CA6F24D5F507BA4CB2E43E078604CDB45A83EB98E8E52",
    "CB976D51D7FDDDA92CE979C6B654DCE8811DC546FC75B1104815FF5AB0B4A74C",
    "0D30CE1A2FED397C374C333679E0EB66C6B1EB5450D5E5E0B9B4BFF6E24A1B72",
    "5CF806FE0273107DFC0B7768935817310D547C1006B34022319240B5F07BB865",
    "A404BBF269DE2DE83A1595559AC5082BA4D89302B30576A0E033014B13490099",
    "5F20E38BA6765923DACB8B4B822C90A5D072CA3381ADFF9C509D999A1A7E97F4",
    "1F93E90FCBCAF0172FA6D9E5CC06CDB72A8400862E52E5B285AFB9D77F18F9F1",
    "3E1370318A318CEE4DE034207FF24C038EA78B552D7945EC96060AD26E02B858",
    "8D83A6C7D7EA45D416C1607F37108BFAAC59B57C71F7347EFB5943A70E57AE8A",
    "930C57B4E6579E4F9A18B891ECA8CBB95A3FE83CFED8778D297B63F7C25F0B32",
    "AD6A8DD1FFE15E8ADE88DEA9CB560137B7004E24AD6D9F4EC0EFEA83E5B43631",
    "AA48BBCE1CF6F1A1EE8628ABCFD1E8DA01229D4A0A7FA02646EF869782D14888",
    "47B350D44BB265A59E3E1322339BEF1822200A03C936FB61B4A8933F35F0065A",
    "E8355F5EED3E5579ABA9941E853BB21B234F56CF7EAC9961D54E162B4C2D05BB",
    "3C096F06E6157BFB2C732318E245728742A81688C6413C80F4660E61AA8D00BE",
    "A9735EB5FB3DECA3E92C0DCB2CEA1DBA2ADAE2FDD9DFB0D46069A25123849732",
    "4AFD6534718987EAF5F133FAC75F339D3F183EE7C17021405CDD78C11BDC9EC2",
    "7897C7B6F3071ED7CA7B9E14134A2054C0164830B128D03C639469BFBA8FC52A",
    "ABDA81CC6AF25391B942883867DC66EE8CD7F7E432CA02A711B0C41AF377D963",
    "12633820E48E188AA4C5C5577F7122C7098C4082070575EE82C6C0CDB87EBB78",
    "A52F705D3237D4E14C9A43AE438A4BF076DB52D8A6848DFE6A9442FD438E345F",
    "763AD0D2715E3413285FA5671993E723FADD7732E9CF80ED717FF96DFB129B2F",
    "CA58F671E0DEA0CDD4A053D18D071E5212B4C96061C9E5651851D40049CFAA2B",
    "4FDE714CA477A196B75312D6E1AD5C94EE6AED1EAE545A4615B237BD3FDC31E7",
    "6748CED288847319E8292905616A91221E0060061D80D68C0D8B899BAEC92328",
    "BEAEBCA5692A0C661DDB7624BE7A1DE99CE31070ADC95369E507334D5B3BB320",
    "3D80BB0527C83EB0947E61B0551A805BD89F07B5D51DA1C961038F70EB064B20",
    "23B8BEFA723D83C49AF51817E013500E1CB5F3B2D466B1E7000CBA55B7122F40",
    "848DD1368A5BDBE3937B7C7EC78B5D6CAC9473D29104C54755570B288740DD7E",
    "580FD14212240BA8E1F5AB9D1F9EFEB2C2686E3B199B014CC5D2B8837AF766B5",
    "53F3755E9CF51D9324140B3776051075C5A78ECA8A24F49AF960DC6A117326D9",
    "D54F5CC936A431B51C656AE38B2344B07BD1C7AA1027083BC506A0B76F4178ED",
    "77817B885BAC74BC08D378A9B711D83BD8C32FBD1ABD634FC28C2C58F95E2502",
    "6CA39B7DBF4B383DF98011F9F9D55290DDD478BEC0D1515632D48B4A800B4BF8",
    "59B4582D5805BAB314F724774A05CCA6F4A26477FB2248B2A713FE7FA77F8E3E",
    "E3140412431464D9AC29DAEEB241A873670E8E0A89DA450D11536C44296E7F8A",
    "54043CD0B6AFB0B9BAE853192D3D802FDF6EBC98FC60E6B1902D829BCE75CFD3",
    "6789498F1EE6CA73D4FCF262634316030DAF9EEFF79BC717F44A52CA0D5505D0",
    "DC9C968B3C865671026D9D2A161DAACFAA1AC4283CDE08913C7FDC06F6197400",
    "DC9C968B3C865671026D9D2A161DAACFAA1AC4283CDE08913C7FDC06F6197400",
    "DC9C968B3C865671026D9D2A161DAACFAA1AC4283CDE08913C7FDC06F6197400",
    "4775C81715EF0E1C9EF977E91364BADEFE2541A5268DC188BAB194AC58CA3F56",
    "125C9D6F17F405590459F4CBACA979E345EFB12D0D8ED5693B9421F6E6BF59DF",
    "39B79C0E7AC1DF0DD6BA981F426D1964BA31F3034D975CD61191CE1BAC9F3F11",
    "9A4CF5DFEFBF12A7B00343C5687B060095E2709B219E350F8E7B31102E271C58",
    "17CFBDADF80AD61A0D2DD14B0AE7AE9CA2F983D5D419D7A705EDF1241B2F2B3D",
    "F50AECE6A33838035CCD9C5F0A221475095E63A5D254EF7BA3DEDFA5BBEB2398",
    "B9B981DAA102814F10EF591CE366B1E1F79ECDE487C420EDBA127181EE073ED8",
    "3B06BA517A2945C2F52DD663F03826CA42E692F64BFF103E67D8AD818987E448",
    "015B9FB7AED17B8E6C0F34A49A3A5EBC1F9EF72F4425843DFD64AD16411584BB",
    "37B1FCE34C15BB65C90CA054BC050B602D3D1B95AE1EA0BA10A97E8B81E5089E",
    "8ADD7B0B389FA5CFB0EBC9FC5DA10C8B9C29C1068748708440F9D9E72958D4BC",
    "DF5B7E11445BC74C8AEA45659A7CB74531F36C831340B6F818E60C266FCDA8C9",
    "79C3F0C7FA690BC573CA17041E462FB2F5FE061D6749638AAEED152C0F34FA52",
    "1F634CDEEB5F2216C2EBB45D677104173C753419717A0BE03FD5491BDF2D66F7",
    "24095FD291BCD9CC0A8C9E60C72F920AEAD9A16E614A043F5D5924871DAA929D",
    "14DE150C9E4FE5D27C75EF9D23E2A34A4C81A8AFB89113596647FEF8DC292861",
    "8CE5ADE4515E3C6C9FC877B3E2CD1E820AA65811E6D3851BE3CF133696781B9E",
    "1533AA06991405551F1E9494CDA28CD7271CB570BCEE4B4620BDEE9724F58068",
    "697E080725BA3ACA5CD0B2FD1FE93EC96A5C5DB91F44FC61E54B93DCFFE8848F",
    "16058D5A1CD65259FB035AC8D8C4B88B1F42FBBB30071BA5F5333264ED372FAD",
    "2639AC3F46718857D651CE33D3A950AAFF37D02F80FF99DDB06BAB8D8443077B",
    "7F034883B40F9A55C2214016BD218C42E42DEE985FB22519EFA6E592D119D96E",
    "2C2AEF6F2921E94FDAF2E0FAE13A4EA49B81D7A00EB5BBEEF9C9A55EB59AFD3B",
    "FC7069393B7FD94A475D53CC9CE3B32BCF9D99BD42983E7B8AF9CEAADACCA76F",
    "8EFD9D8827E168EC69C457F56A1E39DCA414EBA600B8A0A0001172B4DCB74F26",
    "ED0E754D4FFFD1C85BA4A65E7A10900A55CAA7DFC5B69260EE99FD844FAE3A1D",
    "898E86844BDDA44BB015135F0B3C59DAC5DA516D21FFF688547F384FA7437F20",
    "A51F9C33891AC132169B2B53F80284869BEF22F40123954B72558B45B5D4722F",
    "55C7689C9D658317B51AC21EA4DE3A21A43558D6FA677BE7CAD335CA479F92F0",
    "55C7689C9D658317B51AC21EA4DE3A21A43558D6FA677BE7CAD335CA479F92F0",
    "FC085FB674B70A232D8464FBE521DE10DA028422AB4E12DC5C9A2F6DE7FDCA16",
    "5B85D7E87A191F14D8F893C4694317BA4FB9B50F50CF7E1090AAF29443A95F95",
    "8F1580D0B3BC7649EA0BA131866EBE9DFF11D2E91F479F1CC6999F05BC74F50D",
    "8EB33CD676B31236C8ABF90563438C0BFF295E4D36462FE71F6DF48C63B7B8EE",
    "825FF8803FC3D40C9F3E7D5C3F57AAD160033B453245658B7B8068FC336110B0",
    "211D789942561C2DB2DB76991A254607F39522F5CDEA2D25235F063B6CAAE850",
    "25FA9582EFE65C68EA52ACD12D170BE2F3FBECFAD53D61178B23B76AAA1ACDC0",
    "DDF18CE66731595CAA9DE4B84E633A39DB4854F63D064083CD6EC967B756F96D",
    "FDA70123008180F3DCDFC6ED3C74F5EB1FA2B9E7DC76C4D149AD351B158E4376",
    "6E88DF8B98317F138EC302F6F38666159E3035129838ECBE69396ECECA25F27F",
    "C5CC16EE6521DD441C63FCED008AF12509DFE9EC0A43B393F3DA40D8D1DF28C4",
    "77379C7BD8B09CF9E3AD862F4158261A79D87F0578B6177066E33699F4566B7F",
    "E20A48B1FFF9AF6AD8464C5C6313FB6A6031B45C9DCE872D090FDC45994BDA17",
    "8EFD9D8827E168EC69C457F56A1E39DCA414EBA600B8A0A0001172B4DCB74F26",
    "7B9871E7584E33BD2C1BFCD93F4127546B73CFA41DF6EBBBA9A7EAAEAD1938D5",
    "BFC09AE01A1E7812B2F59823C9A408E19F6046872135BD6298E61EBB37E60F60",
    "2E008C4873E696F75A8EFE50C652149D1B082619F89E8267FCF27C92E5C7A2A3",
    "C5FE803619E15E7FFB933BB68C99524C0FDF7DC45B28A041BCB22CA140439ADC",
    "3A2F022D06E93DED348EFD50D8876561EB5A2A41E6A91FDA08BFBAA65B2F7DC5",
    "07C24D1D9528CD1740CF949368A42F5770233DD573854E16B6BF3010183B7EBD",
    "A1AEE1896BADCF7655DEEB22A93D188F12EEB811C52BD17E0D9D2B6490795B77",
    "529DFD5E2BE0D7F8CBA9C554EF0BCA26CAFB4C4C7753EC2DEC90CC8CB61487BA",
    "4250EB73C148C7914D9F0A52AC08C1AB001DB7D62EF5367813D8C60186D31111",
    "A16F90444F13E6AEEEAEB11363AB1DBCE1021C8ED14F3B1FE890BB4B0159A467",
    "93151A91A889570923931D727AB3970C3CFBDFB0BD9D4D851A5ED1C19B75028A",
    "A2DFBB1D30AA7F7E368CEBD9622CEF159A958870327F2E25636F875469E953F0",
    "3AF8C0FEA2B83EDFE4FCDC3536417649D888CA214C58E5112F368818ECFDD86C",
    "59AA182CBA5060EA7F2731202F7351C99C1EA617B76C4DB6699D3679F375003A",
    "5A010A4FE6F1C41D7B3C8652E5AD7663FCCD23B8D11C41C04F7C75B9209230BB",
    "3471D4576CDF07EAC13C730D1365F0289156263E85C01953411289991BCD1C07",
    "B9C53878770BAA9C964E9E34FE5217B5DBA6778A781585616C45F4FF3D004FC4",
    "0864A9E54FD218686CD56F0A8BD4157AB3437FEEFAA2F2471DA606907A919E57",
    "51C7D793EB7E1608EA2BAFEA8B4E201543A5957A6873444A30F4E4AD74A5966D",
    "BCBDA68EC47365A9B149271269212DCA691587FC2C88049E6D3B21CC0B04D8D5",
    "0D30CE1A2FED397C374C333679E0EB66C6B1EB5450D5E5E0B9B4BFF6E24A1B72",
    "3FD4BBB49DDAB6F5E0A8232F142B574CAE73711249EB5967E66AAC9427689E54",
    "76C667CF0102EFE0CB2EC769DF107382C7696855C66DA1E1392918D4F4F2AE0A",
    "8BDD73C51045C7666A406E1B0255997DFDFA890CF3889877922CA4D97F5B2B74",
    "4F9A28A49EA89EFA0372BA043D93726300F5CDC24069DC0CED9479B67997B695",
    "5A94C631D3B8701AAE6464C661DCFFB3079A68BA5011770846E4E4A6C02ADA49",
    "763AD0D2715E3413285FA5671993E723FADD7732E9CF80ED717FF96DFB129B2F",
    "4FDE714CA477A196B75312D6E1AD5C94EE6AED1EAE545A4615B237BD3FDC31E7",
    "A4BBD63E093E7FC1FE891981195405E185FF0FDA75535806FAAB9F8EB8242C3D",
    "C6EFAA5B669A122DDED7FB33F3BC0DE5789B1C9E49529784ECAE7B8B1F33FC3C",
    "37CFCFE279C448A90299133ECE914E2F1148B576260ECE5C213C656187A86CDD",
    "8879B3960E4675ECF734B312C422F8E2E7F81810B223CFBFD516D0E5F4B01619",
    "4E80BA06B0C8A81A21C6F581D2C544C5B016778B72A1D27FC136E04DD9B8E9B0",
    "E50DA30366F39B8F1895F3A5717ED05A88703DA14FC3787E4D7E1207F89E15E8",
    "867688A16DF6FA99568E2BC61E85A0FAF320B2597902979C2C9BA3218B876EA4",
    "93151A91A889570923931D727AB3970C3CFBDFB0BD9D4D851A5ED1C19B75028A",
    "2D76D8727D31993C0DA10122AD929360F77C8842832169F85A4FF5F4121AAA09",
    "9BCFD42757CB4FA740F0EB73CF6637FA6B745ADD88D4EC81E937EF69BBD1911F",
    "F5D0BEE4E01FD025D4F437342CDE286678E7C60B6D10A9D3D5465D78BADB064E"  
]

SIZES = [32256, 55467, 19983, 6973, 1000953, 1056704, 53498, 17895, 112128, 644, 20017, 204597, 38125, 88, 22891, 995471, 1179648, 834048, 18657, 678400, 12288, 19398, 21066, 769, 21033, 16, 33673, 24008, 31053, 124695, 59549, 34095, 16128, 206848, 68608, 19031, 17728, 698368, 205209, 2858016, 2101216, 42309, 1475, 865792, 19968, 18872, 2523, 88, 7918279, 567296, 385024, 47328, 13312, 13824, 286208, 182, 285696, 11369, 46656772, 81408, 1032192, 1390080, 9823232, 9831936, 7141, 19024, 92160, 513536, 32513, 11554, 39676, 1557, 19560, 18416, 255488, 291840, 24630, 190976, 10487, 9883, 6160, 19736, 19983, 139151, 1309696, 129024, 516096, 824320, 824320, 837632, 823296, 2033152, 2033152, 919552, 2033152, 456704, 32256, 1136664, 36963, 329728, 871, 418816, 26275, 802304, 437760, 327680, 1904000, 37267, 1467200, 5989, 237325, 2932, 114176, 118596, 228864, 1101, 17591, 2773672, 12055, 108751, 160303, 227369, 1861619, 46406, 32577, 165888, 7712327, 763904, 1362944, 1362944, 220672, 3284496, 188928, 129, 406528, 861696, 622592, 25671, 153541, 33280, 760346, 16677, 635, 16705, 553984, 1572864, 2194944, 163328, 343552, 136644, 22369, 40963, 635, 13643, 823296, 98717, 418816, 428032, 34316, 34483, 34203, 47247, 55467, 59634, 2069504, 368640, 3350, 4283, 18775, 7173, 10379, 19274, 56834, 18673, 18732, 3210, 1913, 36352, 297, 121856, 18175, 1257472, 1818618, 834048, 834048, 834048, 818688, 132771, 255488, 6858, 103936, 1245, 18990, 17021, 156654, 561471, 151976, 1034752, 48521, 704000, 3337769, 24603, 43072, 1415001, 21033, 50842, 26728, 325120, 364032, 366265, 15794, 16840, 26172717, 6160, 2523, 2523, 17728, 2101216, 18611, 373760, 42139, 1327104, 307200, 20137, 1269760, 18526, 321024, 1026, 3564736, 15794, 16900, 219, 437760, 34965, 161975, 3268, 48640, 1514, 112128, 7680, 769, 14336, 644, 44823, 50268, 93, 46254, 44823, 12050221, 20160, 19974, 1801, 163328, 32426, 19071, 499362, 129104, 22286, 49866, 3350, 18775, 18899, 27502, 18473, 12589568, 18876, 395, 783360, 769, 23877, 1029, 858]

def clear_screen():
    os.system('cls' if os.name == 'nt' else 'clear')

def print_ascii_art():
    ascii_art = '''
 ▄████▄  ▓█████  ██▀███   ▒█████   ██▒   █▓ ██▓ ███▄    █  ▄▄▄      
▒██▀ ▀█  ▓█   ▀ ▓██ ▒ ██▒▒██▒  ██▒▓██░   █▒▓██▒ ██ ▀█   █ ▒████▄    
▒▓█    ▄ ▒███   ▓██ ░▄█ ▒▒██░  ██▒ ▓██  █▒░▒██▒▓██  ▀█ ██▒▒██  ▀█▄  
▒▓▓▄ ▄██▒▒▓█  ▄ ▒██▀▀█▄  ▒██   ██░  ▒██ █░░░██░▓██▒  ▐▌██▒░██▄▄▄▄██ 
▒ ▓███▀ ░░▒████▒░██▓ ▒██▒░ ████▓▒░   ▒▀█░  ░██░▒██░   ▓██░ ▓█   ▓██▒
░ ░▒ ▒  ░░░ ▒░ ░░ ▒▓ ░▒▓░░ ▒░▒░▒░    ░ ▐░  ░▓  ░ ▒░   ▒ ▒  ▒▒   ▓▒█░
  ░  ▒    ░ ░  ░  ░▒ ░ ▒░  ░ ▒ ▒░    ░ ░░   ▒ ░░ ░░   ░ ▒░  ▒   ▒▒ ░
░           ░     ░░   ░ ░ ░ ░ ▒       ░░   ▒ ░   ░   ░ ░   ░   ▒   
░ ░         ░  ░   ░         ░ ░        ░   ░           ░       ░  ░
░                                      ░                            
                                                                       

...........*UHWHН!hhhhН!?M88WHXХWWWWSW$o
.......X*#M@$Н!eeeeНXНM$$$$$$WWxХWWW9S0
…...ХН!Н!Н!?HН..ХН$Н$$$$$$$$$$8XХDDFDFW9W$
....Н!f$$$$gХhН!jkgfХ~Н$Н#$$$$$$$$$$8XХKKW9W$,
....ХНgХ:НHНHHHfg~iU$XН?R$$$$$$$$MMНGG$9$R$$
....~НgН!Н!df$$$$$JXW$$$UН!?$$$$$$RMMНLFG$9$$$
......НХdfgdfghtХНM"T#$$$$WX??#MRRMMMН$$$$99$$
......~?W…fiW*........"#$$$$8Н!Н!?WWW?Н!J$99999$$$
...........M$$$$............."T#$T~Н8$WUXUQ$$$$$99$9$$
...........~#$$$mХ.............~Н~$$$?$$$$$$$F$$$990$0
..............~T$$$$8xx......xWWFW~##*"''""''"I**9999о
...............$$$.P$T#$$@@W@*/**$$.............,,*90о
.............$$$L!?$$.XXХXUW....../....$$,,,,....,,ХJ;09*
............$$$.......LM$$$$Ti......../.....n+НHFG$9$*
..........$$$H.Нu....""$$B$$MEb!MХUНT$$0
............W$@WTL...""*$$$W$TH$Н$$0
..............?$$$B$Wu,,''***PF~***$/ ***0
...................*$$g$$$B$$eeeХWP0
........................"*0$$$$M$$00F''

Balkan School Community

'''
    print(Fore.RED + ascii_art)  

# Funkcija za izračunavanje SHA-256 hash-ova
def calculate_sha256(filepath):
    sha256 = hashlib.sha256()
    try:
        with open(filepath, "rb") as f:
            for byte_block in iter(lambda: f.read(4096), b""):
                sha256.update(byte_block)
    except (PermissionError, FileNotFoundError):
        return None
    return sha256.hexdigest()

# Funkcija za brojanje ukupnog broja fajlova za progress bar
def count_files(directory):
    total_files = 0
    for root, dirs, files in os.walk(directory, followlinks=True):
        total_files += len(files)
    return total_files

# Funkcija za update-ovanje progress bara
def update_progress_bar(iteration, total, length=40):
    progress = (iteration / total) * 100
    filled_length = int(length * iteration // total)
    bar = '=' * filled_length + '-' * (length - filled_length)
    sys.stdout.write(f'\r[{bar}] {progress:.2f}% -----> Provera je u toku...')
    sys.stdout.flush()

def scan_directory(directory, update_interval=2000):
    matches = []
    target_hashes = [h.lower() for h in HASHES]  # Konvertovanje svih hash-eva u lowercase
    target_sizes = set(SIZES)  

    # Filtriranje fajlova po velicini pre skeniranje SHA-256 hash-ova
    size_filtered_files = []
    total_files = count_files(directory)
    processed_files = 0

    for root, dirs, files in os.walk(directory, followlinks=True):
        for file in files:
            file_path = os.path.join(root, file)
            try:
                file_size = os.path.getsize(file_path)
                if file_size in target_sizes:
                    size_filtered_files.append(file_path)
            except (FileNotFoundError, PermissionError):
                print(Fore.YELLOW + f"Upozorenje: Preskakanje fajla zbog greške: {file_path}")
            processed_files += 1
            if processed_files % update_interval == 0:
                update_progress_bar(processed_files, total_files)

    total_filtered_files = len(size_filtered_files)
    processed_filtered_files = 0

    for file_path in size_filtered_files:
        file_hash = calculate_sha256(file_path)
        if file_hash is not None:
            file_hash = file_hash.lower()  
            if file_hash in target_hashes:
                matches.append(file_path)
        processed_filtered_files += 1
        if processed_filtered_files % update_interval == 0:
            update_progress_bar(processed_filtered_files, total_filtered_files)

    sys.stdout.write('\n')  
    return matches

# Main
def main():
    print_ascii_art()  

    parser = argparse.ArgumentParser(description="Skeniranje.")
    parser.add_argument(
        "-d", "--directory", required=True, help="Directory za skeniranje."
    )

    args = parser.parse_args()

    # Preuzimanje license key-a sa URl-a
    license_keys = fetch_license_keys(LICENSE_KEYS_URL)

    # Unos license key-a
    license_key = input("Unesite license key: ").strip()
    
    # Funkcija za clear-anje screen-a nakon unesenog license key-a
    clear_screen()

    # Validacija license key-a
    if not check_license_key(license_key, license_keys):
        sys.exit(1)

    # Ponovni prikaz ASCII art-a
    print_ascii_art()

    matches = scan_directory(args.directory)

    if matches:
        print("Pronađene nedozvoljene skripte:")
        for match in matches:
            print(match)
        scan_results = "\n".join(matches)
    else:
        print("Igrač nema nedozvoljenih skripti.")
        scan_results = "Igrač nema nedozvoljenih skripti."

    # Slanje rezultata skeniranja na Discord
    send_scan_results(scan_results)

if __name__ == "__main__":
    main()