from kivymd.app import MDApp
from kivymd.uix.screen import Screen
from kivymd.uix.textfield import MDTextField
from kivymd.uix.button import MDRaisedButton
from kivymd.uix.dialog import MDDialog
from kivymd.uix.label import MDLabel  # โ ุฅุตูุงุญ ุงูุงุณุชูุฑุงุฏ

from ุชุณุฌูู_ุงูุฏุฎูู import ุชุญูู_ุงูุฏุฎูู
from ุฃุฏูุงุช import ุญูุธ_ุงูุณุฌู

class ุชุทุจูู_ุงููุญุงุณุจุฉ(MDApp):
    def build(self):
        self.ุงููุงุฌูุฉ = Screen()

        self.ุงุณู_ุงููุณุชุฎุฏู = MDTextField(
            hint_text="ุงุณู ุงููุณุชุฎุฏู",
            pos_hint={"center_x": 0.5, "center_y": 0.6},
            size_hint_x=0.7
        )
        self.ูููุฉ_ุงููุฑูุฑ = MDTextField(
            hint_text="ูููุฉ ุงููุฑูุฑ",
            password=True,
            pos_hint={"center_x": 0.5, "center_y": 0.5},
            size_hint_x=0.7
        )
        ุฒุฑ_ุงูุฏุฎูู = MDRaisedButton(
            text="ุชุณุฌูู ุงูุฏุฎูู",
            pos_hint={"center_x": 0.5, "center_y": 0.4},
            on_release=self.ุชุณุฌูู_ุงูุฏุฎูู
        )

        self.ุงููุงุฌูุฉ.add_widget(self.ุงุณู_ุงููุณุชุฎุฏู)
        self.ุงููุงุฌูุฉ.add_widget(self.ูููุฉ_ุงููุฑูุฑ)
        self.ุงููุงุฌูุฉ.add_widget(ุฒุฑ_ุงูุฏุฎูู)

        return self.ุงููุงุฌูุฉ

    def ุชุณุฌูู_ุงูุฏุฎูู(self, instance):
        ุงููุณุชุฎุฏู = self.ุงุณู_ุงููุณุชุฎุฏู.text
        ุงููุฑูุฑ = self.ูููุฉ_ุงููุฑูุฑ.text

        if ุชุญูู_ุงูุฏุฎูู(ุงููุณุชุฎุฏู, ุงููุฑูุฑ):
            ุญูุธ_ุงูุณุฌู(f"ุชู ุชุณุฌูู ุงูุฏุฎูู ุจูุฌุงุญ: {ุงููุณุชุฎุฏู}")
            self.ุงุธูุงุฑ_ุงููุงุฌูุฉ_ุงูุฑุฆูุณูุฉ(ุงููุณุชุฎุฏู)
        else:
            ุญูุธ_ุงูุณุฌู(f"ูุดู ุชุณุฌูู ุงูุฏุฎูู: {ุงููุณุชุฎุฏู}", ููุน="ERROR")
            MDDialog(title="ูุดู ุงูุฏุฎูู", text="ุงูุจูุงูุงุช ุบูุฑ ุตุญูุญุฉ").open()

    def ุงุธูุงุฑ_ุงููุงุฌูุฉ_ุงูุฑุฆูุณูุฉ(self, ุงููุณุชุฎุฏู):
        ุงูุดุงุดุฉ_ุฌุฏูุฏุฉ = Screen()

        ุฑุณุงูุฉ_ุชุฑุญูุจ = MDLabel(
            text=f"ูุฑุญุจูุงุ {ุงููุณุชุฎุฏู} ๐",
            halign="center",
            pos_hint={"center_y": 0.6}
        )

        ุฒุฑ_ุงูุฎุฑูุฌ = MDRaisedButton(
            text="ุชุณุฌูู ุงูุฎุฑูุฌ",
            pos_hint={"center_x": 0.5, "center_y": 0.4},
            on_release=self.stop
        )

        ุงูุดุงุดุฉ_ุฌุฏูุฏุฉ.add_widget(ุฑุณุงูุฉ_ุชุฑุญูุจ)
        ุงูุดุงุดุฉ_ุฌุฏูุฏุฉ.add_widget(ุฒุฑ_ุงูุฎุฑูุฌ)

        self.root.clear_widgets()
        self.root.add_widget(ุงูุดุงุดุฉ_ุฌุฏูุฏุฉ)

ุชุทุจูู_ุงููุญุงุณุจุฉ().run()

def ุงุธูุงุฑ_ุดุงุดุฉ_ุงูุนููุงุก(self):
    ุดุงุดุฉ_ุงูุนููุงุก = Screen()

    ุนููุงู = MDLabel(
        text="๐ ูุงุฆูุฉ ุงูุนููุงุก",
        halign="center",
        pos_hint={"center_y": 0.85},
        theme_text_color="Custom",
        text_color=(0, 0.5, 0.8, 1),
        font_style="H5"
    )

    ุฒุฑ_ุฅุถุงูุฉ = MDRaisedButton(
        text="โ ุฅุถุงูุฉ ุนููู",
        pos_hint={"center_x": 0.5, "center_y": 0.6},
        on_release=lambda x: self.ุนุฑุถ_ูุงูุฐุฉ_ุฅุถุงูุฉ_ุนููู()
    )

    ุฒุฑ_ุฑุฌูุน = MDRaisedButton(
        text="โฌ๏ธ ุฑุฌูุน",
        pos_hint={"center_x": 0.5, "center_y": 0.4},
        on_release=lambda x: self.ุงุธูุงุฑ_ุงููุงุฌูุฉ_ุงูุฑุฆูุณูุฉ("ุงูุนูุฏุฉ")
    )

    ุดุงุดุฉ_ุงูุนููุงุก.add_widget(ุนููุงู)
    ุดุงุดุฉ_ุงูุนููุงุก.add_widget(ุฒุฑ_ุฅุถุงูุฉ)
    ุดุงุดุฉ_ุงูุนููุงุก.add_widget(ุฒุฑ_ุฑุฌูุน)

    self.root.clear_widgets()
    self.root.add_widget(ุดุงุดุฉ_ุงูุนููุงุก)

def ุนุฑุถ_ูุงูุฐุฉ_ุฅุถุงูุฉ_ุนููู(self):
    self.dialog = MDDialog(
        title="ุฅุถุงูุฉ ุนููู ุฌุฏูุฏ",
        text="(ุณูุชู ุชูููุฐูุง ูุงุญููุง)",
        buttons=[
            MDRaisedButton(text="ููุงูู", on_release=lambda x: self.dialog.dismiss()),
            MDRaisedButton(text="ุฅูุบุงุก", on_release=lambda x: self.dialog.dismiss())
        ]
    )
    self.dialog.open()

ุฒุฑ_ุงูุนููุงุก = MDRaisedButton(
    text="๐ ุฅุฏุงุฑุฉ ุงูุนููุงุก",
    pos_hint={"center_x": 0.5, "center_y": 0.5},
    on_release=lambda x: self.ุงุธูุงุฑ_ุดุงุดุฉ_ุงูุนููุงุก()
)
ุงูุดุงุดุฉ_ุฌุฏูุฏุฉ.add_widget(ุฒุฑ_ุงูุนููุงุก)

import sqlite3

def ุฅูุดุงุก_ูุงุนุฏุฉ_ุงูุจูุงูุงุช():
    conn = sqlite3.connect('ุงูุนููุงุก.db')
    cursor = conn.cursor()
    cursor.execute('''
        CREATE TABLE IF NOT EXISTS ุงูุนููุงุก (
            id INTEGER PRIMARY KEY AUTOINCREMENT,
            ุงูุงุณู TEXT NOT NULL,
            ุฑูู_ุงููุงุชู TEXT,
            ุงูุจุฑูุฏ TEXT
        )
    ''')
    conn.commit()
    conn.close()

def ุฅุถุงูุฉ_ุนููู(ุงูุงุณู, ุฑูู_ุงููุงุชู, ุงูุจุฑูุฏ):
    conn = sqlite3.connect('ุงูุนููุงุก.db')
    cursor = conn.cursor()
    cursor.execute('INSERT INTO ุงูุนููุงุก (ุงูุงุณู, ุฑูู_ุงููุงุชู, ุงูุจุฑูุฏ) VALUES (?, ?, ?)', (ุงูุงุณู, ุฑูู_ุงููุงุชู, ุงูุจุฑูุฏ))
    conn.commit()
    conn.close()

def ุงุณุชุนูุงู_ุงูุนููุงุก():
    conn = sqlite3.connect('ุงูุนููุงุก.db')
    cursor = conn.cursor()
    cursor.execute('SELECT * FROM ุงูุนููุงุก')
    ุงููุชุงุฆุฌ = cursor.fetchall()
    conn.close()
    return ุงููุชุงุฆุฌ

def ุนุฑุถ_ูุงุฆูุฉ_ุงูุนููุงุก(self):
    ุงูุนููุงุก = ุงุณุชุนูุงู_ุงูุนููุงุก()
    ุงููุงุฆูุฉ = MDList()
    for ุนููู in ุงูุนููุงุก:
        ุนูุตุฑ = OneLineListItem(text=f"{ุนููู[1]} - {ุนููู[2]}")
        ุงููุงุฆูุฉ.add_widget(ุนูุตุฑ)
    self.root.clear_widgets()
    self.root.add_widget(ุงููุงุฆูุฉ)

def ุนุฑุถ_ูุงูุฐุฉ_ุฅุถุงูุฉ_ุนููู(self):
    ุงููุญุชูู = MDBoxLayout(orientation="vertical", spacing=10, padding=20)
    self.ุญูู_ุงูุงุณู = MDTextField(hint_text="ุงุณู ุงูุนููู")
    self.ุญูู_ุงููุงุชู = MDTextField(hint_text="ุฑูู ุงููุงุชู")
    self.ุญูู_ุงูุจุฑูุฏ = MDTextField(hint_text="ุงูุจุฑูุฏ ุงูุฅููุชุฑููู")

    ุงููุญุชูู.add_widget(self.ุญูู_ุงูุงุณู)
    ุงููุญุชูู.add_widget(self.ุญูู_ุงููุงุชู)
    ุงููุญุชูู.add_widget(self.ุญูู_ุงูุจุฑูุฏ)

    self.dialog = MDDialog(
        title="โ ุฅุถุงูุฉ ุนููู",
        type="custom",
        content_cls=ุงููุญุชูู,
        buttons=[
            MDRaisedButton(text="ุญูุธ", on_release=lambda x: self.ุญูุธ_ุจูุงูุงุช_ุงูุนููู()),
            MDFlatButton(text="ุฅูุบุงุก", on_release=lambda x: self.dialog.dismiss())
        ]
    )
    self.dialog.open()

def ุญูุธ_ุจูุงูุงุช_ุงูุนููู(self):
    ุงูุงุณู = self.ุญูู_ุงูุงุณู.text
    ุงููุงุชู = self.ุญูู_ุงููุงุชู.text
    ุงูุจุฑูุฏ = self.ุญูู_ุงูุจุฑูุฏ.text
    if ุงูุงุณู.strip():
        ุฅุถุงูุฉ_ุนููู(ุงูุงุณู, ุงููุงุชู, ุงูุจุฑูุฏ)
        self.dialog.dismiss()
        self.ุงุธูุงุฑ_ุดุงุดุฉ_ุงูุนููุงุก()
    else:
        print("ูุฑุฌู ุฅุฏุฎุงู ุงูุงุณู")

def ุนุฑุถ_ูุงุฆูุฉ_ุงูุนููุงุก(self):
    ุงูุนููุงุก = ุงุณุชุนูุงู_ุงูุนููุงุก()
    ุงููุงุฆูุฉ = MDList()

    for ุนููู in ุงูุนููุงุก:
        ุตูุฏูู = MDBoxLayout(orientation="horizontal", spacing=10)
        ุชูุงุตูู = MDLabel(text=f"{ุนููู[1]} | {ุนููู[2]} | {ุนููู[3]}", halign="left")
        
        ุฒุฑ_ุชุนุฏูู = MDRaisedButton(text="โ๏ธ", on_release=lambda x, id=ุนููู[0]: self.ุชุนุฏูู_ุนููู(id))
        ุฒุฑ_ุญุฐู = MDRaisedButton(text="๐๏ธ", on_release=lambda x, id=ุนููู[0]: self.ุญุฐู_ุนููู(id))

        ุตูุฏูู.add_widget(ุชูุงุตูู)
        ุตูุฏูู.add_widget(ุฒุฑ_ุชุนุฏูู)
        ุตูุฏูู.add_widget(ุฒุฑ_ุญุฐู)
        ุงููุงุฆูุฉ.add_widget(ุตูุฏูู)

    ุงูุดุงุดุฉ = Screen()
    ุงูุดุงุดุฉ.add_widget(ุงููุงุฆูุฉ)
    self.root.clear_widgets()
    self.root.add_widget(ุงูุดุงุดุฉ)

def ุชุนุฏูู_ุนููู(self, ูุนุฑู_ุงูุนููู):
    conn = sqlite3.connect('ุงูุนููุงุก.db')
    cursor = conn.cursor()
    cursor.execute('SELECT * FROM ุงูุนููุงุก WHERE id = ?', (ูุนุฑู_ุงูุนููู,))
    ุงูุนููู = cursor.fetchone()
    conn.close()

    ุงููุญุชูู = MDBoxLayout(orientation="vertical", spacing=10, padding=20)
    self.ุญูู_ุชุนุฏูู_ุงูุงุณู = MDTextField(hint_text="ุงุณู ุงูุนููู", text=ุนููู[1])
    self.ุญูู_ุชุนุฏูู_ุงููุงุชู = MDTextField(hint_text="ุฑูู ุงููุงุชู", text=ุนููู[2])
    self.ุญูู_ุชุนุฏูู_ุงูุจุฑูุฏ = MDTextField(hint_text="ุงูุจุฑูุฏ ุงูุฅููุชุฑููู", text=ุนููู[3])

    ุงููุญุชูู.add_widget(self.ุญูู_ุชุนุฏูู_ุงูุงุณู)
    ุงููุญุชูู.add_widget(self.ุญูู_ุชุนุฏูู_ุงููุงุชู)
    ุงููุญุชูู.add_widget(self.ุญูู_ุชุนุฏูู_ุงูุจุฑูุฏ)

    self.dialog = MDDialog(
        title="โ๏ธ ุชุนุฏูู ุงูุนููู",
        type="custom",
        content_cls=ุงููุญุชูู,
        buttons=[
            MDRaisedButton(text="ุญูุธ", on_release=lambda x: self.ุญูุธ_ุชุนุฏูู_ุงูุนููู(ูุนุฑู_ุงูุนููู)),
            MDFlatButton(text="ุฅูุบุงุก", on_release=lambda x: self.dialog.dismiss())
        ]
    )
    self.dialog.open()

def ุญูุธ_ุชุนุฏูู_ุงูุนููู(self, ูุนุฑู_ุงูุนููู):
    ุงูุงุณู = self.ุญูู_ุชุนุฏูู_ุงูุงุณู.text
    ุงููุงุชู = self.ุญูู_ุชุนุฏูู_ุงููุงุชู.text
    ุงูุจุฑูุฏ = self.ุญูู_ุชุนุฏูู_ุงูุจุฑูุฏ.text

    conn = sqlite3.connect('ุงูุนููุงุก.db')
    cursor = conn.cursor()
    cursor.execute('''
        UPDATE ุงูุนููุงุก
        SET ุงูุงุณู = ?, ุฑูู_ุงููุงุชู = ?, ุงูุจุฑูุฏ = ?
        WHERE id = ?
    ''', (ุงูุงุณู, ุงููุงุชู, ุงูุจุฑูุฏ, ูุนุฑู_ุงูุนููู))
    conn.commit()
    conn.close()

    self.dialog.dismiss()
    self.ุงุธูุงุฑ_ุดุงุดุฉ_ุงูุนููุงุก()

def ุญุฐู_ุนููู(self, ูุนุฑู_ุงูุนููู):
    conn = sqlite3.connect('ุงูุนููุงุก.db')
    cursor = conn.cursor()
    cursor.execute('DELETE FROM ุงูุนููุงุก WHERE id = ?', (ูุนุฑู_ุงูุนููู,))
    conn.commit()
    conn.close()
    self.ุงุธูุงุฑ_ุดุงุดุฉ_ุงูุนููุงุก()

self.ุญูู_ุจุญุซ = MDTextField(
    hint_text="๐ ุงุจุญุซ ุจุงุณู ุฃู ุฑูู ุงููุงุชู",
    pos_hint={"center_x": 0.5, "center_y": 0.9},
    size_hint_x=0.8,
    on_text_validate=self.ุชุดุบูู_ุงูุจุญุซ
)

def ุจุญุซ_ุนู_ุนููู(ูููุฉ_ุจุญุซ):
    conn = sqlite3.connect('ุงูุนููุงุก.db')
    cursor = conn.cursor()
    query = '''
        SELECT * FROM ุงูุนููุงุก
        WHERE ุงูุงุณู LIKE ? OR ุฑูู_ุงููุงุชู LIKE ?
    '''
    like_pattern = f'%{ูููุฉ_ุจุญุซ}%'
    cursor.execute(query, (like_pattern, like_pattern))
    ุงููุชุงุฆุฌ = cursor.fetchall()
    conn.close()
    return ุงููุชุงุฆุฌ
def ุชุดุบูู_ุงูุจุญุซ(self, instance):
    ูููุฉ_ุจุญุซ = self.ุญูู_ุจุญุซ.text
    ูุชุงุฆุฌ = ุจุญุซ_ุนู_ุนููู(ูููุฉ_ุจุญุซ)
    self.ุนุฑุถ_ูุชุงุฆุฌ_ุงูุจุญุซ(ูุชุงุฆุฌ)

def ุนุฑุถ_ุชูุงุตูู_ุงูุนููู(self, ูุนุฑู_ุงูุนููู):
    conn = sqlite3.connect('ุงูุนููุงุก.db')
    cursor = conn.cursor()

    # ุจูุงูุงุช ุงูุนููู
    cursor.execute('SELECT * FROM ุงูุนููุงุก WHERE id = ?', (ูุนุฑู_ุงูุนููู,))
    ุงูุนููู = cursor.fetchone()

    # ุงูููุงุชูุฑ ูุงููุดุชุฑูุงุช
    cursor.execute('SELECT ุงูุชุงุฑูุฎ, ุงููุจูุบ FROM ุงูููุงุชูุฑ WHERE ูุนุฑู_ุงูุนููู = ?', (ูุนุฑู_ุงูุนููู,))
    ุงูููุงุชูุฑ = cursor.fetchall()

    cursor.execute('SELECT ุงูููุชุฌ, ุงููููุฉ, ุงูุณุนุฑ FROM ุงููุดุชุฑูุงุช WHERE ูุนุฑู_ุงูุนููู = ?', (ูุนุฑู_ุงูุนููู,))
    ุงููุดุชุฑูุงุช = cursor.fetchall()

    conn.close()

    # ุฅูุดุงุก ุงูุดุงุดุฉ
    ุดุงุดุฉ = Screen()

    ุดุงุดุฉ.add_widget(MDLabel(
        text=f"๐ ุงูุนููู: {ุนููู[1]}",
        halign="center",
        font_style="H5",
        theme_text_color="Custom",
        text_color=(0.1, 0.3, 0.6, 1),
        pos_hint={"center_y": 0.9}
    ))

    ุดุงุดุฉ.add_widget(MDLabel(
        text=f"๐ ุงููุงุชู: {ุนููู[2]} | โ๏ธ ุงูุจุฑูุฏ: {ุนููู[3]}",
        halign="center",
        pos_hint={"center_y": 0.8}
    ))

    # ูุณู ุงูููุงุชูุฑ
    ุดุงุดุฉ.add_widget(MDLabel(text="๐งพ ุงูููุงุชูุฑ:", halign="center"))
    for ูุงุชูุฑุฉ in ุงูููุงุชูุฑ:
        ุดุงุดุฉ.add_widget(MDLabel(text=f"ุงูุชุงุฑูุฎ: {ูุงุชูุฑุฉ[0]}, ุงููุจูุบ: {ูุงุชูุฑุฉ[1]} ุฑูุงู"))

    # ูุณู ุงููุดุชุฑูุงุช
    ุดุงุดุฉ.add_widget(MDLabel(text="๐ ุงููุดุชุฑูุงุช:", halign="center"))
    for ุนูููุฉ in ุงููุดุชุฑูุงุช:
        ุดุงุดุฉ.add_widget(MDLabel(text=f"{ุนูููุฉ[0]} ร {ุนูููุฉ[1]} = {ุนูููุฉ[2]} ุฑูุงู"))

    # ุฒุฑ ุงูุนูุฏุฉ
    ุฒุฑ_ุฑุฌูุน = MDRaisedButton(
        text="โฌ๏ธ ุฑุฌูุน",
        pos_hint={"center_x": 0.5, "center_y": 0.1},
        on_release=lambda x: self.ุงุธูุงุฑ_ุดุงุดุฉ_ุงูุนููุงุก()
    )
    ุดุงุดุฉ.add_widget(ุฒุฑ_ุฑุฌูุน)

    self.root.clear_widgets()
    self.root.add_widget(ุดุงุดุฉ)

    conn.close()

    # ุฅูุดุงุก ุงูุดุงุดุฉ
    ุดุงุดุฉ = Screen()

    ุดุงุดุฉ.add_widget(MDLabel(
        text=f"๐ ุงูุนููู: {ุนููู[1]}",
        halign="center",
        font_style="H5",
        theme_text_color="Custom",
        text_color=(0.1, 0.3, 0.6, 1),
        pos_hint={"center_y": 0.9}
    ))

    ุดุงุดุฉ.add_widget(MDLabel(
        text=f"๐ ุงููุงุชู: {ุนููู[2]} | โ๏ธ ุงูุจุฑูุฏ: {ุนููู[3]}",
        halign="center",
        pos_hint={"center_y": 0.8}
    ))

    # ูุณู ุงูููุงุชูุฑ
    ุดุงุดุฉ.add_widget(MDLabel(text="๐งพ ุงูููุงุชูุฑ:", halign="center"))
    for ูุงุชูุฑุฉ in ุงูููุงุชูุฑ:
        ุดุงุดุฉ.add_widget(MDLabel(text=f"ุงูุชุงุฑูุฎ: {ูุงุชูุฑุฉ[0]}, ุงููุจูุบ: {ูุงุชูุฑุฉ[1]} ุฑูุงู"))

    # ูุณู ุงููุดุชุฑูุงุช
    ุดุงุดุฉ.add_widget(MDLabel(text="๐ ุงููุดุชุฑูุงุช:", halign="center"))
    for ุนูููุฉ in ุงููุดุชุฑูุงุช:
        ุดุงุดุฉ.add_widget(MDLabel(text=f"{ุนูููุฉ[0]} ร {ุนูููุฉ[1]} = {ุนูููุฉ[2]} ุฑูุงู"))

    # ุฒุฑ ุงูุนูุฏุฉ
    ุฒุฑ_ุฑุฌูุน = MDRaisedButton(
        text="โฌ๏ธ ุฑุฌูุน",
        pos_hint={"center_x": 0.5, "center_y": 0.1},
        on_release=lambda x: self.ุงุธูุงุฑ_ุดุงุดุฉ_ุงูุนููุงุก()
    )
    ุดุงุดุฉ.add_widget(ุฒุฑ_ุฑุฌูุน)

    self.root.clear_widgets()
    self.root.add_widget(ุดุงุดุฉ)

    conn.close()

    ุดุงุดุฉ = Screen()

    ุนููุงู = MDLabel(
        text=f"๐ ุชูุงุตูู ุงูุนููู: {ุนููู[1]}",
        halign="center",
        theme_text_color="Custom",
        text_color=(0.1, 0.3, 0.6, 1),
        font_style="H5",
        pos_hint={"center_y": 0.85}
    )

    ุชูุงุตูู = MDLabel(
        text=f"""
ุฑูู ุงููุงุชู: {ุนููู[2]}
ุงูุจุฑูุฏ ุงูุฅููุชุฑููู: {ุนููู[3]}
ุฑูู ุงูุนููู: {ุนููู[0]}
        """,
        halign="center",
        pos_hint={"center_y": 0.6}
    )

    ุฒุฑ_ุฑุฌูุน = MDRaisedButton(
        text="โฌ๏ธ ุฑุฌูุน",
        pos_hint={"center_x": 0.5, "center_y": 0.3},
        on_release=lambda x: self.ุงุธูุงุฑ_ุดุงุดุฉ_ุงูุนููุงุก()
    )

    ุดุงุดุฉ.add_widget(ุนููุงู)
    ุดุงุดุฉ.add_widget(ุชูุงุตูู)
    ุดุงุดุฉ.add_widget(ุฒุฑ_ุฑุฌูุน)

    self.root.clear_widgets()
    self.root.add_widget(ุดุงุดุฉ)

ุนูุตุฑ = OneLineListItem(
    text=f"{ุนููู[1]} - {ุนููู[2]}",
    on_release=lambda x, id=ุนููู[0]: self.ุนุฑุถ_ุชูุงุตูู_ุงูุนููู(id)
)

def ุฅูุดุงุก_ุฌุฏุงูู_ุฅุถุงููุฉ():
    conn = sqlite3.connect('ุงูุนููุงุก.db')
    cursor = conn.cursor()
    
    # ุฌุฏูู ุงูููุงุชูุฑ
    cursor.execute('''
        CREATE TABLE IF NOT EXISTS ุงูููุงุชูุฑ (
            id INTEGER PRIMARY KEY AUTOINCREMENT,
            ูุนุฑู_ุงูุนููู INTEGER,
            ุงูุชุงุฑูุฎ TEXT,
            ุงููุจูุบ REAL,
            FOREIGN KEY (ูุนุฑู_ุงูุนููู) REFERENCES ุงูุนููุงุก(id)
        )
    ''')

    # ุฌุฏูู ุงููุดุชุฑูุงุช
    cursor.execute('''
        CREATE TABLE IF NOT EXISTS ุงููุดุชุฑูุงุช (
            id INTEGER PRIMARY KEY AUTOINCREMENT,
            ูุนุฑู_ุงูุนููู INTEGER,
            ุงูููุชุฌ TEXT,
            ุงููููุฉ INTEGER,
            ุงูุณุนุฑ REAL,
            FOREIGN KEY (ูุนุฑู_ุงูุนููู) REFERENCES ุงูุนููุงุก(id)
        )
    ''')

    conn.commit()
    conn.close()

def ุญุฐู_ุงูุชูุฑุงุฑ_ูู_ุงููุงุฆูุฉ(ูุงุฆูุฉ):
    return list(set(ูุงุฆูุฉ))
def ุญุฐู_ุงูุชูุฑุงุฑ_ูุน_ุชุฑุชูุจ(ูุงุฆูุฉ):
    ูุชูุฌุฉ = []
    for ุนูุตุฑ in ูุงุฆูุฉ:
        if ุนูุตุฑ not in ูุชูุฌุฉ:
            ูุชูุฌุฉ.append(ุนูุตุฑ)
    return ูุชูุฌุฉ
def ุญุฐู_ุงูุชูุฑุงุฑ(ูุงุฆูุฉ):
    ุฌุฏูุฏุฉ = []
    for ุนูุตุฑ in ูุงุฆูุฉ:
        if ุนูุตุฑ not in ุฌุฏูุฏุฉ:
            ุฌุฏูุฏุฉ.append(ุนูุตุฑ)
    return ุฌุฏูุฏุฉ

ุงููุดุชุฑูุงุช = [
    ("ุชูุงุญ", 2, 5),
    ("ููุฒ", 1, 3),
    ("ุชูุงุญ", 2, 5),
    ("ุจุฑุชูุงู", 3, 4),
    ("ููุฒ", 1, 3)
]

# ุญุฐู ุงูุชูุฑุงุฑ
ุงููุดุชุฑูุงุช_ุจุฏูู_ุชูุฑุงุฑ = ุญุฐู_ุงูุชูุฑุงุฑ(ุงููุดุชุฑูุงุช)

# ุชูุณูู ุฌุฏููู + ุญุณุงุจ ุงูุฅุฌูุงูู
ุฅุฌูุงูู = 0

print("โ" * 40)
print(f"{'ุงูููุชุฌ':<10}{'ุงููููุฉ':<10}{'ุงูุณุนุฑ':<10}{'ุงูุฅุฌูุงูู':<10}")
print("โ" * 40)

for ุนูููุฉ in ุงููุดุชุฑูุงุช_ุจุฏูู_ุชูุฑุงุฑ:
    ุงูููุชุฌ, ุงููููุฉ, ุงูุณุนุฑ = ุนูููุฉ
    ุงููุฌููุน = ุงููููุฉ * ุงูุณุนุฑ
    ุฅุฌูุงูู += ุงููุฌููุน
    print(f"{ุงูููุชุฌ:<10}{ุงููููุฉ:<10}{ุงูุณุนุฑ:<10}{ุงููุฌููุน:<10}")

print("โ" * 40)
print(f"{'ุฅุฌูุงูู ุงููู':<30}{ุฅุฌูุงูู} ุฑูุงู")
print("โ" * 40)

# ูุงุฆูุฉ ุงููุฎุฒูู
ุงููุฎุฒูู = {
    "ุชูุงุญ": {"ุงููููุฉ": 10, "ุงูุณุนุฑ": 5},
    "ููุฒ": {"ุงููููุฉ": 15, "ุงูุณุนุฑ": 3},
    "ุจุฑุชูุงู": {"ุงููููุฉ": 8, "ุงูุณุนุฑ": 4}
}

# ุณุฌู ุงูุนูููุงุช (ูุดุชุฑูุงุช / ูุจูุนุงุช)
ุงูุณุฌู = []

# ุนูููุฉ ุชุญุฏูุซ ุงููุฎุฒูู
def ุชุญุฏูุซ_ุงููุฎุฒูู(ุงูููุชุฌ, ุงููููุฉ, ููุน):
    if ุงูููุชุฌ in ุงููุฎุฒูู:
        if ููุน == "ุดุฑุงุก":
            ุงููุฎุฒูู[ุงูููุชุฌ]["ุงููููุฉ"] += ุงููููุฉ
        elif ููุน == "ุจูุน":
            ุงููุฎุฒูู[ุงูููุชุฌ]["ุงููููุฉ"] -= ุงููููุฉ
        ุงูุณุฌู.append((ุงูููุชุฌ, ุงููููุฉ, ููุน))

# ุนุฑุถ ูุงุฆูุฉ ููุณุฏูุฉ ูููุณุชุฎุฏู
def ุนุฑุถ_ุงููุงุฆูุฉ_ุงูููุณุฏูุฉ():
    print("ุงุฎุชุฑ ุงูููุชุฌ:")
    for i, ุงุณู in enumerate(mุฎุฒูู.keys(), 1):
        print(f"{i}. {ุงุณู}")

# ุทุจุงุนุฉ ุชูุฑูุฑ ุงููุฎุฒูู
def ุทุจุงุนุฉ_ุงููุฎุฒูู():
    print("โ" * 40)
    print(f"{'ุงูููุชุฌ':<10}{'ุงููููุฉ':<10}{'ุงูุณุนุฑ':<10}")
    print("โ" * 40)
    for ููุชุฌ, ุจูุงูุงุช in ุงููุฎุฒูู.items():
        print(f"{ููุชุฌ:<10}{ุจูุงูุงุช['ุงููููุฉ']:<10}{ุจูุงูุงุช['ุงูุณุนุฑ']:<10}")
    print("โ" * 40)

# ุชูููุฐ ูุซุงู
ุชุญุฏูุซ_ุงููุฎุฒูู("ุชูุงุญ", 2, "ุดุฑุงุก")
ุชุญุฏูุซ_ุงููุฎุฒูู("ููุฒ", 3, "ุจูุน")
ุนุฑุถ_ุงููุงุฆูุฉ_ุงูููุณุฏูุฉ()
ุทุจุงุนุฉ_ุงููุฎุฒูู()

import tkinter as tk
from tkinter import ttk

ุงููุฎุฒูู = {
    "ุชูุงุญ": {"ุงููููุฉ": 10, "ุงูุณุนุฑ": 5},
    "ููุฒ": {"ุงููููุฉ": 15, "ุงูุณุนุฑ": 3},
    "ุจุฑุชูุงู": {"ุงููููุฉ": 8, "ุงูุณุนุฑ": 4}
}

ุงูุณุฌู = []

def ุชุญุฏูุซ_ุงููุฎุฒูู():
    ุงูููุชุฌ = ุงุณู_ุงูููุชุฌ.get()
    ุงููููุฉ = int(ูููุฉ_ุงูููุชุฌ.get())
    ููุน = ููุน_ุงูุนูููุฉ.get()

    if ุงูููุชุฌ in ุงููุฎุฒูู:
        if ููุน == "ุดุฑุงุก":
            ุงููุฎุฒูู[ุงูููุชุฌ]["ุงููููุฉ"] += ุงููููุฉ
        elif ููุน == "ุจูุน":
            ุงููุฎุฒูู[ุงูููุชุฌ]["ุงููููุฉ"] -= ุงููููุฉ
        ุงูุณุฌู.append((ุงูููุชุฌ, ุงููููุฉ, ููุน))

    ุชุญุฏูุซ_ุงูุฌุฏูู()

def ุชุญุฏูุซ_ุงูุฌุฏูู():
    for ุตู in ุงูุฌุฏูู.get_children():
        ุงูุฌุฏูู.delete(ุตู)
    for ููุชุฌ, ุจูุงูุงุช in ุงููุฎุฒูู.items():
        ุงูุฌุฏูู.insert("", "end", values=(ููุชุฌ, ุจูุงูุงุช["ุงููููุฉ"], ุจูุงูุงุช["ุงูุณุนุฑ"]))

ูุงูุฐุฉ = tk.Tk()
ูุงูุฐุฉ.title("ุฅุฏุงุฑุฉ ุงููุฎุฒูู")

ุงุณู_ุงูููุชุฌ = ttk.Combobox(ูุงูุฐุฉ, values=list(ุงููุฎุฒูู.keys()))
ูููุฉ_ุงูููุชุฌ = tk.Entry(ูุงูุฐุฉ)
ููุน_ุงูุนูููุฉ = ttk.Combobox(ูุงูุฐุฉ, values=["ุดุฑุงุก", "ุจูุน"])
ุฒุฑ_ุชูููุฐ = tk.Button(ูุงูุฐุฉ, text="ุชูููุฐ", command=ุชุญุฏูุซ_ุงููุฎุฒูู)

ุงุณู_ุงูููุชุฌ.grid(row=0, column=0)
ูููุฉ_ุงูููุชุฌ.grid(row=0, column=1)
ููุน_ุงูุนูููุฉ.grid(row=0, column=2)
ุฒุฑ_ุชูููุฐ.grid(row=0, column=3)

ุงูุฌุฏูู = ttk.Treeview(ูุงูุฐุฉ, columns=("ุงูููุชุฌ", "ุงููููุฉ", "ุงูุณุนุฑ"), show="headings")
for ุงุณู in ["ุงูููุชุฌ", "ุงููููุฉ", "ุงูุณุนุฑ"]:
    ุงูุฌุฏูู.heading(ุงุณู, text=ุงุณู)
ุงูุฌุฏูู.grid(row=1, column=0, columnspan=4)

ุชุญุฏูุซ_ุงูุฌุฏูู()
ูุงูุฐุฉ.mainloop()

from datetime import datetime
import csv

# ุจูุงูุงุช ุงููุฎุฒูู ูุงูุณุฌู
ุงููุฎุฒูู = {
    "ุชูุงุญ": {"ุงููููุฉ": 10, "ุงูุณุนุฑ": 5},
    "ููุฒ": {"ุงููููุฉ": 15, "ุงูุณุนุฑ": 3},
    "ุจุฑุชูุงู": {"ุงููููุฉ": 8, "ุงูุณุนุฑ": 4}
}
ุงูุณุฌู = []

# ุชุญุฏูุซ ุงููุฎุฒูู
def ุชุญุฏูุซ_ุงููุฎุฒูู(ุงูููุชุฌ, ุงููููุฉ, ููุน):
    if ุงูููุชุฌ in ุงููุฎุฒูู:
        if ููุน == "ุดุฑุงุก":
            ุงููุฎุฒูู[ุงูููุชุฌ]["ุงููููุฉ"] += ุงููููุฉ
        elif ููุน == "ุจูุน":
            ุงููุฎุฒูู[ุงูููุชุฌ]["ุงููููุฉ"] -= ุงููููุฉ
        ุงูุณุฌู.append((ุงูููุชุฌ, ุงููููุฉ, ููุน))

# ุญูุธ ุงูููู ุจุงุณู ุชููุงุฆู
def ุญูุธ_ุงูุณุฌู_ูู_CSV():
    ุงูุขู = datetime.now()
    ุงุณู_ุงูููู = f"ุณุฌู_ุงููุฎุฒูู_{ุงูุขู.strftime('%Y_%m_%d_%H%M')}.csv"
    with open(ุงุณู_ุงูููู, mode='w', encoding='utf-8-sig', newline='') as ููู:
        writer = csv.writer(ููู)
        writer.writerow(["ุงูููุชุฌ", "ุงููููุฉ", "ุงูุนูููุฉ"])
        for ุนูููุฉ in ุงูุณุฌู:
            writer.writerow(ุนูููุฉ)
    print(f"โ ุชู ุญูุธ ุงูููู ุจุงุณู: {ุงุณู_ุงูููู}")

# ุทุจุงุนุฉ ุญุงูุฉ ุงููุฎุฒูู
def ุทุจุงุนุฉ_ุงููุฎุฒูู():
    print("โ" * 40)
    print(f"{'ุงูููุชุฌ':<10}{'ุงููููุฉ':<10}{'ุงูุณุนุฑ':<10}")
    print("โ" * 40)
    for ููุชุฌ, ุจูุงูุงุช in ุงููุฎุฒูู.items():
        print(f"{ููุชุฌ:<10}{ุจูุงูุงุช['ุงููููุฉ']:<10}{ุจูุงูุงุช['ุงูุณุนุฑ']:<10}")
    print("โ" * 40)

# ๐ ููุทุฉ ุงูุจุฏุงูุฉ
if __name__ == "__main__":
    ุชุญุฏูุซ_ุงููุฎุฒูู("ุชูุงุญ", 2, "ุดุฑุงุก")
    ุชุญุฏูุซ_ุงููุฎุฒูู("ููุฒ", 3, "ุจูุน")
    ุทุจุงุนุฉ_ุงููุฎุฒูู()
    ุญูุธ_ุงูุณุฌู_ูู_CSV()

from datetime import datetime
import csv

ุงููุฎุฒูู = {
    "ุชูุงุญ": {"ุงููููุฉ": 10, "ุงูุณุนุฑ": 5},
    "ููุฒ": {"ุงููููุฉ": 15, "ุงูุณุนุฑ": 3},
    "ุจุฑุชูุงู": {"ุงููููุฉ": 8, "ุงูุณุนุฑ": 4}
}
ุงูุณุฌู = []

def ุชุญุฏูุซ_ุงููุฎุฒูู(ุงูููุชุฌ, ุงููููุฉ, ููุน):
    try:
        if ุงูููุชุฌ in ุงููุฎุฒูู:
            if ููุน == "ุดุฑุงุก":
                ุงููุฎุฒูู[ุงูููุชุฌ]["ุงููููุฉ"] += ุงููููุฉ
            elif ููุน == "ุจูุน":
                ุงููุฎุฒูู[ุงูููุชุฌ]["ุงููููุฉ"] -= ุงููููุฉ
            else:
                raise ValueError("โ๏ธ ููุน ุงูุนูููุฉ ุบูุฑ ูุนุฑูู")
            ุงูุณุฌู.append((ุงูููุชุฌ, ุงููููุฉ, ููุน))
        else:
            raise KeyError("โ ุงูููุชุฌ ุบูุฑ ููุฌูุฏ ูู ุงููุฎุฒูู")
    except Exception as e:
        ุชุณุฌูู_ุงูุฎุทุฃ(e)

def ุชุณุฌูู_ุงูุฎุทุฃ(ุงูุฎุทุฃ):
    ุงูุขู = datetime.now().strftime('%Y-%m-%d %H:%M:%S')
    with open("ุณุฌู_ุงูุฃุฎุทุงุก.csv", mode='a', encoding='utf-8-sig', newline='') as ููู:
        writer = csv.writer(ููู)
        writer.writerow([ุงูุขู, str(ุงูุฎุทุฃ)])
    print(f"๐จ ุฎุทุฃ ุชู ุชุณุฌููู: {ุงูุฎุทุฃ}")

def ุญูุธ_ุงูุณุฌู_ูู_CSV():
    ุงูุขู = datetime.now()
    ุงุณู_ุงูููู = f"ุณุฌู_ุงููุฎุฒูู_{ุงูุขู.strftime('%Y_%m_%d_%H%M')}.csv"
    with open(ุงุณู_ุงูููู, mode='w', encoding='utf-8-sig', newline='') as ููู:
        writer = csv.writer(ููู)
        writer.writerow(["ุงูููุชุฌ", "ุงููููุฉ", "ุงูุนูููุฉ"])
        for ุนูููุฉ in ุงูุณุฌู:
            writer.writerow(ุนูููุฉ)
    print(f"โ ุชู ุญูุธ ุงูููู ุจุงุณู: {ุงุณู_ุงูููู}")

# ููุทุฉ ุงูุจุฏุงูุฉ
if __name__ == "__main__":
    # ุชุฌุฑุจุฉ ุฎุทุฃ ูุชุนููุฏ ูุงุฎุชุจุงุฑ ุงููุธุงู
    ุชุญุฏูุซ_ุงููุฎุฒูู("ุฃูุงูุงุณ", 5, "ุดุฑุงุก")
    ุชุญุฏูุซ_ุงููุฎุฒูู("ุชูุงุญ", 2, "ุจูุน")
    ุชุญุฏูุซ_ุงููุฎุฒูู("ููุฒ", 3, "ุงุณุชุฑุฌุงุน")
    ุญูุธ_ุงูุณุฌู_ูู_CSV()

from datetime import datetime
import csv

ุงููุฎุฒูู = {
    "ุชูุงุญ": {"ุงููููุฉ": 10, "ุงูุณุนุฑ": 5},
    "ููุฒ": {"ุงููููุฉ": 15, "ุงูุณุนุฑ": 3},
    "ุจุฑุชูุงู": {"ุงููููุฉ": 8, "ุงูุณุนุฑ": 4}
}
ุงูุณุฌู = []

def ุชุญุฏูุซ_ุงููุฎุฒูู(ุงูููุชุฌ, ุงููููุฉ, ููุน):
    try:
        if ุงูููุชุฌ in ุงููุฎุฒูู:
            if ููุน == "ุดุฑุงุก":
                ุงููุฎุฒูู[ุงูููุชุฌ]["ุงููููุฉ"] += ุงููููุฉ
            elif ููุน == "ุจูุน":
                ุงููุฎุฒูู[ุงูููุชุฌ]["ุงููููุฉ"] -= ุงููููุฉ
            else:
                raise ValueError("โ๏ธ ููุน ุงูุนูููุฉ ุบูุฑ ูุนุฑูู")
            ุงูุณุฌู.append((ุงูููุชุฌ, ุงููููุฉ, ููุน))
        else:
            raise KeyError("โ ุงูููุชุฌ ุบูุฑ ููุฌูุฏ ูู ุงููุฎุฒูู")
    except Exception as e:
        ุชุณุฌูู_ุงูุฎุทุฃ(e)

def ุชุณุฌูู_ุงูุฎุทุฃ(ุงูุฎุทุฃ):
    ุงูุขู = datetime.now().strftime('%Y-%m-%d %H:%M:%S')
    with open("ุณุฌู_ุงูุฃุฎุทุงุก.csv", mode='a', encoding='utf-8-sig', newline='') as ููู:
        writer = csv.writer(ููู)
        writer.writerow([ุงูุขู, str(ุงูุฎุทุฃ)])
    print(f"๐จ ุฎุทุฃ ุชู ุชุณุฌููู: {ุงูุฎุทุฃ}")

def ุญูุธ_ุงูุณุฌู_ูู_CSV():
    ุงูุขู = datetime.now()
    ุงุณู_ุงูููู = f"ุณุฌู_ุงููุฎุฒูู_{ุงูุขู.strftime('%Y_%m_%d_%H%M')}.csv"
    with open(ุงุณู_ุงูููู, mode='w', encoding='utf-8-sig', newline='') as ููู:
        writer = csv.writer(ููู)
        writer.writerow(["ุงูููุชุฌ", "ุงููููุฉ", "ุงูุนูููุฉ"])
        for ุนูููุฉ in ุงูุณุฌู:
            writer.writerow(ุนูููุฉ)
    print(f"โ ุชู ุญูุธ ุงูููู ุจุงุณู: {ุงุณู_ุงูููู}")

# ููุทุฉ ุงูุจุฏุงูุฉ
if __name__ == "__main__":
    # ุชุฌุฑุจุฉ ุฎุทุฃ ูุชุนููุฏ ูุงุฎุชุจุงุฑ ุงููุธุงู
    ุชุญุฏูุซ_ุงููุฎุฒูู("ุฃูุงูุงุณ", 5, "ุดุฑุงุก")
    ุชุญุฏูุซ_ุงููุฎุฒูู("ุชูุงุญ", 2, "ุจูุน")
    ุชุญุฏูุซ_ุงููุฎุฒูู("ููุฒ", 3, "ุงุณุชุฑุฌุงุน")
    ุญูุธ_ุงูุณุฌู_ูู_CSV()

from tkinter import messagebox
import traceback

def ุชุณุฌูู_ุงูุฎุทุฃ_ุงูููุจุซู(ุงูุฎุทุฃ):
    # ุชุณุฌูู ูู ููู
    ุงูุขู = datetime.now().strftime('%Y-%m-%d %H:%M:%S')
    with open("ุณุฌู_ุงูุฃุฎุทุงุก.csv", mode='a', encoding='utf-8-sig', newline='') as ููู:
        writer = csv.writer(ููู)
        writer.writerow([ุงูุขู, str(ุงูุฎุทุฃ)])

    # ุชูุจูู ููุจุซู
    ุฑุณุงูุฉ = f"ุญุฏุซ ุฎุทุฃ ุฃุซูุงุก ุงูุชุดุบูู:\n{ุงูุฎุทุฃ}"
    messagebox.showerror("๐จ ุชูุจูู ุฎุทุฃ", ุฑุณุงูุฉ)import tkinter as tk
from datetime import datetime
import csv

def ุชุณุฌูู_ุงูุฎุทุฃ_ุฏุงุฎู_ุงููุงุฌูุฉ(ุงููุงุฌูุฉ, ูุฑุจุน_ุงูุฎุทุฃ, ุงูุฎุทุฃ):
    ุงูุขู = datetime.now().strftime('%Y-%m-%d %H:%M:%S')
    
    # ุญูุธ ูู ููู ุงูุฃุฎุทุงุก
    with open("ุณุฌู_ุงูุฃุฎุทุงุก.csv", mode='a', encoding='utf-8-sig', newline='') as ููู:
        writer = csv.writer(ููู)
        writer.writerow([ุงูุขู, str(ุงูุฎุทุฃ)])
    
    # ุนุฑุถ ุงูุฎุทุฃ ุฏุงุฎู ูุฑุจุน ุงููุต
    ูุฑุจุน_ุงูุฎุทุฃ.config(state='normal')  # ูู ุงูุญูุงูุฉ
    ูุฑุจุน_ุงูุฎุทุฃ.delete(1.0, tk.END)     # ุญุฐู ุงููุต ุงูุณุงุจู
    ูุฑุจุน_ุงูุฎุทุฃ.insert(tk.END, f"๐จ ุญุฏุซ ุฎุทุฃ:\n{ุงูุฎุทุฃ}")
    ูุฑุจุน_ุงูุฎุทุฃ.config(state='disabled')  # ุฅุนุงุฏุฉ ุงูุญูุงูุฉ

def ุชูููุฐ_ุงูุนูููุฉ():
    try:
        ููุน = "ุงุณุชุฑุฌุงุน"
        if ููุน not in ["ุดุฑุงุก", "ุจูุน"]:
            raise ValueError(f"โ๏ธ ููุน ุงูุนูููุฉ '{ููุน}' ุบูุฑ ูุฏุนูู")
    except Exception as e:
        ุชุณุฌูู_ุงูุฎุทุฃ_ุฏุงุฎู_ุงููุงุฌูุฉ(ูุงูุฐุฉ, ูุฑุจุน_ุงูุฎุทุฃ, e)

# ุฅูุดุงุก ุงููุงุฌูุฉ
ูุงูุฐุฉ = tk.Tk()
ูุงูุฐุฉ.title("ูุธุงู ุนุฑุถ ุงูุฎุทุฃ ุฏุงุฎู ุงูุชุทุจูู")

ุฒุฑ_ุชูููุฐ = tk.Button(ูุงูุฐุฉ, text="ุชูููุฐ ุงูุนูููุฉ", command=ุชูููุฐ_ุงูุนูููุฉ)
ุฒุฑ_ุชูููุฐ.pack(pady=10)

# ูุฑุจุน ุฎุงุต ูุนุฑุถ ุงูุฎุทุฃ
ูุฑุจุน_ุงูุฎุทุฃ = tk.Text(ูุงูุฐุฉ, height=5, width=50, fg='red', font=('Arial', 12))
ูุฑุจุน_ุงูุฎุทุฃ.pack()
ูุฑุจุน_ุงูุฎุทุฃ.config(state='disabled')  # ุญูุงูุฉ ุงููุชุงุจุฉ

ูุงูุฐุฉ.mainloop()

import tkinter as tk
from datetime import datetime
import csv

# ุชุณุฌูู ุงูุฎุทุฃ ุฏุงุฎู ูุงุฆูุฉ ุงูุฃุฎุทุงุก
def ุชุณุฌูู_ุงูุฎุทุฃ_ูู_ุงููุงุฆูุฉ(ุงููุงุฆูุฉ, ุงูุฎุทุฃ):
    ุงูุขู = datetime.now().strftime('%Y-%m-%d %H:%M:%S')
    
    # ุญูุธ ูู ููู CSV
    with open("ุณุฌู_ุงูุฃุฎุทุงุก.csv", mode='a', encoding='utf-8-sig', newline='') as ููู:
        writer = csv.writer(ููู)
        writer.writerow([ุงูุขู, str(ุงูุฎุทุฃ)])
    
    # ุฅุถุงูุฉ ุงูุฎุทุฃ ุฅูู ุงููุงุฆูุฉ
    ุงููุงุฆูุฉ.insert(tk.END, f"[{ุงูุขู}] {ุงูุฎุทุฃ}")

def ุชูููุฐ_ุงูุนูููุฉ():
    try:
        ููุน = "ุงุณุชุฑุฌุงุน"
        if ููุน not in ["ุดุฑุงุก", "ุจูุน"]:
            raise ValueError(f"โ๏ธ ููุน ุงูุนูููุฉ '{ููุน}' ุบูุฑ ูุฏุนูู")
    except Exception as e:
        ุชุณุฌูู_ุงูุฎุทุฃ_ูู_ุงููุงุฆูุฉ(ูุงุฆูุฉ_ุงูุฃุฎุทุงุก, e)

# ูุงุฌูุฉ ุงูุชุทุจูู
ูุงูุฐุฉ = tk.Tk()
ูุงูุฐุฉ.title("ูุธุงู ุฅุฏุงุฑุฉ ุงูุฃุฎุทุงุก")

ุฒุฑ_ุชูููุฐ = tk.Button(ูุงูุฐุฉ, text="ุชูููุฐ ุงูุนูููุฉ", command=ุชูููุฐ_ุงูุนูููุฉ)
ุฒุฑ_ุชูููุฐ.pack(pady=10)

# ุฅุทุงุฑ ูุญุชูู ุนูู ุงููุงุฆูุฉ ูุดุฑูุท ุงูุชูุฑูุฑ
ุฅุทุงุฑ = tk.Frame(ูุงูุฐุฉ)
ุฅุทุงุฑ.pack()

# ูุงุฆูุฉ ุงูุฃุฎุทุงุก
ูุงุฆูุฉ_ุงูุฃุฎุทุงุก = tk.Listbox(ุฅุทุงุฑ, width=80, height=10, font=('Arial', 12), fg='red')
ูุงุฆูุฉ_ุงูุฃุฎุทุงุก.pack(side=tk.LEFT, fill=tk.BOTH)

# ุดุฑูุท ุชูุฑูุฑ ูุฑุชุจุท ุจุงููุงุฆูุฉ
ุดุฑูุท = tk.Scrollbar(ุฅุทุงุฑ)
ุดุฑูุท.pack(side=tk.RIGHT, fill=tk.Y)
ูุงุฆูุฉ_ุงูุฃุฎุทุงุก.config(yscrollcommand=ุดุฑูุท.set)
ุดุฑูุท.config(command=ูุงุฆูุฉ_ุงูุฃุฎุทุงุก.yview)

ูุงูุฐุฉ.mainloop()

import tkinter as tk
from tkinter import messagebox
from datetime import datetime
import csv

# ุชุณุฌูู ุงูุฎุทุฃ ุฏุงุฎู ุงููุงุฆูุฉ
def ุชุณุฌูู_ุงูุฎุทุฃ_ูู_ุงููุงุฆูุฉ(ุงููุงุฆูุฉ, ุงูุฎุทุฃ, ุณุฌู):
    ุงูุขู = datetime.now().strftime('%Y-%m-%d %H:%M:%S')
    ุงููุต = f"[{ุงูุขู}] {ุงูุฎุทุฃ}"
    ุงููุงุฆูุฉ.insert(tk.END, ุงููุต)

    # ุญูุธ ูู ููู CSV
    with open(sุฌู, mode='a', encoding='utf-8-sig', newline='') as ููู:
        writer = csv.writer(ููู)
        writer.writerow([ุงูุขู, str(ุงูุฎุทุฃ)])

# ุนุฑุถ ุชูุงุตูู ุงูุฎุทุฃ ุนูุฏ ุงูุถุบุท
def ุนุฑุถ_ุงูุชูุงุตูู(event):
    ุงููุฎุชุงุฑ = ูุงุฆูุฉ_ุงูุฃุฎุทุงุก.curselection()
    if ุงููุฎุชุงุฑ:
        ุงููุต = ูุงุฆูุฉ_ุงูุฃุฎุทุงุก.get(ุงููุฎุชุงุฑ)
        messagebox.showinfo("ุชูุงุตูู ุงูุฎุทุฃ", ุงููุต)

# ุฒุฑ ููุณุญ ูู ุงูุฃุฎุทุงุก
def ูุณุญ_ุงููุงุฆูุฉ():
    ูุงุฆูุฉ_ุงูุฃุฎุทุงุก.delete(0, tk.END)

def ุชูููุฐ_ุงูุนูููุฉ():
    try:
        ููุน = "ุงุณุชุฑุฌุงุน"
        if ููุน not in ["ุดุฑุงุก", "ุจูุน"]:
            raise ValueError(f"โ๏ธ ููุน ุงูุนูููุฉ '{ููุน}' ุบูุฑ ูุฏุนูู")
    except Exception as e:
        ุชุณุฌูู_ุงูุฎุทุฃ_ูู_ุงููุงุฆูุฉ(ูุงุฆูุฉ_ุงูุฃุฎุทุงุก, e, "ุณุฌู_ุงูุฃุฎุทุงุก.csv")

# ูุงุฌูุฉ ุงููุณุชุฎุฏู
ูุงูุฐุฉ = tk.Tk()
ูุงูุฐุฉ.title("๐ ูุฏูุฑ ุงูุฃุฎุทุงุก ุงูุชูุงุนูู")

ุฒุฑ_ุชูููุฐ = tk.Button(ูุงูุฐุฉ, text="ุชูููุฐ ุงูุนูููุฉ", command=ุชูููุฐ_ุงูุนูููุฉ)
ุฒุฑ_ุชูููุฐ.pack(pady=10)

# ุงูุฅุทุงุฑ ุงูุฐู ูุญุชูู ุนูู ุงููุงุฆูุฉ ูุดุฑูุท ุงูุชูุฑูุฑ
ุฅุทุงุฑ = tk.Frame(ูุงูุฐุฉ)
ุฅุทุงุฑ.pack()

ูุงุฆูุฉ_ุงูุฃุฎุทุงุก = tk.Listbox(ุฅุทุงุฑ, width=80, height=10, font=('Arial', 12), fg='red')
ูุงุฆูุฉ_ุงูุฃุฎุทุงุก.pack(side=tk.LEFT, fill=tk.BOTH)

ุดุฑูุท = tk.Scrollbar(ุฅุทุงุฑ)
ุดุฑูุท.pack(side=tk.RIGHT, fill=tk.Y)
ูุงุฆูุฉ_ุงูุฃุฎุทุงุก.config(yscrollcommand=ุดุฑูุท.set)
ุดุฑูุท.config(command=ูุงุฆูุฉ_ุงูุฃุฎุทุงุก.yview)

# ุฑุจุท ุงูุถุบุท ุนูู ุนูุตุฑ ุจุงููุงุฆูุฉ
ูุงุฆูุฉ_ุงูุฃุฎุทุงุก.bind('<<ListboxSelect>>', ุนุฑุถ_ุงูุชูุงุตูู)

ุฒุฑ_ูุณุญ = tk.Button(ูุงูุฐุฉ, text="๐งน ูุณุญ ุฌููุน ุงูุฃุฎุทุงุก", command=ูุณุญ_ุงููุงุฆูุฉ)
ุฒุฑ_ูุณุญ.pack(pady=10)

ูุงูุฐุฉ.mainloop()

import tkinter as tk
from tkinter import messagebox

# ุฏุงูุฉ ูุฅุถุงูุฉ ูุฑุชุฌุน
def ุฅุถุงูุฉ_ูุฑุชุฌุน():
    ุงูุนูุตุฑ = ุฅุฏุฎุงู_ุงููุฑุชุฌุน.get()
    if ุงูุนูุตุฑ:
        ูุงุฆูุฉ_ุงููุฑุชุฌุนุงุช.insert(tk.END, ุงูุนูุตุฑ)
        ุฅุฏุฎุงู_ุงููุฑุชุฌุน.delete(0, tk.END)
    else:
        messagebox.showwarning("ุชูุจูู", "ูุฑุฌู ุฅุฏุฎุงู ุงุณู ุงููุฑุชุฌุน ุฃูููุง!")

# ุฏุงูุฉ ูุญุฐู ุงููุฑุชุฌุน ุงููุฎุชุงุฑ
def ุญุฐู_ุงููุฑุชุฌุน():
    ูุฎุชุงุฑ = ูุงุฆูุฉ_ุงููุฑุชุฌุนุงุช.curselection()
    if ูุฎุชุงุฑ:
        ูุงุฆูุฉ_ุงููุฑุชุฌุนุงุช.delete(ูุฎุชุงุฑ)
    else:
        messagebox.showinfo("ูุนูููุฉ", "ุงุฎุชุฑ ูุฑุชุฌุนูุง ููุญุฐู.")

# ุฏุงูุฉ ูุนุฑุถ ุชูุงุตูู ุงููุฑุชุฌุน
def ุนุฑุถ_ุงูุชูุงุตูู(event):
    ูุฎุชุงุฑ = ูุงุฆูุฉ_ุงููุฑุชุฌุนุงุช.curselection()
    if ูุฎุชุงุฑ:
        ุงุณู = ูุงุฆูุฉ_ุงููุฑุชุฌุนุงุช.get(ูุฎุชุงุฑ)
        messagebox.showinfo("ุชูุงุตูู ุงููุฑุชุฌุน", f"ุงููุฑุชุฌุน ุงููุฎุชุงุฑ:\n{ุงุณู}")

# ุงููุงุฌูุฉ
ูุงูุฐุฉ = tk.Tk()
ูุงูุฐุฉ.title("๐ ูุงุฆูุฉ ุงููุฑุชุฌุนุงุช")

# ูุฏุฎู ุงูุฅุฏุฎุงู
ุฅุฏุฎุงู_ุงููุฑุชุฌุน = tk.Entry(ูุงูุฐุฉ, font=('Arial', 12), width=40)
ุฅุฏุฎุงู_ุงููุฑุชุฌุน.pack(pady=5)

# ุฒุฑ ุงูุฅุถุงูุฉ
ุฒุฑ_ุฅุถุงูุฉ = tk.Button(ูุงูุฐุฉ, text="โ ุฅุถุงูุฉ ูุฑุชุฌุน", command=ุฅุถุงูุฉ_ูุฑุชุฌุน)
ุฒุฑ_ุฅุถุงูุฉ.pack(pady=5)

# ุงููุงุฆูุฉ
ูุงุฆูุฉ_ุงููุฑุชุฌุนุงุช = tk.Listbox(ูุงูุฐุฉ, width=50, height=10, font=('Arial', 12))
ูุงุฆูุฉ_ุงููุฑุชุฌุนุงุช.pack(pady=10)

# ุฑุจุท ุงูุถุบุท ุนูู ุนูุตุฑ ูุนุฑุถ ุงูุชูุงุตูู
ูุงุฆูุฉ_ุงููุฑุชุฌุนุงุช.bind('<<ListboxSelect>>', ุนุฑุถ_ุงูุชูุงุตูู)

# ุฒุฑ ุงูุญุฐู
ุฒุฑ_ุญุฐู = tk.Button(ูุงูุฐุฉ, text="๐๏ธ ุญุฐู ุงููุฑุชุฌุน", command=ุญุฐู_ุงููุฑุชุฌุน)
ุฒุฑ_ุญุฐู.pack(pady=5)

ูุงูุฐุฉ.mainloop()
import tkinter as tk
from datetime import datetime
import csv

ุงููุฑุชุฌุนุงุช_ุงููุงููุฉ = []

def ุฅุถุงูุฉ_ูุฑุชุฌุน():
    ุงูุงุณู = ุฅุฏุฎุงู_ุงูุงุณู.get()
    ุงูููุน = ุงุฎุชูุงุฑ_ุงูููุน.get()
    ุงูุขู = datetime.now().strftime('%Y-%m-%d %H:%M')

    if ุงูุงุณู:
        ูุต = f"{ุงูุงุณู} | ุงูููุน: {ุงูููุน} | ุงูุชุงุฑูุฎ: {ุงูุขู}"
        ุงููุฑุชุฌุนุงุช_ุงููุงููุฉ.append((ุงูุงุณู, ุงูููุน, ุงูุขู))
        ุชุญุฏูุซ_ุงููุงุฆูุฉ(ุงูููุน_ุงููุญุฏุฏ.get())

        with open("ุงููุฑุชุฌุนุงุช.csv", mode='a', encoding='utf-8-sig', newline='') as ููู:
            writer = csv.writer(ููู)
            writer.writerow([ุงูุงุณู, ุงูููุน, ุงูุขู])

        ุฅุฏุฎุงู_ุงูุงุณู.delete(0, tk.END)

def ุชุญุฏูุซ_ุงููุงุฆูุฉ(ููุน_ูุทููุจ):
    ูุงุฆูุฉ_ุงูุนุฑุถ.delete(0, tk.END)
    for ุงุณู, ููุน, ููุช in ุงููุฑุชุฌุนุงุช_ุงููุงููุฉ:
        if ููุน_ูุทููุจ == "ุงููู" or ููุน == ููุน_ูุทููุจ:
            ูุงุฆูุฉ_ุงูุนุฑุถ.insert(tk.END, f"{ุงุณู} | ุงูููุน: {ููุน} | ุงูุชุงุฑูุฎ: {ููุช}")

def ุญุฐู_ุงููุฎุชุงุฑ():
    ูุฎุชุงุฑ = ูุงุฆูุฉ_ุงูุนุฑุถ.curselection()
    if ูุฎุชุงุฑ:
        ุงููุต = ูุงุฆูุฉ_ุงูุนุฑุถ.get(ูุฎุชุงุฑ)
        ูุงุฆูุฉ_ุงูุนุฑุถ.delete(ูุฎุชุงุฑ)
        # ุฅุฒุงูุฉ ูู ุงููุฑุชุฌุนุงุช_ุงููุงููุฉ
        ุงููุฑุชุฌุนุงุช_ุงููุงููุฉ[:] = [r for r in ุงููุฑุชุฌุนุงุช_ุงููุงููุฉ if f"{r[0]} | ุงูููุน: {r[1]} | ุงูุชุงุฑูุฎ: {r[2]}" != ุงููุต]

def ุชุตููุฉ_ุญุณุจ_ุงูููุน(_):
    ุชุญุฏูุซ_ุงููุงุฆูุฉ(ููุน_ุงููุญุฏุฏ.get())

# ุฅูุดุงุก ุงููุงุฌูุฉ
ูุงูุฐุฉ = tk.Tk()
ูุงูุฐุฉ.title("๐ ูุฏูุฑ ุงููุฑุชุฌุนุงุช ุงูุงุญุชุฑุงูู")

tk.Label(ูุงูุฐุฉ, text="๐ฆ ุงุณู ุงููุฑุชุฌุน").pack()
ุฅุฏุฎุงู_ุงูุงุณู = tk.Entry(ูุงูุฐุฉ, font=('Arial', 12), width=40)
ุฅุฏุฎุงู_ุงูุงุณู.pack(pady=5)

tk.Label(ูุงูุฐุฉ, text="๐ ููุน ุงูููุชุฌ").pack()
ุงูุฃููุงุน = ["ุฅููุชุฑูููุงุช", "ููุงุจุณ", "ุฃุบุฐูุฉ", "ุฃุฏูุงุช ููุชุจูุฉ"]
ุงุฎุชูุงุฑ_ุงูููุน = tk.StringVar(value=ุงูุฃููุงุน[0])
ูุงุฆูุฉ_ุงูุฃููุงุน = tk.OptionMenu(ูุงูุฐุฉ, ุงุฎุชูุงุฑ_ุงูููุน, *ุงูุฃููุงุน)
ูุงุฆูุฉ_ุงูุฃููุงุน.pack(pady=5)

tk.Button(ูุงูุฐุฉ, text="โ ุฅุถุงูุฉ ุงููุฑุชุฌุน", command=ุฅุถุงูุฉ_ูุฑุชุฌุน).pack(pady=5)

# ุชุตููุฉ ุญุณุจ ุงูููุน
tk.Label(ูุงูุฐุฉ, text="๐ ุชุตููุฉ ุญุณุจ ุงูููุน").pack()
ููุน_ุงููุญุฏุฏ = tk.StringVar(value="ุงููู")
ูุงุฆูุฉ_ุชุตููุฉ = tk.OptionMenu(ูุงูุฐุฉ, ููุน_ุงููุญุฏุฏ, "ุงููู", *ุงูุฃููุงุน, command=ุชุตููุฉ_ุญุณุจ_ุงูููุน)
ูุงุฆูุฉ_ุชุตููุฉ.pack(pady=5)

# ูุงุฆูุฉ ุงูุนุฑุถ
ูุงุฆูุฉ_ุงูุนุฑุถ = tk.Listbox(ูุงูุฐุฉ, width=60, height=10, font=('Arial', 12))
ูุงุฆูุฉ_ุงูุนุฑุถ.pack(pady=10)

# ุฒุฑ ุญุฐู ุงููุฎุชุงุฑ
tk.Button(ูุงูุฐุฉ, text="๐๏ธ ุญุฐู ุงููุฑุชุฌุน ุงููุฎุชุงุฑ", command=ุญุฐู_ุงููุฎุชุงุฑ).pack(pady=5)

ูุงูุฐุฉ.mainloop()
def ุงูุจุญุซ_ุจุงูุงุณู():
    ููุชุงุญ = ูุฑุจุน_ุงูุจุญุซ.get().lower()
    ูุงุฆูุฉ_ุงูุนุฑุถ.delete(0, tk.END)
    for ุงุณู, ููุน, ููุช in ุงููุฑุชุฌุนุงุช_ุงููุงููุฉ:
        if ููุชุงุญ in ุงุณู.lower():
            ูุงุฆูุฉ_ุงูุนุฑุถ.insert(tk.END, f"{ุงุณู} | ุงูููุน: {ููุน} | ุงูุชุงุฑูุฎ: {ููุช}")

from reportlab.platypus import SimpleDocTemplate, Paragraph
from reportlab.lib.styles import getSampleStyleSheet

def ุชุตุฏูุฑ_PDF():
    doc = SimpleDocTemplate("ุงููุฑุชุฌุนุงุช.pdf")
    ุณุชุงูู = getSampleStyleSheet()
    ุนูุงุตุฑ = []

    ุนูุงุตุฑ.append(Paragraph("๐ ูุงุฆูุฉ ุงููุฑุชุฌุนุงุช", ุณุชุงูู['Title']))
    for ุงุณู, ููุน, ููุช in ุงููุฑุชุฌุนุงุช_ุงููุงููุฉ:
        ุนูุงุตุฑ.append(Paragraph(f"- {ุงุณู} | ุงูููุน: {ููุน} | ุงูุชุงุฑูุฎ: {ููุช}", ุณุชุงูู['Normal']))

    doc.build(ุนูุงุตุฑ)
    messagebox.showinfo("โ ุชู", "ุชู ุชุตุฏูุฑ ุงููุฑุชุฌุนุงุช ุฅูู ููู PDF ุจูุฌุงุญ!")

from collections import Counter

def ุนุฑุถ_ุงูุฅุญุตุงุฆูุงุช():
    ุงูุนุฏ = Counter([ููุน for _, ููุน, _ in ุงููุฑุชุฌุนุงุช_ุงููุงููุฉ])
    ุฑุณุงุฆู = [f"{ููุน}: {ุนุฏุฏ}" for ููุน, ุนุฏุฏ in ุงูุนุฏ.items()]
    ูุต = "\n".join(ุฑุณุงุฆู)
    messagebox.showinfo("๐ ุฅุญุตุงุฆูุงุช ุงููุฑุชุฌุนุงุช", ูุต)

# ูุฑุจุน ุงูุจุญุซ
tk.Label(ูุงูุฐุฉ, text="๐ ุจุญุซ ุญุณุจ ุงูุงุณู").pack()
ูุฑุจุน_ุงูุจุญุซ = tk.Entry(ูุงูุฐุฉ, font=('Arial', 12), width=30)
ูุฑุจุน_ุงูุจุญุซ.pack(pady=5)
tk.Button(ูุงูุฐุฉ, text="๐ ุจุญุซ", command=ุงูุจุญุซ_ุจุงูุงุณู).pack()

# tk.Button(ูุงูุฐุฉ, text="๐ ุจุญุซ ุถูู ุงูููุน ุงููุญุฏุฏ", command=ุงูุจุญุซ_ุจุงูุงุณู_ุฏุงุฎู_ุงูููุน).pack(pady=5)


# ุฒุฑ ุงูุฅุญุตุงุฆูุงุช
tk.Button(ูุงูุฐุฉ, text="๐ ุนุฑุถ ุฅุญุตุงุฆูุงุช ุงููุฑุชุฌุนุงุช", command=ุนุฑุถ_ุงูุฅุญุตุงุฆูุงุช).pack(pady=5)

tk.Button(ูุงูุฐุฉ, text="๐ ูุณุฎ ุงููุฑุชุฌุน ุฅูู ุงูุญุงูุธุฉ", command=ูุณุฎ_ุฅูู_ุงูุญุงูุธุฉ).pack(pady=5)๐ icons/
    โค add.png
    โค delete.png
    โค search.png
    โค pdf.png
    โค stats.png
    โค copy.png

import tkinter as tk
from tkinter import messagebox
from datetime import datetime
from tkinter import PhotoImage
import csv
from collections import Counter
from reportlab.platypus import SimpleDocTemplate, Paragraph
from reportlab.lib.styles import getSampleStyleSheet

ุงููุฑุชุฌุนุงุช_ุงููุงููุฉ = []

def ุฅุถุงูุฉ_ูุฑุชุฌุน():
    ุงูุงุณู = ุฅุฏุฎุงู_ุงูุงุณู.get()
    ุงูููุน = ุงุฎุชูุงุฑ_ุงูููุน.get()
    ุงูุขู = datetime.now().strftime('%Y-%m-%d %H:%M')

    if ุงูุงุณู:
        ุงููุฑุชุฌุนุงุช_ุงููุงููุฉ.append((ุงูุงุณู, ุงูููุน, ุงูุขู))
        ุชุญุฏูุซ_ุงููุงุฆูุฉ(ููุน_ุงููุญุฏุฏ.get())
        ุฅุฏุฎุงู_ุงูุงุณู.delete(0, tk.END)

        with open("ุงููุฑุชุฌุนุงุช.csv", mode='a', encoding='utf-8-sig', newline='') as ููู:
            writer = csv.writer(ููู)
            writer.writerow([ุงูุงุณู, ุงูููุน, ุงูุขู])
    else:
        messagebox.showwarning("โ๏ธ", "ูุฑุฌู ุฅุฏุฎุงู ุงุณู ุงููุฑุชุฌุน!")

def ุชุญุฏูุซ_ุงููุงุฆูุฉ(ููุน_ูุทููุจ):
    ูุงุฆูุฉ_ุงูุนุฑุถ.delete(0, tk.END)
    for ุงุณู, ููุน, ููุช in ุงููุฑุชุฌุนุงุช_ุงููุงููุฉ:
        if ููุน_ูุทููุจ == "ุงููู" or ููุน == ููุน_ูุทููุจ:
            ูุงุฆูุฉ_ุงูุนุฑุถ.insert(tk.END, f"{ุงุณู} | ุงูููุน: {ููุน} | ุงูุชุงุฑูุฎ: {ููุช}")

def ุชุตููุฉ_ุญุณุจ_ุงูููุน(_):
    ุชุญุฏูุซ_ุงููุงุฆูุฉ(ููุน_ุงููุญุฏุฏ.get())

def ุญุฐู_ุงููุฎุชุงุฑ():
    ูุฎุชุงุฑ = ูุงุฆูุฉ_ุงูุนุฑุถ.curselection()
    if ูุฎุชุงุฑ:
        ุงููุต = ูุงุฆูุฉ_ุงูุนุฑุถ.get(mุฎุชุงุฑ)
        ูุงุฆูุฉ_ุงูุนุฑุถ.delete(mุฎุชุงุฑ)
        ุงููุฑุชุฌุนุงุช_ุงููุงููุฉ[:] = [r for r in ุงููุฑุชุฌุนุงุช_ุงููุงููุฉ if f"{r[0]} | ุงูููุน: {r[1]} | ุงูุชุงุฑูุฎ: {r[2]}" != ุงููุต]

def ูุณุฎ_ุฅูู_ุงูุญุงูุธุฉ():
    ูุฎุชุงุฑ = ูุงุฆูุฉ_ุงูุนุฑุถ.curselection()
    if ูุฎุชุงุฑ:
        ุงููุต = ูุงุฆูุฉ_ุงูุนุฑุถ.get(mุฎุชุงุฑ)
        ูุงูุฐุฉ.clipboard_clear()
        ูุงูุฐุฉ.clipboard_append(ุงููุต)
        messagebox.showinfo("โ ุชู ุงููุณุฎ", "ุชู ูุณุฎ ุงููุฑุชุฌุน ุฅูู ุงูุญุงูุธุฉ.")

def ุงูุจุญุซ_ุจุงูุงุณู_ุฏุงุฎู_ุงูููุน():
    ููุชุงุญ = ูุฑุจุน_ุงูุจุญุซ.get().lower()
    ููุน_ูุทููุจ = ููุน_ุงููุญุฏุฏ.get()
    ูุงุฆูุฉ_ุงูุนุฑุถ.delete(0, tk.END)
    for ุงุณู, ููุน, ููุช in ุงููุฑุชุฌุนุงุช_ุงููุงููุฉ:
        if (ููุน_ูุทููุจ == "ุงููู" or ููุน == ููุน_ูุทููุจ) and (ููุชุงุญ in ุงุณู.lower()):
            ูุงุฆูุฉ_ุงูุนุฑุถ.insert(tk.END, f"{ุงุณู} | ุงูููุน: {ููุน} | ุงูุชุงุฑูุฎ: {ููุช}")

def ุชุตุฏูุฑ_PDF():
    doc = SimpleDocTemplate("ุงููุฑุชุฌุนุงุช.pdf")
    ุณุชุงูู = getSampleStyleSheet()
    ุนูุงุตุฑ = [Paragraph("๐ ูุงุฆูุฉ ุงููุฑุชุฌุนุงุช", ุณุชุงูู['Title'])]
    for ุงุณู, ููุน, ููุช in ุงููุฑุชุฌุนุงุช_ุงููุงููุฉ:
        ุนูุงุตุฑ.append(Paragraph(f"- {ุงุณู} | ุงูููุน: {ููุน} | ุงูุชุงุฑูุฎ: {ููุช}", ุณุชุงูู['Normal']))
    doc.build(ุนูุงุตุฑ)
    messagebox.showinfo("โ ุชู", "ุชู ุชุตุฏูุฑ ุงููุฑุชุฌุนุงุช ุฅูู ููู PDF.")

def ุนุฑุถ_ุงูุฅุญุตุงุฆูุงุช():
    ุงูุนุฏ = Counter([ููุน for _, ููุน, _ in ุงููุฑุชุฌุนุงุช_ุงููุงููุฉ])
    ูุต = "\n".join([f"{ููุน}: {ุนุฏุฏ}" for ููุน, ุนุฏุฏ in ุงูุนุฏ.items()])
    messagebox.showinfo("๐ ุฅุญุตุงุฆูุงุช ุงููุฑุชุฌุนุงุช", ูุต)

# ุงููุงุฌูุฉ
ูุงูุฐุฉ = tk.Tk()
ูุงูุฐุฉ.title("๐ฏ ูุฏูุฑ ุงููุฑุชุฌุนุงุช ุงููุชุทูุฑ")

# ุชุญููู ุงูุตูุฑ
ุฃููููุฉ_ุฅุถุงูุฉ = PhotoImage(file="icons/add.png")
ุฃููููุฉ_ุจุญุซ = PhotoImage(file="icons/search.png")
ุฃููููุฉ_ูุณุฎ = PhotoImage(file="icons/copy.png")
ุฃููููุฉ_PDF = PhotoImage(file="icons/pdf.png")
ุฃููููุฉ_ุญุฐู = PhotoImage(file="icons/delete.png")
ุฃููููุฉ_ุฅุญุตุงุก = PhotoImage(file="icons/stats.png")

# ุฅุฏุฎุงู ุงูุงุณู
tk.Label(ูุงูุฐุฉ, text="๐ฆ ุงุณู ุงููุฑุชุฌุน").grid(row=0, column=0, padx=5, pady=5)
ุฅุฏุฎุงู_ุงูุงุณู = tk.Entry(ูุงูุฐุฉ, font=('Arial', 12), width=30)
ุฅุฏุฎุงู_ุงูุงุณู.grid(row=0, column=1, columnspan=2, padx=5)

# ุงุฎุชูุงุฑ ุงูููุน
tk.Label(ูุงูุฐุฉ, text="๐ ููุน ุงูููุชุฌ").grid(row=1, column=0)
ุงูุฃููุงุน = ["ุฅููุชุฑูููุงุช", "ููุงุจุณ", "ุฃุบุฐูุฉ", "ุฃุฏูุงุช ููุชุจูุฉ"]
ุงุฎุชูุงุฑ_ุงูููุน = tk.StringVar(value=ุงูุฃููุงุน[0])
tk.OptionMenu(ูุงูุฐุฉ, ุงุฎุชูุงุฑ_ุงูููุน, *ุงูุฃููุงุน).grid(row=1, column=1)

# ุฅุถุงูุฉ
tk.Button(ูุงูุฐุฉ, text="ุฅุถุงูุฉ", image=ุฃููููุฉ_ุฅุถุงูุฉ, compound=tk.LEFT, command=ุฅุถุงูุฉ_ูุฑุชุฌุน).grid(row=1, column=2)

# ูุฑุจุน ุงูุจุญุซ
tk.Label(ูุงูุฐุฉ, text="๐ ุจุญุซ ุญุณุจ ุงูุงุณู").grid(row=2, column=0)
ูุฑุจุน_ุงูุจุญุซ = tk.Entry(ูุงูุฐุฉ, font=('Arial', 12), width=20)
ูุฑุจุน_ุงูุจุญุซ.grid(row=2, column=1)
tk.Button(ูุงูุฐุฉ, text="ุจุญุซ", image=ุฃููููุฉ_ุจุญุซ, compound=tk.LEFT, command=ุงูุจุญุซ_ุจุงูุงุณู_ุฏุงุฎู_ุงูููุน).grid(row=2, column=2)

# ุชุตููุฉ
tk.Label(ูุงูุฐุฉ, text="๐ ููุน ูุชุตููุฉ").grid(row=3, column=0)
ููุน_ุงููุญุฏุฏ = tk.StringVar(value="ุงููู")
tk.OptionMenu(ูุงูุฐุฉ, ููุน_ุงููุญุฏุฏ, "ุงููู", *ุงูุฃููุงุน, command=ุชุตููุฉ_ุญุณุจ_ุงูููุน).grid(row=3, column=1)

# ุงููุงุฆูุฉ
ูุงุฆูุฉ_ุงูุนุฑุถ = tk.Listbox(ูุงูุฐุฉ, width=70, height=10, font=('Arial', 12))
ูุงุฆูุฉ_ุงูุนุฑุถ.grid(row=4, column=0, columnspan=3, padx=10, pady=10)

# ุฃุฒุฑุงุฑ ุฅุถุงููุฉ
tk.Button(ูุงูุฐุฉ, text="ูุณุฎ", image=ุฃููููุฉ_ูุณุฎ, compound=tk.LEFT, command=ูุณุฎ_ุฅูู_ุงูุญุงูุธุฉ).grid(row=5, column=0)
tk.Button(ูุงูุฐุฉ, text="ุญุฐู", image=ุฃููููุฉ_ุญุฐู, compound=tk.LEFT, command=ุญุฐู_ุงููุฎุชุงุฑ).grid(row=5, column=1)
tk.Button(ูุงูุฐุฉ, text="PDF", image=ุฃููููุฉ_PDF, compound=tk.LEFT, command=ุชุตุฏูุฑ_PDF).grid(row=5, column=2)

tk.Button(ูุงูุฐุฉ, text="ุฅุญุตุงุฆูุงุช", image=ุฃููููุฉ_ุฅุญุตุงุก, compound=tk.LEFT, command=ุนุฑุถ_ุงูุฅุญุตุงุฆูุงุช).grid(row=6, column=1, pady=10)

ูุงูุฐุฉ.mainloop()

 ุฌุฏูู = Table(ุจูุงูุงุช)
    ุฌุฏูู.setStyle(TableStyle([
        ('BACKGROUND', (0,0), (-1,0), colors.grey),
        ('TEXTCOLOR', (0,0), (-1,0), colors.whitesmoke),
        ('ALIGN', (0,0), (-1,-1), 'CENTER'),
        ('GRID', (0,0), (-1,-1), 1, colors.black)
    ]))

    doc.build([ุฌุฏูู])
    messagebox.showinfo("โ ุชู", "ุชู ุชุตุฏูุฑ ุงููุงุฆูุฉ ุฅูู PDF.")

from openpyxl import Workbook

def ุชุตุฏูุฑ_Excel():
    wb = Workbook()
    ws = wb.active
    ws.title = "ุงูููุธููู"
    ws.append(["#", "ุงูุงุณู", "ุงููุธููุฉ"])
    for i, (ุงูุงุณู, ุงููุธููุฉ) in enumerate(ุงูููุธููู, start=1):
        ws.append([i, ุงูุงุณู, ุงููุธููุฉ])
    wb.save("ุงูููุธููู.xlsx")
    messagebox.showinfo("โ ุชู", "ุชู ุญูุธ ุงูููู Excel ุจูุฌุงุญ.")

import sqlite3

# ุงูุงุชุตุงู ูุฅูุดุงุก ุงูุฌุฏูู
conn = sqlite3.connect("ุงูููุธููู.db")
cursor = conn.cursor()
cursor.execute("CREATE TABLE IF NOT EXISTS ููุธููู (ุงุณู TEXT, ูุธููุฉ TEXT)")
conn.commit()

def ุญูุธ_ุงูููุธู(ุงูุงุณู, ุงููุธููุฉ):
    cursor.execute("INSERT INTO ููุธููู VALUES (?, ?)", (ุงูุงุณู, ุงููุธููุฉ))
    conn.commit()

def ุงุณุชุฑุฌุงุน_ุงูููุธููู():
    ุงูููุธููู.clear()
    for row in cursor.execute("SELECT * FROM ููุธููู"):
        ุงูููุธููู.append((row[0], row[1]))
    ุชุญุฏูุซ_ุงููุงุฆูุฉ()

ุงูููุธููู.append((ุงูุงุณู, ุงููุธููุฉ, ุงูุชูููู))

ุงุฎุชูุงุฑ_ุงูุชูููู = tk.StringVar(value="โญ๏ธโญ๏ธโญ๏ธ")
tk.OptionMenu(ูุงูุฐุฉ, ุงุฎุชูุงุฑ_ุงูุชูููู, "โญ๏ธ", "โญ๏ธโญ๏ธ", "โญ๏ธโญ๏ธโญ๏ธ", "โญ๏ธโญ๏ธโญ๏ธโญ๏ธ", "โญ๏ธโญ๏ธโญ๏ธโญ๏ธโญ๏ธ").grid(row=3, column=1)
from django.db import models

class ููุชุฌ(models.Model):
    ุงูุงุณู = models.CharField(max_length=100)
    ุงููููุฉ_ุงููุชููุฑุฉ = models.IntegerField(default=0)
    ุงูุณุนุฑ = models.DecimalField(max_digits=10, decimal_places=2)

    def __str__(self):
        return self.ุงูุงุณู

class ุนูููุฉ_ุจูุน(models.Model):
    ุงูููุชุฌ = models.ForeignKey(ููุชุฌ, on_delete=models.CASCADE)
    ุงููููุฉ = models.IntegerField()
    ุงูุชุงุฑูุฎ = models.DateField(auto_now_add=True)

    def __str__(self):
        return f"{self.ุงููููุฉ} ูู {self.ุงูููุชุฌ}"
from django.shortcuts import render
from .models import ููุชุฌ, ุนูููุฉ_ุจูุน
from django.db.models import Sum

def ุนุฑุถ_ุงูููุงุฒูุฉ(request):
    ุงููุชุงุฆุฌ = []

    for ุงูููุชุฌ in ููุชุฌ.objects.all():
        ุงุฌูุงูู_ุงููุจูุนุงุช = ุนูููุฉ_ุจูุน.objects.filter(ุงูููุชุฌ=ุงูููุชุฌ).aggregate(Sum('ุงููููุฉ'))['ุงููููุฉ__sum'] or 0
        ุงููุชุจูู = ุงูููุชุฌ.ุงููููุฉ_ุงููุชููุฑุฉ - ุงุฌูุงูู_ุงููุจูุนุงุช

        ุงููุชุงุฆุฌ.append({
            'ุงูููุชุฌ': ุงูููุชุฌ.ุงูุงุณู,
            'ุงููุฎุฒูู': ุงูููุชุฌ.ุงููููุฉ_ุงููุชููุฑุฉ,
            'ุงููุจูุนุงุช': ุงุฌูุงูู_ุงููุจูุนุงุช,
            'ุงููุชุจูู': ุงููุชุจูู
        })

    return render(request, 'ุงูููุงุฒูุฉ.html', {'ุงููุชุงุฆุฌ': ุงููุชุงุฆุฌ})

<!DOCTYPE html>
<html lang="ar">
<head>
    <meta charset="UTF-8">
    <title>ููุงุฒูุฉ ุงูููุชุฌุงุช</title>
    <style>
        body { font-family: Arial; direction: rtl; }
        table { width: 80%; margin: auto; border-collapse: collapse; }
        th, td { padding: 10px; border: 1px solid #444; text-align: center; }
        th { background-color: #f0f0f0; }
    </style>
</head>
<body>
    <h2 style="text-align:center;">๐ ุฌุฏูู ููุงุฒูุฉ ุงูููุชุฌุงุช</h2>
    <table>
        <tr>
            <th>ุงุณู ุงูููุชุฌ</th>
            <th>ุงููุฎุฒูู</th>
            <th>ุฅุฌูุงูู ุงููุจูุนุงุช</th>
            <th>ุงููุชุจูู</th>
        </tr>
        {% for ุตู in ุงููุชุงุฆุฌ %}
        <tr>
            <td>{{ ุตู.ุงูููุชุฌ }}</td>
            <td>{{ ุตู.ุงููุฎุฒูู }}</td>
            <td>{{ ุตู.ุงููุจูุนุงุช }}</td>
            <td>{{ ุตู.ุงููุชุจูู }}</td>
        </tr>
        {% endfor %}
    </table>
</body>
</html>

from django import forms
from .models import ุนูููุฉ_ุจูุน

class ูููุฐุฌ_ุนูููุฉ_ุจูุน(forms.ModelForm):
    class Meta:
        model = ุนูููุฉ_ุจูุน
        fields = ['ุงูููุชุฌ', 'ุงููููุฉ']
        labels = {
            'ุงูููุชุฌ': 'ุงูููุชุฌ',
            'ุงููููุฉ': 'ุงููููุฉ ุงููุจุงุนุฉ'
        }

<!DOCTYPE html>
<html lang="ar">
<head>
    <meta charset="UTF-8">
    <title>ุชุณุฌูู ุนูููุฉ ุจูุน ุฌุฏูุฏุฉ</title>
    <style>
        body { font-family: Arial; direction: rtl; text-align: center; margin-top: 50px; }
        form { width: 300px; margin: auto; }
        input, select { width: 100%; padding: 10px; margin-bottom: 15px; }
        button { padding: 10px 20px; background-color: green; color: white; border: none; }
    </style>
</head>
<body>
    <h2>๐๏ธ ุชุณุฌูู ุนูููุฉ ุจูุน ุฌุฏูุฏุฉ</h2>
    <form method="POST">
        {% csrf_token %}
        {{ form.as_p }}
        <button type="submit">ุชุณุฌูู</button>
    </form>
</body>
</html>

from .forms import ูููุฐุฌ_ุนูููุฉ_ุจูุน

def ุจูุน_ุฌุฏูุฏ(request):
    if request.method == 'POST':
        form = ูููุฐุฌ_ุนูููุฉ_ุจูุน(request.POST)
        if form.is_valid():
            form.save()
            return redirect('ุนุฑุถ_ุงูููุงุฒูุฉ')
    else:
        form = ูููุฐุฌ_ุนูููุฉ_ุจูุน()

    return render(request, 'ุจูุน_ุฌุฏูุฏ.html', {'form': form})

from django.urls import path
from . import views

urlpatterns = [
    path('ุจูุน_ุฌุฏูุฏ/', views.ุจูุน_ุฌุฏูุฏ, name='ุจูุน_ุฌุฏูุฏ'),
    path('ุงูููุงุฒูุฉ/', views.ุนุฑุถ_ุงูููุงุฒูุฉ, name='ุนุฑุถ_ุงูููุงุฒูุฉ'),
]

from .models import ููุชุฌ, ุนูููุฉุจูุน

def ุงุญุณุจ_ุงูููุงุฒูุฉ():
    ุงููุชุงุฆุฌ = []
    ุงูููุชุฌุงุช = ููุชุฌ.objects.all()

    for ุงูููุชุฌ in ุงูููุชุฌุงุช:
        ุงููุจุงุน = ุนูููุฉุจูุน.objects.filter(ุงูููุชุฌ=ุงูููุชุฌ).aggregate(Sum('ุงููููุฉ'))['ุงููููุฉ__sum'] or 0
        ุงููุชุจูู = ุงูููุชุฌ.ุงููููุฉ_ูู_ุงููุฎุฒู - ุงููุจุงุน

        ุงููุชุงุฆุฌ.append({
            'ุงูููุชุฌ': ุงูููุชุฌ.ุงูุงุณู,
            'ุงููุฎุฒูู': ุงูููุชุฌ.ุงููููุฉ_ูู_ุงููุฎุฒู,
            'ุงููุจูุนุงุช': ุงููุจุงุน,
            'ุงููุชุจูู': ุงููุชุจูู
        })

    return ุงููุชุงุฆุฌ
