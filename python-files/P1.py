import tkinter as tk
from tkinter import messagebox
from openpyxl import Workbook
import os

fields = [
    "FOL Ref", "Client Name", "P.O. Box", "Emirate", "Single/Entity",
    "Facility", "Amount", "Tenor", "Repayment", "Margin", "Purpose",
    "Security", "Specific Terms", "Clientâ€™s Covenants"
]

class ConditionApp:
    def __init__(self, root):
        self.root = root
        self.root.title("Facility Offer Letter Entry")
        
        self.entries = {}
        
        for i, field in enumerate(fields):
            label = tk.Label(root, text=field)
            label.grid(row=i, column=0, sticky=tk.W, padx=5, pady=3)
            entry = tk.Entry(root, width=50)
            entry.grid(row=i, column=1, padx=5, pady=3)
            self.entries[field] = entry

        # Condition checkbox
        self.condition_var = tk.BooleanVar()
        tk.Checkbutton(root, text="Condition Present", variable=self.condition_var).grid(row=len(fields), column=1, sticky=tk.W, padx=5, pady=3)

        # Save button
        tk.Button(root, text="Save to Excel", command=self.save_to_excel).grid(row=len(fields)+1, column=1, pady=10)

    def save_to_excel(self):
        data = {field: entry.get() for field, entry in self.entries.items()}
        data["Condition Present"] = "Yes" if self.condition_var.get() else "No"
        
        file_path = "FOL_Data.xlsx"
        file_exists = os.path.exists(file_path)
        
        if not file_exists:
            wb = Workbook()
            ws = wb.active
            ws.append(list(data.keys()))
        else:
            wb = Workbook()
            wb = Workbook()
            wb = Workbook()
            wb = Workbook()
            wb = Workbook()
            wb = Workbook()
            wb = Workbook()
            wb = Workbook()
            wb = Workbook()
            wb = Workbook()
            wb = Workbook()
            wb = Workbook()
            wb = Workbook()
            wb = Workbook()
            wb = Workbook()
            wb = Workbook()
            wb = Workbook()
            wb = Workbook()
            wb = Workbook()
            wb = Workbook()
            wb = Workbook()
            wb = Workbook()
            wb = Workbook()
            wb = Workbook()
            wb = Workbook()
            wb = Workbook()
            wb = Workbook()
            wb = Workbook()
            wb = Workbook()
            wb = Workbook()
            wb = Workbook()
            wb = Workbook()
            wb = Workbook()
            wb = Workbook()
            wb = Workbook()
            wb = Workbook()
            wb = Workbook()
            wb = Workbook()
            wb = Workbook()
            wb = Workbook()
            wb = Workbook()
            wb = Workbook()
            wb = Workbook()
            wb = Workbook()
            wb = Workbook()
            wb = Workbook()
            wb = Workbook()
            wb = Workbook()
            wb = Workbook()
            wb = Workbook()
            wb = Workbook()
            wb = Workbook()
            wb = Workbook()
            wb = Workbook()
            wb = Workbook()
            wb = Workbook()
            wb = Workbook()
            wb = Workbook()
            wb = Workbook()
            wb = Workbook()
            wb = Workbook()
            wb = Workbook()
            wb = Workbook()
            wb = Workbook()
            wb = Workbook()
            wb = Workbook()
            wb = Workbook()
            wb = Workbook()
            wb = Workbook()
            wb = Workbook()
            wb = Workbook()
            wb = Workbook()
            wb = Workbook()
            wb = Workbook()
            wb = Workbook()
            wb = Workbook()
            wb = Workbook()
            wb = Workbook()
            wb = Workbook()
            wb = Workbook()
            wb = Workbook()
            wb = Workbook()
            wb = Workbook()
            wb = Workbook()
            wb = Workbook()
            wb = Workbook()
            wb = Workbook()
            wb = Workbook()
            wb = Workbook()
            wb = Workbook()
            wb = Workbook()
            wb = Workbook()
            wb = Workbook()
            wb = Workbook()
            wb = Workbook()
            wb = Workbook()
            wb = Workbook()
            wb = Workbook()
            wb = Workbook()
            wb = Workbook()
            wb = Workbook()
            wb = Workbook()
            wb = Workbook()
            wb = Workbook()
            wb = Workbook()
            wb = Workbook()
            wb = Workbook()
            wb = Workbook()
            wb = Workbook()
            wb = Workbook()
            wb = Workbook()
            wb = Workbook()
            wb = Workbook()
            wb = Workbook()
            wb = Workbook()
            wb = Workbook()
            wb = Workbook()
            wb = Workbook()
            wb = Workbook()
            wb = Workbook()
            wb = Workbook()
            wb = Workbook()
            wb = Workbook()
            wb = Workbook()
            wb = Workbook()
            wb = Workbook()
            wb = Workbook()
            wb = Workbook()
            wb = Workbook()
            wb = Workbook()
            wb = Workbook()
            wb = Workbook()
            wb = Workbook()
            wb = Workbook()
            wb = Workbook()
            wb = Workbook()
            wb = Workbook()
            wb = Workbook()
            wb = Workbook()
            wb = Workbook()
            wb = Workbook()
            wb = Workbook()
            wb = Workbook()
            wb = Workbook()
            wb = Workbook()
            wb = Workbook()
            wb = Workbook()
            wb = Workbook()
            wb = Workbook()
            wb = Workbook()
            wb = Workbook()
            wb = Workbook()
            wb = Workbook()
            wb = Workbook()
            wb = Workbook()
            wb = Workbook()
            wb = Workbook()
            wb = Workbook()
            wb = Workbook()
            wb = Workbook()
            wb = Workbook()
            wb = Workbook()
            wb = Workbook()
            wb = Workbook()
            wb = Workbook()
            wb = Workbook()
            wb = Workbook()
            wb = Workbook()
            wb = Workbook()
            wb = Workbook()
            wb = Workbook()
            wb = Workbook()
            wb = Workbook()
            wb = Workbook()
            wb = Workbook()
            wb = Workbook()
            wb = Workbook()
            wb = Workbook()
            wb = Workbook()
            wb = Workbook()
            wb = Workbook()
            wb = Workbook()
            wb = Workbook()
            wb = Workbook()
            wb = Workbook()
            wb = Workbook()
            wb = Workbook()
            wb = Workbook()
            wb = Workbook()
            wb = Workbook()
            wb = Workbook()
            wb = Workbook()
            wb = Workbook()
            wb = Workbook()
            wb = Workbook()
            wb = Workbook()
            wb = Workbook()
            wb = Workbook()
            wb = Workbook()
            wb = Workbook()
            wb = Workbook()
            wb = Workbook()
            wb = Workbook()
            wb = Workbook()
            wb = Workbook()
            wb = Workbook()
            wb = Workbook()
            wb = Workbook()
            wb = Workbook()
            wb = Workbook()
            wb = Workbook()
            wb = Workbook()
            wb = Workbook()
            wb = Workbook()
            wb = Workbook()
            wb = Workbook()
            wb = Workbook()
            wb = Workbook()
            wb = Workbook()
            wb = Workbook()
            wb = Workbook()
            wb = Workbook()
            wb = Workbook()
            wb = Workbook()
            wb = Workbook()
            wb = Workbook()
            wb = Workbook()
            wb = Workbook()
            wb = Workbook()
            wb = Workbook()
            wb = Workbook()
            wb = Workbook()
            wb = Workbook()
            wb = Workbook()
            wb = Workbook()
            wb = Workbook()
            wb = Workbook()
            wb = Workbook()
            wb = Workbook()
            wb = Workbook()
            wb = Workbook()
            wb = Workbook()
            wb = Workbook()
            wb = Workbook()
            wb = Workbook()
            wb = Workbook()
            wb = Workbook()
            wb = Workbook()
            wb = Workbook()
            wb = Workbook()
            wb = Workbook()
            wb = Workbook()
            wb = Workbook()
            wb = Workbook()
            wb = Workbook()
            wb = Workbook()
            wb = Workbook()
            wb = Workbook()
            wb = Workbook()
            wb = Workbook()
            wb = Workbook()
            wb = Workbook()
            wb = Workbook()
            wb = Workbook()
            wb = Workbook()
            wb = Workbook()
            wb = Workbook()
            wb = Workbook()
            wb = Workbook()
            wb = Workbook()
            wb = Workbook()
            wb = Workbook()
            wb = Workbook()
            wb = Workbook()
            wb = Workbook()
            wb = Workbook()
            wb = Workbook()
            wb = Workbook()
            wb = Workbook()
            wb = Workbook()
            wb = Workbook()
            wb = Workbook()
            wb = Workbook()
            wb = Workbook()
            wb = Workbook()
            wb = Workbook()
            wb = Workbook()
            wb = Workbook()
            wb = Workbook()
            wb = Workbook()
            wb = Workbook()
            wb = Workbook()
            wb = Workbook()
            wb = Workbook()
            wb = Workbook()
            wb = Workbook()
            wb = Workbook()
            wb = Workbook()
            wb = Workbook()
            wb = Workbook()
            wb = Workbook()
            wb = Workbook()
            wb = Workbook()
            wb = Workbook()
            wb = Workbook()
            wb = Workbook()
            wb = Workbook()
            wb = Workbook()
            wb = Workbook()
            wb = Workbook()
            wb = Workbook()
            wb = Workbook()
            wb = Workbook()
            wb = Workbook()
            wb = Workbook()
            wb = Workbook()
            wb = Workbook()
            wb = Workbook()
            wb = Workbook()
            wb = Workbook()
            wb = Workbook()
            wb = Workbook()
            wb = Workbook()
            wb = Workbook()
            wb = Workbook()
            wb = Workbook()
            wb = Workbook()
            wb = Workbook()
            wb = Workbook()
            wb = Workbook()
            wb = Workbook()
            wb = Workbook()
            wb = Workbook()
            wb = Workbook()
            wb = Workbook()
            wb = Workbook()
            wb = Workbook()
            wb = Workbook()
            wb = Workbook()
            wb = Workbook()
            wb = Workbook()
            wb = Workbook()
            wb = Workbook()
            wb = Workbook()
            wb = Workbook()
            wb = Workbook()
            wb = Workbook()
            wb = Workbook()
            wb = Workbook()
            wb = Workbook()
            wb = Workbook()
            wb = Workbook()
            wb = Workbook()
            wb = Workbook()
            wb = Workbook()
            wb = Workbook()
            wb = Workbook()
            wb = Workbook()
            wb = Workbook()
            wb = Workbook()
            wb = Workbook()
            wb = Workbook()
            wb = Workbook()
            wb = Workbook()
            wb = Workbook()
            wb = Workbook()
            wb = Workbook()
            wb = Workbook()
            wb = Workbook()
            wb = Workbook()
            wb = Workbook()
            wb = Workbook()
            wb = Workbook()
            wb = Workbook()
            wb = Workbook()
            wb = Workbook()
            wb = Workbook()
            wb = Workbook()
            wb = Workbook()
            wb = Workbook()
            wb = Workbook()
            wb = Workbook()
            wb = Workbook()
            wb = Workbook()
            wb = Workbook()
            wb = Workbook()
            wb = Workbook()
            wb = Workbook()
            wb = Workbook()
            wb = Workbook()
            wb = Workbook()
            wb = Workbook()
            wb = Workbook()
            wb = Workbook()
            wb = Workbook()
            wb = Workbook()
            wb = Workbook()
            wb = Workbook()
            wb = Workbook()
            wb = Workbook()
            wb = Workbook()
            wb = Workbook()
            wb = Workbook()
            wb = Workbook()
            wb = Workbook()
            wb = Workbook()
            wb = Workbook()
            wb = Workbook()
            wb = Workbook()
            wb = Workbook()
            wb = Workbook()
            wb = Workbook()
            wb = Workbook()
            wb = Workbook()
            wb = Workbook()
            wb = Workbook()
            wb = Workbook()
            wb = Workbook()
            wb = Workbook()
            wb = Workbook()
            wb = Workbook()
            wb = Workbook()
            wb = Workbook()
            wb = Workbook()
            wb = Workbook()
            wb = Workbook()
            wb = Workbook()
            wb = Workbook()
            wb = Workbook()
            wb = Workbook()
            wb = Workbook()
            wb = Workbook()
            wb = Workbook()
            wb = Workbook()
            wb = Workbook()
            wb = Workbook()
            wb = Workbook()
            wb = Workbook()
            wb = Workbook()
            wb = Workbook()
            wb = Workbook()
            wb = Workbook()
            wb = Workbook()
            wb = Workbook()
            wb = Workbook()
            wb = Workbook()
            wb = Workbook()
            wb = Workbook()
            wb = Workbook()
            wb = Workbook()
            wb = Workbook()
            wb = Workbook()
            wb = Workbook()
            wb = Workbook()
            wb = Workbook()
            wb = Workbook()
            wb = Workbook()
            wb = Workbook()
            wb = Workbook()
            wb = Workbook()
            wb = Workbook()
            wb = Workbook()
            wb = Workbook()
            wb = Workbook()
            wb = Workbook()
            wb = Workbook()
            wb = Workbook()
            wb = Workbook()
            wb = Workbook()
            wb = Workbook()
            wb = Workbook()
            wb = Workbook()
            wb = Workbook()
            wb = Workbook()
            wb = Workbook()
            wb = Workbook()
            wb = Workbook()
            wb = Workbook()
            wb = Workbook()
            wb = Workbook()
            wb = Workbook()
            wb = Workbook()
            wb = Workbook()
            wb = Workbook()
            wb = Workbook()
            wb = Workbook()
            wb = Workbook()
            wb = Workbook()
            wb = Workbook()
            wb = Workbook()
            wb = Workbook()
            wb = Workbook()
            wb = Workbook()
            wb = Workbook()
            wb = Workbook()
            wb = Workbook()
            wb = Workbook()
            wb = Workbook()
            wb = Workbook()
            wb = Workbook()
            wb = Workbook()
            wb = Workbook()
            wb = Workbook()
            wb = Workbook()
            wb = Workbook()
            wb = Workbook()
            wb = Workbook()
            wb = Workbook()
            wb = Workbook()
            wb = Workbook()
            wb = Workbook()
            wb = Workbook()
            wb = Workbook()
            wb = Workbook()
            wb = Workbook()
            wb = Workbook()
            wb = Workbook()
            wb = Workbook()
            wb = Workbook()
            wb = Workbook()
            wb = Workbook()
            wb = Workbook()
            wb = Workbook()
            wb = Workbook()
            wb = Workbook()
            wb = Workbook()
            wb = Workbook()
            wb = Workbook()
            wb = Workbook()
            wb = Workbook()
            wb = Workbook()
            wb = Workbook()
            wb = Workbook()
            wb = Workbook()
            wb = Workbook()
            wb = Workbook()
            wb = Workbook()
            wb = Workbook()
            wb = Workbook()
            wb = Workbook()
            wb = Workbook()
            wb = Workbook()
            wb = Workbook()
            wb = Workbook()
            wb = Workbook()
            wb = Workbook()
            wb = Workbook()
            wb = Workbook()
            wb = Workbook()
            wb = Workbook()
            wb = Workbook()
            wb = Workbook()
            wb = Workbook()
            wb = Workbook()
            wb = Workbook()
            wb = Workbook()
            wb = Workbook()
            wb = Workbook()
            wb = Workbook()
            wb = Workbook()
            wb = Workbook()
            wb = Workbook()
            wb = Workbook()
            wb = Workbook()
            wb = Workbook()
            wb = Workbook()
            wb = Workbook()
            wb = Workbook()
            wb = Workbook()
            wb = Workbook()
            wb = Workbook()
            wb = Workbook()
            wb = Workbook()
            wb = Workbook()
            wb = Workbook()
            wb = Workbook()
            wb = Workbook()
            wb = Workbook()
            wb = Workbook()
            wb = Workbook()
            wb = Workbook()
            wb = Workbook()
            wb = Workbook()
            wb = Workbook()
            wb = Workbook()
            wb = Workbook()
            wb = Workbook()
            wb = Workbook()
            wb = Workbook()
            wb = Workbook()
            wb = Workbook()
            wb = Workbook()
            wb = Workbook()
            wb = Workbook()
            wb = Workbook()
            wb = Workbook()
            wb = Workbook()
            wb = Workbook()
            wb = Workbook()
            wb = Workbook()
            wb = Workbook()
            wb = Workbook()
            wb = Workbook()
            wb = Workbook()
            wb = Workbook()
            wb = Workbook()
            wb = Workbook()
            wb = Workbook()
            wb = Workbook()
            wb = Workbook()
            wb = Workbook()
            wb = Workbook()
            wb = Workbook()
            wb = Workbook()
            wb = Workbook()
            wb = Workbook()
            wb = Workbook()
            wb = Workbook()
            wb = Workbook()
            wb = Workbook()
            wb = Workbook()
            wb = Workbook()
            wb = Workbook()
            wb = Workbook()
            wb = Workbook()
            wb = Workbook()
            wb = Workbook()
            wb = Workbook()
            wb = Workbook()
            wb = Workbook()
            wb = Workbook()
            wb = Workbook()
            wb = Workbook()
            wb = Workbook()
            wb = Workbook()
            wb = Workbook()
            wb = Workbook()
            wb = Workbook()
            wb = Workbook()
            wb = Workbook()
            wb = Workbook()
            wb = Workbook()
            wb = Workbook()
            wb = Workbook()
            wb = Workbook()
            wb = Workbook()
            wb = Workbook()
            wb = Workbook()
            wb = Workbook()
            wb = Workbook()
            wb = Workbook()
            wb = Workbook()
            wb = Workbook()
            wb = Workbook()
            wb = Workbook()
            wb = Workbook()
            wb = Workbook()
            wb = Workbook()
            wb = Workbook()
            wb = Workbook()
            wb = Workbook()
            wb = Workbook()
            wb = Workbook()
            wb = Workbook()
            wb = Workbook()
            wb = Workbook()
            wb = Workbook()
            wb = Workbook()
            wb = Workbook()
            wb = Workbook()
            wb = Workbook()
            wb = Workbook()
            wb = Workbook()
            wb = Workbook()
            wb = Workbook()
            wb = Workbook()
            wb = Workbook()
            wb = Workbook()
            wb = Workbook()
            wb = Workbook()
            wb = Workbook()
            wb = Workbook()
            wb = Workbook()
            wb = Workbook()
            wb = Workbook()
            wb = Workbook()
            wb = Workbook()
            wb = Workbook()
            wb = Workbook()
            wb = Workbook()
            wb = Workbook()
            wb = Workbook()
            wb = Workbook()
            wb = Workbook()
            wb = Workbook()
            wb = Workbook()
            wb = Workbook()
            wb = Workbook()
            wb = Workbook()
            wb = Workbook()
            wb = Workbook()
            wb = Workbook()
            wb = Workbook()
            wb = Workbook()
            wb = Workbook()
            wb = Workbook()
            wb = Workbook()
            wb = Workbook()
            wb = Workbook()
            wb = Workbook()
            wb = Workbook()
            wb = Workbook()
            wb = Workbook()
            wb = Workbook()
            wb = Workbook()
            wb = Workbook()
            wb = Workbook()
            wb = Workbook()
            wb = Workbook()
            wb = Workbook()
            wb = Workbook()
            wb = Workbook()
            wb = Workbook()
            wb = Workbook()
            wb = Workbook
