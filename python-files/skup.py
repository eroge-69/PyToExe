# -*- coding: utf-8 -*-
"""Kopia notatnika Untitled2.ipynb

Automatically generated by Colab.

Original file is located at
    https://colab.research.google.com/drive/11Za3eci40Vg44ubLB6wSKWS5fhHPHtA1
"""

import json
import os
import datetime
import platform

class Magazyn:
    """Klasa do zarzƒÖdzania stanem magazynowym towaru i kasy."""
    def __init__(self, nazwa_towaru="Towar", poczatkowy_stan_kasy=0, proba=1000):
        self.nazwa_towaru = nazwa_towaru
        self.proba = proba # Pr√≥ba towaru (np. 585, 999.9)
        self.stan_magazynu_g = 0  # Stan w gramach
        self.stan_kasy_pln = poczatkowy_stan_kasy # Stan w PLN
        self.historia_transakcji = []
        self.historia_usunietych_transakcji = [] # Nowa lista na usuniƒôte transakcje
        self.suma_kosztow_zakupu = 0 # Dodano pole do sumowania koszt√≥w zakupu
        self.suma_ilosci_zakupu = 0 # Dodano pole do sumowania ilo≈õci zakupu
        self.suma_przychodow_sprzedazy = 0 # Dodano pole do sumowania przychod√≥w ze sprzeda≈ºy
        self.suma_ilosci_sprzedazy = 0 # Dodano pole do sumowania ilo≈õci sprzeda≈ºy
        self.plik_konfiguracji = "magazyn_config.json" # Nazwa pliku konfiguracyjnego
        self.plik_kopii_zapasowej = self.wczytaj_sciezke_kopii_zapasowej() # Wczytanie ≈õcie≈ºki z pliku konfiguracyjnego


    def przelicz_na_999(self, ilosc_g):
        """Przelicza ilo≈õƒá towaru o danej pr√≥bie na ekwiwalent 999.9."""
        if self.proba == 0: # Unikniƒôcie dzielenia przez zero
            return 0
        return ilosc_g * (self.proba / 999.9)

    def oblicz_srednia_cene_zakupu(self):
        """Oblicza ≈õredniƒÖ cenƒô zakupu za gram towaru."""
        if self.suma_ilosci_zakupu == 0:
            return 0
        return self.suma_kosztow_zakupu / self.suma_ilosci_zakupu

    def oblicz_srednia_cene_sprzedazy(self):
        """Oblicza ≈õredniƒÖ cenƒô sprzeda≈ºy za gram towaru."""
        if self.suma_ilosci_sprzedazy == 0:
            return 0
        return self.suma_przychodow_sprzedazy / self.suma_ilosci_sprzedazy


    def gramy_na_uncje(self, ilosc_g):
        """Przelicza gramy na uncje troja≈Ñskie."""
        return ilosc_g / 31.1035

    def uncje_na_gramy(ilosc_oz):
        """Przelicza uncje troja≈Ñskie na gramy."""
        return ilosc_oz * 31.1035

    def oblicz_wartosc_magazynu_rynkowa(self, cena_rynkowa_za_gram_999):
        """Oblicza rynkowƒÖ warto≈õƒá ca≈Çego magazynu w oparciu o podanƒÖ cenƒô za gram 999.9."""
        ekwiwalent_999 = self.przelicz_na_999(self.stan_magazynu_g)
        wartosc_rynkowa = ekwiwalent_999 * cena_rynkowa_za_gram_999
        return wartosc_rynkowa


    def skup(self, ilosc_g, cena_calkowita):
        """Rejestruje zakup (skup) towaru, dodaje go do magazynu i odejmuje koszt z kasy."""
        self.stan_magazynu_g += ilosc_g
        self.stan_kasy_pln -= cena_calkowita # Odejmujemy koszt z kasy
        self.suma_kosztow_zakupu += cena_calkowita # Dodaj koszt do sumy
        self.suma_ilosci_zakupu += ilosc_g # Dodaj ilo≈õƒá do sumy

        transakcja = {
            "typ": "SKUP",
            "ilosc_g": ilosc_g,
            "cena_calkowita": cena_calkowita,
            "stan_towaru_po": self.stan_magazynu_g,
            "stan_kasy_po": self.stan_kasy_pln, # Zapisujemy stan kasy po transakcji
            "czas": datetime.datetime.now().isoformat() # Zapisujemy czas w formacie ISO 8601
        }
        self.historia_transakcji.append(transakcja)

        ekwiwalent_999 = self.przelicz_na_999(self.stan_magazynu_g) # Przeliczenie po transakcji

        print(f"\n‚úÖ SKUP ZAREJESTROWANY:")
        print(f"   Dodano: {ilosc_g:.2f}g {self.nazwa_towaru}")
        print(f"   Ca≈Çkowity koszt: {cena_calkowita:.2f} PLN")
        print(f"   Nowy stan magazynu: {self.stan_magazynu_g:.2f}g")
        print(f"   Ekwiwalent 999.9: {ekwiwalent_999:.2f}g") # Wy≈õwietlenie ekwiwalentu
        print(f"   Nowy stan kasy: {self.stan_kasy_pln:.2f} PLN\n")


    def sprzedaz(self, ilosc_g, cena_calkowita):
        """Rejestruje sprzeda≈º towaru, odejmuje go z magazynu i dodaje przych√≥d do kasy."""
        przych√≥d = cena_calkowita
        self.stan_magazynu_g -= ilosc_g
        self.stan_kasy_pln += przych√≥d # Dodajemy przych√≥d do kasy
        self.suma_przychodow_sprzedazy += przych√≥d # Dodaj przych√≥d do sumy
        self.suma_ilosci_sprzedazy += ilosc_g # Dodaj ilo≈õƒá do sumy
        # Nie odejmujemy od sum koszt√≥w/ilo≈õci zakupu przy sprzeda≈ºy, bo ≈õrednia dotyczy zakupu

        transakcja = {
            "typ": "SPRZEDA≈ª",
            "ilosc_g": ilosc_g,
            "cena_calkowita": cena_calkowita,
            "przych√≥d_calkowity": przych√≥d,
            "stan_towaru_po": self.stan_magazynu_g,
            "stan_kasy_po": self.stan_kasy_pln, # Zapisujemy stan kasy po transakcji
            "czas": datetime.datetime.now().isoformat() # Zapisujemy czas w formacie ISO 8601
        }
        self.historia_transakcji.append(transakcja)

        ekwiwalent_999 = self.przelicz_na_999(self.stan_magazynu_g) # Przeliczenie po transakcji

        print(f"\n‚úÖ SPRZEDA≈ª ZAREJESTROWANA:")
        print(f"   Sprzedano: {ilosc_g:.2f}g {self.nazwa_towaru}")
        print(f"   Ca≈Çkowity przych√≥d: {przych√≥d:.2f} PLN")
        print(f"   Nowy stan magazynu: {self.stan_magazynu_g:.2f}g")
        print(f"   Ekwiwalent 999.9: {ekwiwalent_999:.2f}g") # Wy≈õwietlenie ekwiwalentu
        print(f"   Nowy stan kasy: {self.stan_kasy_pln:.2f} PLN\n")

    def pokaz_stan(self):
        """Wy≈õwietla aktualny stan magazynu i kasy."""
        ekwiwalent_999 = self.przelicz_na_999(self.stan_magazynu_g) # Przeliczenie ekwiwalentu
        srednia_cena = self.oblicz_srednia_cene_zakupu() # Obliczenie ≈õredniej ceny
        ekwiwalent_999_oz = self.gramy_na_uncje(ekwiwalent_999) # Przeliczenie ekwiwalentu na uncje

        print("="*40)
        print(f"STAN MAGAZYNU I KASY DLA: {self.nazwa_towaru.upper()} (Pr√≥ba: {self.proba})") # Dodano informacjƒô o pr√≥bie
        print("="*40)
        print(f"Aktualny stan towaru: {self.stan_magazynu_g:.2f} gram√≥w")
        print(f"Ekwiwalent 999.9: {ekwiwalent_999:.2f}g ({ekwiwalent_999_oz:.2f} oz)") # Wy≈õwietlenie ekwiwalentu w stanie
        print(f"≈örednia cena zakupu (za gram {self.proba}): {srednia_cena:.2f} PLN/g") # Wy≈õwietlenie ≈õredniej ceny
        print(f"Aktualny stan kasy: {self.stan_kasy_pln:.2f} PLN")
        print("="*40)

    def pokaz_historie(self):
        """Wy≈õwietla historiƒô transakcji z uwzglƒôdnieniem stanu kasy."""
        print("\n" + "="*80) # Zwiƒôkszona szeroko≈õƒá linii
        print(f"HISTORIA TRANSAKCJI DLA: {self.nazwa_towaru.upper()} (Pr√≥ba: {self.proba})") # Dodano informacjƒô o pr√≥bie
        print("="*80)

        if not self.historia_transakcji and not self.historia_usunietych_transakcji:
            print("Brak zarejestrowanych transakcji.")
            return

        # Wy≈õwietlanie aktualnych transakcji
        print("\n--- AKTUALNE TRANSAKCJE ---")
        if not self.historia_transakcji:
            print("Brak aktualnych transakcji.")
        else:
            for i, transakcja in enumerate(self.historia_transakcji):
                typ = transakcja['typ']
                ilosc = transakcja['ilosc_g']
                stan_towaru_po = transakcja['stan_towaru_po']
                stan_kasy_po = transakcja['stan_kasy_po'] # Pobieramy stan kasy po transakcji
                ekwiwalent_999_po = self.przelicz_na_999(stan_towaru_po) # Przeliczenie ekwiwalentu dla stanu po transakcji
                czas = datetime.datetime.fromisoformat(transakcja['czas']).strftime("%Y-%m-%d %H:%M:%S") # Formatowanie daty i godziny

                if typ == "SKUP":
                    cena = transakcja['cena_calkowita']
                    print(f"{i+1}. {czas} | SKUP: +{ilosc:.2f}g | Koszt: {cena:.2f} PLN | Stan towaru po: {stan_towaru_po:.2f}g ({ekwiwalent_999_po:.2f}g 999.9) | Stan kasy po: {stan_kasy_po:.2f} PLN") # Zmodyfikowany komunikat i dodano ekwiwalent
                else: # SPRZEDA≈ª
                    przych√≥d = transakcja['przych√≥d_calkowity']
                    print(f"{i+1}. {czas} | SPRZEDA≈ª: -{ilosc:.2f}g | Przych√≥d: {przych√≥d:.2f} PLN | Stan towaru po: {stan_towaru_po:.2f}g ({ekwiwalent_999_po:.2f}g 999.9) | Stan kasy po: {stan_kasy_po:.2f} PLN") # Zmodyfikowany komunikat i dodano ekwiwalent

        # Wy≈õwietlanie usuniƒôtych transakcji
        print("\n--- USUNIƒòTE TRANSAKCJE ---")
        if not self.historia_usunietych_transakcji:
            print("Brak usuniƒôtych transakcji.")
        else:
            for i, transakcja in enumerate(self.historia_usunietych_transakcji):
                typ = transakcja['typ']
                ilosc = transakcja['ilosc_g']
                stan_towaru_po = transakcja['stan_towaru_po']
                stan_kasy_po = transakcja['stan_kasy_po']
                ekwiwalent_999_po = self.przelicz_na_999(stan_towaru_po)
                czas = datetime.datetime.fromisoformat(transakcja['czas']).strftime("%Y-%m-%d %H:%M:%S")

                if typ == "SKUP":
                    cena = transakcja['cena_calkowita']
                    print(f"{i+1}. {czas} | SKUP (usuniƒôta): +{ilosc:.2f}g | Koszt: {cena:.2f} PLN | Stan towaru po: {stan_towaru_po:.2f}g ({ekwiwalent_999_po:.2f}g 999.9) | Stan kasy po: {stan_kasy_po:.2f} PLN")
                else: # SPRZEDA≈ª
                    przych√≥d = transakcja['przych√≥d_calkowity']
                    print(f"{i+1}. {czas} | SPRZEDA≈ª (usuniƒôta): -{ilosc:.2f}g | Przych√≥d: {przych√≥d:.2f} PLN | Stan towaru po: {stan_towaru_po:.2f}g ({ekwiwalent_999_po:.2f}g 999.9) | Stan kasy po: {stan_kasy_po:.2f} PLN")

        print("="*80)


    def usun_ostatnia_transakcje(self):
        """Usuwa ostatniƒÖ transakcjƒô z historii, przywraca stan magazynu i kasy, oraz przenosi transakcjƒô do listy usuniƒôtych."""
        if not self.historia_transakcji:
            print("\n‚ùå B≈ÇƒÖd: Brak transakcji do usuniƒôcia.")
            return

        ostatnia_transakcja = self.historia_transakcji.pop()
        self.historia_usunietych_transakcji.append(ostatnia_transakcja) # Przenosimy usuniƒôtƒÖ transakcjƒô

        # Przywracanie stanu magazynu i kasy do stanu sprzed ostatniej transakcji
        if self.historia_transakcji:
            poprzednia_transakcja = self.historia_transakcji[-1]
            self.stan_magazynu_g = poprzednia_transakcja['stan_towaru_po']
            self.stan_kasy_pln = poprzednia_transakcja['stan_kasy_po']
        else:
            # Je≈õli po usuniƒôciu nie ma wiƒôcej transakcji, resetujemy stan
            self.stan_magazynu_g = 0
            self.stan_kasy_pln = 0 # Zak≈Çadamy, ≈ºe kasa wraca do stanu poczƒÖtkowego, ale mo≈ºna to zmodyfikowaƒá je≈õli potrzeba

        # Po usuniƒôciu transakcji SKUP, musimy przeliczyƒá sumy koszt√≥w i ilo≈õci zakupu
        self.suma_kosztow_zakupu = sum(t['cena_calkowita'] for t in self.historia_transakcji if t['typ'] == 'SKUP')
        self.suma_ilosci_zakupu = sum(t['ilosc_g'] for t in self.historia_transakcji if t['typ'] == 'SKUP')
        self.suma_przychodow_sprzedazy = sum(t.get('przych√≥d_calkowity', 0) for t in self.historia_transakcji if t['typ'] == 'SPRZEDA≈ª') # U≈ºywamy get z warto≈õciƒÖ domy≈õlnƒÖ 0
        self.suma_ilosci_sprzedazy = sum(t['ilosc_g'] for t in self.historia_transakcji if t['typ'] == 'SPRZEDA≈ª')


        print(f"\n‚úÖ Usuniƒôto ostatniƒÖ transakcjƒô ({ostatnia_transakcja['typ']}).")
        self.pokaz_stan() # Wy≈õwietlamy nowy stan po usuniƒôciu

    def przelicz_na_probe_docelowa(self, ilosc_g, proba_wejsciowa, proba_docelowa):
        """Przelicza ilo≈õƒá towaru z pr√≥by wej≈õciowej na ekwiwalent w pr√≥bie docelowej."""
        if proba_wejsciowa == 0:
            return 0
        return ilosc_g * (proba_wejsciowa / proba_docelowa)

    def zapisz_stan(self):
        """Zapisuje aktualny stan magazynu i historiƒô transakcji do pliku JSON."""
        stan_do_zapisu = {
            "nazwa_towaru": self.nazwa_towaru,
            "proba": self.proba,
            "stan_magazynu_g": self.stan_magazynu_g,
            "stan_kasy_pln": self.stan_kasy_pln,
            "historia_transakcji": self.historia_transakcji,
            "historia_usunietych_transakcji": self.historia_usunietych_transakcji,
            "suma_kosztow_zakupu": self.suma_kosztow_zakupu,
            "suma_ilosci_zakupu": self.suma_ilosci_zakupu,
            "suma_przychodow_sprzedazy": self.suma_przychodow_sprzedazy,
            "suma_ilosci_sprzedazy": self.suma_ilosci_sprzedazy
        }
        try:
            with open(self.plik_kopii_zapasowej, 'w', encoding='utf-8') as f:
                json.dump(stan_do_zapisu, f, indent=4)
            print(f"\n‚úÖ Stan magazynu zapisano do pliku: {self.plik_kopii_zapasowej}")
        except IOError as e:
            print(f"\n‚ùå B≈ÇƒÖd podczas zapisu pliku: {e}")


    def wczytaj_stan(self):
        """Wczytuje stan magazynu i historiƒô transakcji z pliku JSON."""
        if not os.path.exists(self.plik_kopii_zapasowej):
            print(f"\n‚ùå B≈ÇƒÖd: Plik kopii zapasowej '{self.plik_kopii_zapasowej}' nie istnieje. Uruchamianie ze stanem zerowym.")
            return

        try:
            with open(self.plik_kopii_zapasowej, 'r', encoding='utf-8') as f:
                wczytany_stan = json.load(f)

            self.nazwa_towaru = wczytany_stan.get("nazwa_towaru", "Towar")
            self.proba = wczytany_stan.get("proba", 1000)
            self.stan_magazynu_g = wczytany_stan.get("stan_magazynu_g", 0)
            self.stan_kasy_pln = wczytany_stan.get("stan_kasy_pln", 0)
            self.historia_transakcji = wczytany_stan.get("historia_transakcji", [])
            self.historia_usunietych_transakcji = wczytany_stan.get("historia_usunietych_transakcji", [])
            self.suma_kosztow_zakupu = wczytany_stan.get("suma_kosztow_zakupu", 0)
            self.suma_ilosci_zakupu = wczytany_stan.get("suma_ilosci_zakupu", 0)
            self.suma_przychodow_sprzedazy = wczytany_stan.get("suma_przychodow_sprzedazy", 0) # Wczytanie pola
            self.suma_ilosci_sprzedazy = wczytany_stan.get("suma_ilosci_sprzedazy", 0) # Wczytanie pola

            # Konwersja string√≥w ISO 8601 na obiekty datetime
            for transakcja in self.historia_transakcji:
                if isinstance(transakcja.get('czas'), str):
                    try:
                        transakcja['czas'] = datetime.datetime.fromisoformat(transakcja['czas'])
                    except ValueError:
                        transakcja['czas'] = datetime.datetime.now() # Domy≈õlna warto≈õƒá w przypadku b≈Çƒôdu formatu

            for transakcja in self.historia_usunietych_transakcji:
                 if isinstance(transakcja.get('czas'), str):
                    try:
                        transakcja['czas'] = datetime.datetime.fromisoformat(transakcja['czas'])
                    except ValueError:
                        transakcja['czas'] = datetime.datetime.now() # Domy≈õlna warto≈õƒá w przypadku b≈Çƒôdu formatu


            print(f"\n‚úÖ Stan magazynu wczytano z pliku: {self.plik_kopii_zapasowej}")
            self.pokaz_stan()
        except (IOError, json.JSONDecodeError) as e:
            print(f"\n‚ùå B≈ÇƒÖd podczas wczytywania pliku: {e}")


    def zapisz_sciezke_kopii_zapasowej(self):
        """Zapisuje ≈õcie≈ºkƒô kopii zapasowej do pliku konfiguracyjnego."""
        config_data = {"plik_kopii_zapasowej": self.plik_kopii_zapasowej}
        try:
            with open(self.plik_konfiguracji, 'w', encoding='utf-8') as f:
                json.dump(config_data, f)
        except IOError as e:
            print(f"\n‚ùå B≈ÇƒÖd podczas zapisu pliku konfiguracyjnego: {e}")

    def wczytaj_sciezke_kopii_zapasowej(self):
        """Wczytuje ≈õcie≈ºkƒô kopii zapasowej z pliku konfiguracyjnego."""
        if not os.path.exists(self.plik_konfiguracji):
            return "c:\\skup\\" # Domy≈õlna ≈õcie≈ºka je≈õli plik nie istnieje

        try:
            with open(self.plik_konfiguracji, 'r', encoding='utf-8') as f:
                config_data = json.load(f)
                return config_data.get("plik_kopii_zapasowej", "c:\\skup\\")
        except (IOError, json.JSONDecodeError) as e:
            print(f"\n‚ùå B≈ÇƒÖd podczas wczytywania pliku konfiguracyjnego: {e}")
            return "c:\\skup\\" # Zwracamy domy≈õlnƒÖ ≈õcie≈ºkƒô w przypadku b≈Çƒôdu


# ----------------------------------------------------------------------
# INTERAKTYWNA PƒòTLA PROGRAMU Z FUNKCJƒÑ INPUT()
# ----------------------------------------------------------------------

def pobierz_liczbe(komunikat):
    """Pomocnicza funkcja do bezpiecznego pobierania liczb od u≈ºytkownika."""
    while True:
        try:
            wartosc_str = input(komunikat).replace(',', '.') # Zamiana przecinka na kropkƒô
            wartosc = float(wartosc_str)
            # Usuniƒôto sprawdzenie czy warto≈õƒá jest ujemna
            return wartosc
        except ValueError:
            print("To nie jest prawid≈Çowa liczba. Spr√≥buj ponownie.")

def main():
    """G≈Ç√≥wna funkcja programu z menu."""

    # Inicjalizacja magazynu - ustawiono domy≈õlny towar na "z≈Çoto 585" i jego pr√≥bƒô
    nazwa = "z≈Çoto"
    proba = 585 # Nowa pr√≥ba
    poczatkowy_stan = 0 # Mo≈ºesz ustawiƒá innƒÖ warto≈õƒá poczƒÖtkowƒÖ kasy tutaj, je≈õli potrzebujesz
    magazyn = Magazyn(nazwa, poczatkowy_stan, proba)

    # Wczytanie stanu przy starcie programu (ju≈º w __init__ klasy Magazyn)


    while True:
        ekwiwalent_999_stan = magazyn.przelicz_na_999(magazyn.stan_magazynu_g) # Obliczenie ekwiwalentu dla menu
        ekwiwalent_999_oz = magazyn.gramy_na_uncje(ekwiwalent_999_stan) # Obliczenie ekwiwalentu w uncjach dla menu
        srednia_cena_zakupu_menu = magazyn.oblicz_srednia_cene_zakupu() # Obliczenie ≈õredniej ceny dla menu
        srednia_cena_sprzedazy_menu = magazyn.oblicz_srednia_cene_sprzedazy() # Obliczenie ≈õredniej ceny sprzeda≈ºy


        print("\n" + "="*30)
        print("  SYSTEM ZARZƒÑDZANIA MAGAZYNEM")
        print("="*30)
        print(f"STAN TOWARU ({magazyn.proba}): {magazyn.stan_magazynu_g:.2f}g") # Wy≈õwietlanie stanu w oryginalnej pr√≥bie
        print(f"STAN TOWARU (999.9): {ekwiwalent_999_stan:.2f}g ({ekwiwalent_999_oz:.2f} oz)") # Wy≈õwietlanie stanu w 999.9 w gramach i uncjach
        print(f"≈öREDNIA CENA ZAKUPU ({magazyn.proba}): {srednia_cena_zakupu_menu:.2f} PLN/g") # Wy≈õwietlenie ≈õredniej ceny
        print(f"≈öREDNIA CENA SPRZEDA≈ªY ({magazyn.proba}): {srednia_cena_sprzedazy_menu:.2f} PLN/g") # Wy≈õwietlenie ≈õredniej ceny sprzeda≈ºy
        print(f"STAN KASY: {magazyn.stan_kasy_pln:.2f} PLN")
        print(f"SUMA SKUPU: {magazyn.suma_ilosci_zakupu:.2f}g za {magazyn.suma_kosztow_zakupu:.2f} PLN") # Dodano sumƒô skupu
        print(f"SUMA SPRZEDA≈ªY: {magazyn.suma_ilosci_sprzedazy:.2f}g za {magazyn.suma_przychodow_sprzedazy:.2f} PLN") # Dodano sumƒô sprzeda≈ºy
        print("="*30)
        print("1. Rejestracja skupu (zakup)")
        print("2. Rejestracja sprzeda≈ºy")
        print("3. Poka≈º historiƒô transakcji") # Zmieniona nazwa opcji
        print("4. Usu≈Ñ ostatniƒÖ transakcjƒô") # Nowa opcja
        print("5. Kalkulator skupu innej pr√≥by") # Dodano nowƒÖ opcjƒô
        print("6. Podaj cenƒô rynkowƒÖ i oblicz warto≈õƒá magazynu") # Nowa opcja
        print("8. Ustawienia") # Nowa opcja Ustawienia
        print("9. Zresetuj stany i historiƒô") # Nowa opcja resetowania
        print("0. Zako≈Ñcz program") # Zmieniono numer opcji
        print("="*30)

        wybor = input("Wybierz opcjƒô (0-6, 8-9): ") # Zmieniono zakres opcji

        if wybor == '1':
            print("\n--- REJESTRACJA SKUPU ---")
            ilosc = pobierz_liczbe(f"Podaj masƒô towaru do skupu ({magazyn.nazwa_towaru} {magazyn.proba} w g): ") # Zmieniono komunikat
            cena_calkowita = pobierz_liczbe(f"Podaj ca≈ÇkowitƒÖ cenƒô skupu ({magazyn.nazwa_towaru} {magazyn.proba} w PLN): ") # Zmieniono komunikat
            magazyn.skup(ilosc, cena_calkowita)

        elif wybor == '2':
            print("\n--- REJESTRACJA SPRZEDA≈ªY ---")
            ilosc = pobierz_liczbe(f"Podaj masƒô towaru do sprzeda≈ºy ({magazyn.nazwa_towaru} {magazyn.proba} w g): ") # Zmieniono komunikat
            cena_calkowita = pobierz_liczbe(f"Podaj ca≈ÇkowitƒÖ cenƒô sprzeda≈ºy ({magazyn.nazwa_towaru} {magazyn.proba} w PLN): ") # Zmieniono komunikat
            magazyn.sprzedaz(ilosc, cena_calkowita)

        elif wybor == '3':
            magazyn.pokaz_historie()

        elif wybor == '4': # Obs≈Çuga nowej opcji
            magazyn.usun_ostatnia_transakcje()

        elif wybor == '5': # Nowa opcja Kalkulator skupu innej pr√≥by
            print("\n--- KALKULATOR SKUPU INNEJ PR√ìBY ---")
            proba_wejsciowa = pobierz_liczbe("Podaj pr√≥bƒô z≈Çota do skupu: ")
            ilosc_wejsciowa = pobierz_liczbe("Podaj ilo≈õƒá (w gramach) z≈Çota do skupu: ")
            ilosc_przeliczona = magazyn.przelicz_na_probe_docelowa(ilosc_wejsciowa, proba_wejsciowa, magazyn.proba)
            print(f"\n{ilosc_wejsciowa:.2f}g z≈Çota pr√≥by {proba_wejsciowa} to {ilosc_przeliczona:.2f}g ekwiwalentu pr√≥by {magazyn.proba}.")

            cena_za_gram_585 = pobierz_liczbe(f"Podaj cenƒô skupu za gram z≈Çota pr√≥by {magazyn.proba} w PLN: ")
            cena_calkowita = ilosc_przeliczona * cena_za_gram_585
            print(f"Obliczona ca≈Çkowita cena skupu: {cena_calkowita:.2f} PLN")


            zarejestrowac = input("Czy chcesz zarejestrowaƒá ten zakup? (1 - tak, 0 - nie): ")
            if zarejestrowac == '1':
                cena_zaplacona = pobierz_liczbe("Podaj faktycznƒÖ cenƒô zap≈ÇaconƒÖ w PLN: ")
                magazyn.skup(ilosc_przeliczona, cena_zaplacona) # Rejestrujemy przeliczonƒÖ ilo≈õƒá i faktycznƒÖ cenƒô

        elif wybor == '6': # Obs≈Çuga nowej opcji obliczania warto≈õci rynkowej
            print("\n--- OBLICZANIE WARTO≈öCI RYNKOWEJ ---")
            cena_rynkowa_oz = pobierz_liczbe("Podaj aktualnƒÖ rynkowƒÖ cenƒô za uncjƒô z≈Çota pr√≥by 999.9 w PLN: ")
            cena_rynkowa_gram = cena_rynkowa_oz / 31.1035 # Przeliczenie ceny z uncji na gramy
            wartosc_magazynu = magazyn.oblicz_wartosc_magazynu_rynkowa(cena_rynkowa_gram)
            ekwiwalent_999 = magazyn.przelicz_na_999(magazyn.stan_magazynu_g)
            ekwiwalent_999_oz = magazyn.gramy_na_uncje(ekwiwalent_999)
            print("\n--- WARTO≈öƒÜ MAGAZYNU NA PODSTAWIE CENY RYNKOWEJ ---")
            print(f"Stan magazynu (999.9): {ekwiwalent_999:.2f}g ({ekwiwalent_999_oz:.2f} oz)")
            print(f"Warto≈õƒá rynkowa magazynu: {wartosc_magazynu:.2f} PLN")
            print(f"Ca≈Çkowity koszt zakupu: {magazyn.suma_kosztow_zakupu:.2f} PLN") # Wy≈õwietlenie kosztu zakupu
            zysk_strata = wartosc_magazynu - magazyn.suma_kosztow_zakupu # Obliczenie zysku/straty
            if zysk_strata >= 0:
                print(f"Zysk: {zysk_strata:.2f} PLN") # Wy≈õwietlenie zysku
            else:
                print(f"Strata: {zysk_strata:.2f} PLN") # Wy≈õwietlenie straty
            print("="*40)

        elif wybor == '8': # Nowa opcja Ustawienia
            while True:
                print("\n--- USTAWIENIA ---")
                print(f"Aktualna ≈õcie≈ºka kopii zapasowej: {magazyn.plik_kopii_zapasowej}")
                print("1. Zapisz kopiƒô zapasowƒÖ")
                print("2. Wczytaj kopiƒô zapasowƒÖ")
                print("9. Ustaw ≈õcie≈ºkƒô kopii zapasowej")
                print("0. Powr√≥t do menu g≈Ç√≥wnego")
                wybor_ustawienia = input("Wybierz opcjƒô (0-2, 9): ")

                if wybor_ustawienia == '1':
                    magazyn.zapisz_stan()
                elif wybor_ustawienia == '2':
                    magazyn.wczytaj_stan()
                elif wybor_ustawienia == '9':
                    nowa_sciezka = input("Podaj nowƒÖ ≈õcie≈ºkƒô do pliku kopii zapasowej: ")
                    magazyn.plik_kopii_zapasowej = nowa_sciezka
                    magazyn.zapisz_sciezke_kopii_zapasowej() # Zapis nowej ≈õcie≈ºki do pliku konfiguracyjnego
                    print(f"‚úÖ Nowa ≈õcie≈ºka kopii zapasowej ustawiona na: {magazyn.plik_kopii_zapasowej}")
                elif wybor_ustawienia == '0':
                    break
                else:
                    print("Nieprawid≈Çowa opcja. Wprowad≈∫ cyfrƒô od 0 do 2 lub 9.")

        elif wybor == '9': # Nowa opcja resetowania
            print("\n--- RESETOWANIE STAN√ìW I HISTORII ---")
            potwierdzenie = input("Czy na pewno chcesz zresetowaƒá wszystkie stany i historiƒô? Wpisz 'TAK' aby potwierdziƒá: ")
            if potwierdzenie == 'TAK':
                magazyn.__init__(magazyn.nazwa_towaru, 0, magazyn.proba) # Resetowanie stanu magazynu i kasy
                print("‚úÖ Stany magazynu i historia zosta≈Çy zresetowane.")
            else:
                print("‚ùå Resetowanie anulowane.")


        elif wybor == '0': # Zmieniono numer opcji zako≈Ñczenia
            magazyn.zapisz_stan() # Zapis stanu przed wyj≈õciem
            print("Dziƒôkujemy za korzystanie z systemu. Do widzenia! üëã")
            break

        else:
            print("Nieprawid≈Çowa opcja. Wprowad≈∫ cyfrƒô od 0 do 6, 8 lub 9.") # Zmieniono zakres opcji

# Uruchomienie g≈Ç√≥wnej funkcji programu
if __name__ == "__main__":
    main()

