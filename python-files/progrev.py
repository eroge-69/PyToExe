import tkinter as tk
from tkinter import scrolledtext, ttk, messagebox, simpledialog
from selenium import webdriver
from selenium.webdriver.common.by import By
from selenium.webdriver.common.keys import Keys
from selenium.webdriver.chrome.service import Service
from selenium.webdriver.support.ui import WebDriverWait
from selenium.webdriver.support import expected_conditions as EC
from webdriver_manager.chrome import ChromeDriverManager
import time
import os
import random
import threading
import queue

# ������ ��������� ��������� (�������� ��� ���������)
messages = [
    "������! ��� ���� ����?",
    "��� ������? ��������!",
    "��� ���������� �������?",
    "��� ����������� � ��������� �����?",
    "��� ������ ���� ����?",
    "����� ����� �� ��������?",
    "��� ������? ��� � �������?",
    "����� �� ��������, ��� ��?",
    "��� ���� �����?",
    "��� ����������� ��������� �� ������?",
    "��� ��������? ��� ������?",
    "�� �� ��������, ��� � ������� �����!",
    "� ���� ���� ����� �� �����?",
    "��� ���� ������ ������������?",
    "�� ��� ������� ��������� �������?",
    "��� ���� ������? ������� ���������?",
    "����� � ���� ����� ������?",
    "�� ������� ���-������ ����������?",
    "��������� ������� ����� ��� ������",
    "��� ���� �������? ��� ������?",
    "����� ������ � ���� �������?",
    "�� ������ ��������? ��� ��������� �������?",
    "�� ����������� �������? �����?",
    "��� ���� ������ � �����?",
    "�� �� ����� ��� ������� ������?",
    "�� ��� ������? ��� ��������?",
    "��� ������� �� ���� ��������?",
    "�� ������ ��� ����� �����?",
    "��� ���� ����� �������? ��������?",
    "�� ��� �������� ��� ��������?",
    "��� ���� �� ������? ��� ������?",
    "�� �� ������, ��� ����� ������...",
    "�� �����, ��� ��������� �����?",
    "��� ���� �������? ��� ������ � �����?",
    "�� �� ������ ����������� �� ��������� ������?",
    "�� ��� ����� �������� �...?",
    "�� �� ����������, ��� �������...?",
    "�� �������, ��� ������� ���� �������� �...?",
    "�� �� ����� ������ �������?",
    "��� ���� ����� ���? ���������?",
    "�� ��� ��������? ��� ����� �����?",
    "��� ���� ����� ������? �������?",
    "�� �� ������ ������� �� �������?",
    "�� ������� � ���������? �����?",
    "�� ������� ����� ������? ����� ����?",
    "��� ���� ������� ���������?",
    "�� �� ������, ����� ����� ��������?",
    "�� ��� �������� �����?",
    "�� �� ��� �� ������ ��� �...?",
    "�� �� ������ ������� � ������ ������?",
    "��� ���� ���? ����� ��� ��������?",
    "�� �� ������, ��� ����� ��������� ��������?",
    "�� ��� �������� ���� ������?",
    "��� ���� ���� �������� ������?",
    "�� �� ����� ���������...?",
    "�� �� ������, ��� ���...?",
    "��� ���� ���� �...?",
    "�� �� ������ �������������� � ���?",
    "�� ��� ����� ������?",
    "��� ���� ������? ���� �������?",
    "�� �� ������, ��� ����� ������...?",
    "�� ����� ��� ���������?",
    "�� �� ��� �� ����������� ���?",
    "�� �� ������, ������ ��� ���������?",
    "��� �� ���������� � ��������� ��������?",
    "�� �� ������ �������� ��� ���������?",
    "�� ��� ������ �������?",
    "��� ���� ����? ��� ��� ����?",
    "�� �� ������, ��� �������� �� ���� ��������?",
    "�� ��� ��� � ��� ����� �������� ������?",
    "��� ���� ������? �������� ������?",
    "�� �� �����, ��� ������ ������ ����?",
    "�� �� ������, ��� ��� ������� ���������?",
    "�� ��� �������� ������?",
    "�� �� ��� �� ��������� �������?",
    "��� ���� ����? �������?",
    "�� �� ������ ������ ������?",
    "�� ��� �������� ��� �����?",
    "��� ���� ����� ������? ����������?",
    "�� �� ������, ��� ����� ����� �������� �����������?",
    "�� ����� ��������� ������ �...?",
    "�� �� ������ ������ ���-�� ����� ������?",
    "�� ��� �����, ���� ������� �����?",
    "��� ���� ������? ��������?",
    "�� �� ����� ��� ��� �����?",
    "�� �� ������, ������ ��� ����������?",
    "�� ��� ���� �������? ��� ���������?",
    "��� ���� ����� �������? ��������?",
    "�� �� ������ ����������� �� ����?",
    "�� ��� ����� ��������?",
    "��� ���� ����? ������������?",
    "�� �� ������, ��� ��������� �...?",
    "�� ����� ��� ������?",
    "�� �� ��� �� ������ � ���������?",
    "��� ���� �����? ����� ����?",
    "�� �� ������ ���������� �� �����?",
    "�� ��� �������� ������? �����?",
    "��� ���� ��������? ���������?",
    "�� �� ����� ��� ���� ��������������?",
    "�� �� ������, ����� ��� ����� ������?",
    "�� ��� ���������� ����� ���� ����?",
    "��� ���� ���� �� ���� ������?",
    "�� �� ������ ����� �������� � ����?",
    "�� ��� ����? ��� ������?",
    "��� ���� �������? �������?",
    "�� �� ������, ��� �� ������?",
    "�� ����� ���� ����� �����?",
    "�� �� ��� �� ��������� ���� ������?",
    "��� ���� �����? ������?",
    "�� �� ������ ������� ������?",
    "�� ��� �������� �������?",
    "��� ���� ����� ������? �������� ���������?",
    "�� �� �����, ��� ������� ������� ���������?",
    "�� �� ������, ��� ��� ��������?",
    "�� ��� ��������� �� ��������?",
    "��� ���� ����? ��� ������?",
    "�� �� ������ ������� � ���� �� ��������?",
    "�� ��� ������? ��� ������ ����?",
    "��� ���� ������? ����� ������?",
    "�� �� ������, ��� ����� ����� ������� �����?",
    "�� ����� ��������� ������ �������?",
    "�� �� ��� �� �������� ��� ���� ����?",
    "��� ���� ������? ��������?",
    "�� �� ������ ������ ���� ������?",
    "�� ��� ����� � �������?",
    "��� ���� ������� ������? �������?",
    "�� �� ����� ��� ������ ���������?",
    "�� �� ������, ��� ��� ������?",
    "�� ��� ������ ��� �������?",
    "��� ���� ����? ������� ����� �������?",
    "�� �� ������ ������� ������?",
    "�� ��� �������� �������?",
    "��� ���� ���? ������ �������?",
    "�� �� ������, ��� ��� �����?",
    "�� ����� ��� �������?",
    "�� �� ��� �� �������� ���� �� ������?",
    "��� ���� ������? ���� ��������?",
    "�� �� ������ ������� ���� ������ ���������?",
    "�� ��� ����� ����� �������?",
    "��� ���� ������? ���� ����������?",
    "�� �� ����� �������� ������?",
    "�� �� ������, ������� ��� �����?",
    "�� ��� ��� � ��� ����� �����?",
    "��� ���� ��������? ������?",
    "�� �� ������ ��������� � ������ �����?",
    "�� ��� ����� ����� ��������?",
    "��� ���� ������? �����������?",
    "�� �� ������, ��� ����� ������ ������������ ������?",
    "�� ����� ��� �������?",
    "�� �� ��� �� ��������� ��� �������?",
    "��� ���� ������� �� ��������? ����� ������?",
    "�� �� ������ ������ ����� �������?",
    "�� ��� ������� ��� ����������?",
    "��� ���� ���������? ��������?",
    "�� �� ������, ������ �� ��� �������� ��������?",
    "�� ��� ������������� �������?",
    "��� ���� ����������? �������?",
    "�� �� ������ ������ ����� ����?",
    "�� ��� ������ ������?",
    "��� ���� �������? �����?",
    "�� �� ������, ��� ����� �������� �������?",
    "�� ����� ��� �������?",
    "�� �� ��� �� ���������� ��� �����������?",
    "��� ���� �����? ������ ����� � ����?",
    "�� �� ������ ������������ ����������?",
    "�� ��� ����� ��������?",
    "��� ���� ���������? ������� ����?",
    "�� �� ������, ����� ������ �����?",
    "�� ��� �������� ��� ���������?",
    "��� ���� ������? ������� ��������?",
    "�� �� ������ ������ ����� ����������?",
    "�� ��� ������ ����� �� ����� ������?",
    "��� ���� ��������? ������ ����?",
    "�� �� ������, ��� �������� �������� �����?",
    "�� ��� �������� ������������?",
    "��� ���� �������? �������?",
    "�� �� ������ ������� ������?",
    "�� ��� ������ ����� ��������?",
    "��� ���� ��������? ����� ����� ������?",
    "�� �� ������, ��� ������� ������������ ������?",
    "�� ��� ������� ��������?",
    "��� ���� ��������? �������?",
    "�� �� ������ ������� ����������?",
    "�� ��� ������ � ���������?",
    "��� ���� �������� ��������?",
    "�� �� ������, ������ �������� ����� ���������?",
    "�� ��� ������������ ������?",
    "��� ���� ������? ��������?",
    "�� �� ������ ������� ������?",
    "�� ��� �������� ����� ������?",
    "��� ���� ������������ � ����?",
    "�� �� ������, ��� �������� ���� ������?",
    "�� ��� ��������� ���������?",
    "��� ���� �����? ��� �����������?",
    "�� �� ������ ������� ��������� �����?",
    "�� ��� �������� ������ �����?",
    "��� ���� ������? ��� � �������?",
    "�� �� ������, ��� ������������ ��������� �����?",
    "�� ��� �������� ��� ��������� ��� ��������������?",
    "��� ���� ���? ������?",
    "�� �� ������ �������������� ��������?",
    "�� ��� �������� ���������?",
    "��� ���� ��������? �����������?",
    "�� �� ������, ������ ��������� ������?",
    "�� ��� ������� ���?",
    "��� ���� ���������������� ���������? �������?",
    "�� �� ������ �������� ����� �������?",
    "�� ��� ������������� ����������?",
    "��� ���� ������? ��������?",
    "�� �� ������, ��� ����� ������� ������?",
    "�� ��� ����� ���������� �������?",
    "��� ���� ���������? �����������?",
    "�� �� ������ ���������� ����?",
    "�� ��� ����� ������ ��� �����������?",
    "��� ���� ������? ������� �����������?",
    "�� �� ������, ����� ����� ��������� �����?",
    "�� ��� ����� � �������?",
    "��� ���� ������? �������?",
    "�� �� ������ ����������� ��� ����������?",
    "�� ��� ������� ������?",
    "��� ���� �����������? ������?",
    "�� �� ������, ��� �������� ������?",
    "�� ��� ������ ����-������?",
    "��� ���� ����? �������������?",
    "�� �� ������ ���������� ������ �������?",
    "�� ��� �������� �������?",
    "��� ���� ���������? �� ������?",
    "�� �� ������, ��� �������� ��������������?",
    "�� ��� ����� ����������� �� �����?",
    "��� ���� �������� ������?",
    "�� ��� ���������?",
    "����� � ���� ����� �� ����?",
    "�� �� ����� ��� ������ ������?",
    "��� ���� ������ �������?",
    "�� �� ������ ������ �����������?",
    "��� ���� �������� ������?",
    "�� ��� ����� ��������� �������?",
    "��� ������ � ����� �����?",
    "�� �� ������ ���������� ���������?",
    "��� ���� ������ ����������?",
    "�� ��� �������� ���� �� ������?",
    "����� � ���� ���� �� �����?",
    "�� �� ����� ��� ������ ����?",
    "��� ���� �������� � ������������?",
    "�� ��� ����� ����� ����?",
    "����� ����� �� ������ �������?",
    "�� �� ��� �� ��������������� ���-��?",
    "��� ���� ���� � ����� �������?",
    "�� ��� ���������� ��� �� ��������?",
    "����� ���������� �� ������?",
    "�� ������� ������ ������������?",
    "��� ���� ������� ������� �������?",
    "�� �� ������ ������������� �����?",
    "��� ���� �����?",
    "�� ��� ������?",
    "��� ���������� ������ �������?",
    "�� �� ������ ���������� �����?",
    "����� ���� ���� ��������?",
    "�� ��� ����� ��������� ����������?",
    "��� ���� ����������� � ���?",
    "�� �� ��� �� ������� ��� ���������?",
    "��� ���� �����������?",
    "�� ��� ������������ ��� ������?",
    "��� ���� ������� ��������?",
    "�� ������� �� ��� �����������?",
    "��� ������ � ��� ������������?",
    "�� �� ����� ��� ��������?",
    "����� ��� �������?",
    "�� ��� ����� ������?",
    "��� �� ���������� ����������?",
    "�� ������� � ���������?",
    "��� ������������� ����?",
    "��� ���� �������� ���������?",
    "�� ������� �������� ������������?",
    "����� � ���� ���������� ������?",
    "�� ������� ��������� �����������?",
    "��� ���� ����? ��������?",
    "�� �������� ��������?",
    "����� ������� �� �����������?",
    "�� �� ��� �� ��������������� ������?",
    "��� �� ����? ���������?",
    "�� ������� ��������?",
    "��� �� �� ������� � �������?",
    "�� ��� ����� �� ��������?",
    "����� ���������� �� ������ ��������?",
    "�� �� ������, ��� ����� ��������?",
    "����� ������� �� �������������?",
    "�� ��� ��������� ����?",
    "��� ����� �������� ����?",
    "�� �� ��� �� ������ � �������?",
    "��� ���� ���� � ������-���������?",
    "�� ����� ����������� �������?",
    "����� ����� �� �����������?",
    "�� ��������� ��?",
    "��� ���� ��������� �������?",
    "��� ������ � �������?",
    "�� �� ����������� � ����������?",
    "��� �� �� �����?",
    "�� ��������� � ���������?",
    "��� �������?",
    "��� ������ ��������?",
    "�� ������� ��������?",
    "��� �� �� ������� � �� ������?",
    "�� ��� �������� �����?",
    "��� �� ���������� ������?",
    "�� �������� �� ���������?",
    "��� ����� �� ������� ������?",
    "�� ��������� ��?",
    "��� ��� ���� ����� � ������?",
    "�� �� ��� �� �������� ����� � ���� �������?",
    "��� ���� ���� �������������?",
    "��� ���� �����������?",
    "��� �� �� �������?",
    "�� ��� ������������ ��� ������?",
    "��� ��� �������������?",
    "��� �����������?",
    "����� � ��� �����������?",
    "�� �� ������ ����������?",
    "��� �� ����� ����� �����?",
    "��� ��� ���� ����� ������ � �������?",
    "�� ������� ��������� ������?",
    "��� ���������? �������?",
    "�� �������� ��� �����������?",
    "�� �� ����������� � ��������?",
    "���� ��, �� � ������?",
    "�� ������� � ���?",
    "��� ������ �� ���������?",
    "�� ������� ����������?",
    "��� �� �� ������� � ���������?",
    "�� ������������� ��� ��� �������?",
    "����� ����� ����� �������?",
    "�� ��� ����������� ����� �����?",
    "��� ���� ����?",
    "�� ������� ������?",
    "���� ������ ������?",
    "�� �� ������ �������� �����������?",
    "��� �� ����� �������� ������?",
    "��� ���� �������� ������ �����?",
    "�� ��� ��������� ������?",
    "� ��� ���� ����������� ���������?",
    "�� ������ � �� ��������?",
    "�� �� ������ �����������?",
    "����� ������ ���� ���������?",
    "�� ��� ������� ��������������?",
    "��� �� ��� �����������?",
    "�� ������� ����������?",
    "��� �� �� � ��� �������?",
    "�� �� ��� �� ��������������� ���������?",
    "��� ���� ���� � ������� ������������ �����������?",
    "��� � ��� �����?",
    "��� ����?",
    "�� ������� �� �����������?",
    "����� �������?",
    "�� ������� �� �������?",
    "��� ���� � ��� ��������?",
    "�� �� ������ ���������� ������?",
    "��� �� ����� �������� ������ ��������?",
    "�� ��� ����� ���� ����������?",
    "��� �� � ��� �������?",
    "��� ������� ��� ����?",
    "��� �� �� �������?",
    "�� �� ����� ��� ����� �������?",
    "�� �� ��������?",
    "��� ���� ����?",
    "��� �������� ��� ���������?",
    "�� ����� ����?",
    "�� ������� � ���?",
    "��� ������ �������������?",
    "�� ������� ��������� �����������?",
    "��� ��� ���� ����� � �����������?",
    "�� ������������� ������ ��������� ���������� ��� ������ �������?",
    "������?",
    "��� ���� ���� � ������� ���������?",
    "��� ���� �������� � �� �������?",
    "�� �� ������ ���� �������� �����?",
    "��� �� ����� ����� ����� ������� ��������?",
    "��� ��� ����� �����?",
    "�� ��� �������� ��� �������?",
    "������?",
    "��� ��� �� �������?",
    "�� �� ��� �� ��������������� ��� �����?",
    "��� �� ������� � ���?",
    "��� �� �� ������ ��� ������?",
    "�� ��� ������� �������������?",
    "���?",
    "�� �� ������ ���� ��������?",
    "��� ���� ���� ����������� ��������?",
    "�� �� ������, ��� �������� ������������?",
    "����� ������ �� �������������?",
    "�� �������� �� ���� �������?",
    "�� ������� ��?",
    "��� �������?",
    "��� �� �� ����� ������ � ��������?",
    "�� �� ������ �������� ������ ����������?",
    "��� �����?",
    "�� ������������� �������� ��� ��������� ������?",
    "������?",
    "�� ��� �������� ������������?",
    "��� ��� �������?",
    "�� ����� ������ ���������?",
    "��� �������?",
    "�� �� ����������� � �����������?",
    "��� �� ����� ���������?",
    "�� ������� �����������?",
    "��� �� �� �������?",
    "�� �� ��� �� ������ � �������������?",
    "��� ���� ���� � ������������?",
    "�� ���������������� �����������?",
    "��� ��������?",
    "�� ���������� � ����-������?",
    "��� ��� ����?",
    "�� ����� ����� �����?",
    "���� ������ ���������?",
    "�� ����� ���� ����������� � ������?",
    "�� ��������� �������?",
    "�� �� ������ ������������� � ����� ������?",
    "��� ���� ����?",
    "��� ���� ����������?",
    "�� ������ ���� ������?",
    "��� �������� �������� �������?",
    "�� ��� ���������� � ��������?",
    "��� ���� ����?",
    "�� ����� �����?",
    "����� ���� ������?",
    "�� �� ������ �������� �����������?",
    "��� �����?",
    "�� ������������� email ��� push?",
    "������?",
    "�� ��� �������� �����������?",
    "��� ��������?",
    "�� �� ����������� ������?",
    "��� �� ����� ��������?",
    "�� ������� �������� �����������?",
    "��� �� �� �������?",
    "�� �� ��� �� ���������� ������?",
    "��� ���� ���� � ������� ���������?",
    "��� � ��� �����?",
    "��� ����?",
    "�� ����������� ��������� ��������?",
    "��� ���������� �������������?",
    "�� �� ����������� ����������?",
    "��� ������������?",
    "�� ����������� �����-�� �����������?",
    "�� �� ��� �� ���������������?",
    "��� ��� ��������?",
    "�� ������� �� �������?",
    "��� �� �� ������� � ���?",
    "�� ��� ������������ �� � ����� ��������?",
    "��� ��� ��������?",
    "�� ������ ������������?",
    "�����?",
    "�� �� ������ ���������� �����������?",
    "��� ������ ����� ���������?",
    "�� �� ��� �� �������� ����������?",
    "��� ���� ���� ��������� ����������?",
    "�� ����� ��� �������?",
    "��� ����?",
    "�� ��������� ������?",
    "��� �������?",
    "�� ��������� ���� ���������?",
    "���?",
    "�� �� ������ ������� ���-�� ��� ���?",
    "��� ����?",
    "��� ���� ����������?",
    "�� ������� � ���� �������?",
    "��� ��������?",
    "�� �� ��� �� ���������� ��������?",
    "��� ������? ������? �����?",
    "�� ������������� ������ ��� ��������?",
    "������?",
    "�� ��� �������� �������?",
    "��� ����������?",
    "�� ������� �������� �����?",
    "�����?",
    "�� ������� �����������?",
    "��� �� �� �������?",
    "�� �� ������ ������������?",
    "��� ���� ����?",
    "��� ���� ����������?",
    "�� ������ �����������?",
    "�����?",
    "�� ��� �������� � ���-��?",
    "��� �������?",
    "�� �� ������ ������?",
    "����� ���� ������?",
    "����� ������ ���?",
    "�� �����?",
    "�� �� ���������?",
    "��� ��� ���������?",
    "��� ���� ����� �� ��������������?",
    "�� ��� �����?",
    "��� ������?",
    "����� ����������?",
    "�� �������?",
    "��� ������?",
    "�� �� ��� �� �������� �����?",
    "��� ���� ����?",
    "��� ����� ������?",
    "�� ����� ����������?",
    "�� ����� ��������?",
    "�� ������ ������������ �����������?",
    "������?",
    "�� �� ������ ��������� ����������?",
    "�� �����?",
    "��� ����������������?",
    "�� ��������� �������?",
    "��� ����?",
    "�� �� ����������� � ����������� ��������?",
    "�� ������ �����������?",
    "��� ��������?",
    "�� �������?",
    "�� ��������?",
    "�����?",
    "�� ��� ����� ������?",
    "��� �����?",
    "�� �� ����������� ����������?",
    "�����?",
    "�� ������ ������?",
    "��� ����������?",
    "�� ������� ���������������?",
    "��� �� �� �������?",
    "�� �� ��� �� ���� �������� �����?",
    "��� ��������?",
    "��� �������?",
    "�� �������������?",
    "������?",
    "�� ��� ����� �������� �����?",
    "��� �� ����������?",
    "�� ����� ���������?",
    "�� ������� ��������?",
    "��� ��� ���� ����� � ��������?",
    "�� �������� ��� ���������?",
    "������?",
    "�� �� ������ ����������?",
    "�� ������ ����?",
    "�� ������ ���������?",
    "� ���?",
    "�� ��� ���������� ��������� ����?",
    "�����?",
    "�� �� ��� �� ����������?",
    "��� �� ����� ������?",
    "�� ���������� � ��������?",
    "�����?",
    "�� ��� ��������?",
    "��� ��������?",
    "�� �������?",
    "��� ������?",
    "�� �� ������ ��������?",
    "����� ���� ������?",
    "����� ������?",
    "�� ������������� �������?",
    "��� ������?",
    "������?",
    "�� ��� �����?",
    "������?"
]


class WhatsAppWarmupApp:
    def __init__(self, root):
        self.root = root
        self.root.title("WhatsApp ������� ��������� PRO")
        self.root.geometry("800x700")
        self.root.resizable(True, True)
        
        # ���������� ���������
        self.account_count = tk.IntVar(value=2)
        self.drivers = {}
        self.auth_status = {}
        self.auth_buttons = {}
        self.refresh_buttons = {}
        self.is_running = False
        self.log_queue = queue.Queue()
        
        # �������� ����������
        self.create_widgets()
        
        # �������� ������� �����
        self.check_log_queue()
    
    def create_widgets(self):
        # ����� ��������
        settings_frame = ttk.LabelFrame(self.root, text="��������� ���������")
        settings_frame.pack(fill=tk.X, padx=10, pady=5)
        
        # ����� ���������� ���������
        ttk.Label(settings_frame, text="���������� ���������:").grid(row=0, column=0, padx=5, pady=5, sticky=tk.W)
        account_spin = ttk.Spinbox(settings_frame, from_=2, to=10, textvariable=self.account_count, width=5)
        account_spin.grid(row=0, column=1, padx=5, pady=5)
        ttk.Button(settings_frame, text="���������", command=self.update_account_fields).grid(row=0, column=2, padx=5, pady=5)
        
        # ��������� ��� ����� ���������
        self.account_container = ttk.Frame(self.root)
        self.account_container.pack(fill=tk.X, padx=10, pady=5)
        
        # ������� ��������� ���� ��� 2 ���������
        self.create_account_fields()
        
        # ������ ����������
        button_frame = ttk.Frame(self.root)
        button_frame.pack(fill=tk.X, padx=10, pady=5)
        
        self.start_button = ttk.Button(button_frame, text="��������� ��������", command=self.launch_browsers)
        self.start_button.pack(side=tk.LEFT, padx=5)
        
        self.warmup_button = ttk.Button(button_frame, text="������ �������", command=self.start_warmup, state=tk.DISABLED)
        self.warmup_button.pack(side=tk.LEFT, padx=5)
        
        self.stop_button = ttk.Button(button_frame, text="����������", command=self.stop_warmup, state=tk.DISABLED)
        self.stop_button.pack(side=tk.LEFT, padx=5)
        
        # ���
        log_frame = ttk.LabelFrame(self.root, text="��� ����������")
        log_frame.pack(fill=tk.BOTH, expand=True, padx=10, pady=5)
        
        self.log_area = scrolledtext.ScrolledText(log_frame, width=90, height=20)
        self.log_area.pack(fill=tk.BOTH, expand=True, padx=5, pady=5)
        self.log_area.bind("<Control-c>", self.copy_text)
    
    def create_account_fields(self):
        # ������� ���������
        for widget in self.account_container.winfo_children():
            widget.destroy()
        
        # ������� ���� ��� ������� ��������
        self.account_entries = []
        self.auth_buttons = {}
        self.refresh_buttons = {}
        
        for i in range(self.account_count.get()):
            acc_frame = ttk.LabelFrame(self.account_container, text=f"������� #{i+1}")
            acc_frame.pack(fill=tk.X, padx=5, pady=5)
            
            # ����� ��������
            ttk.Label(acc_frame, text="�����:").grid(row=0, column=0, padx=5, pady=2, sticky=tk.W)
            number_entry = ttk.Entry(acc_frame, width=20)
            number_entry.grid(row=0, column=1, padx=5, pady=2, sticky=tk.W)
            
            # ������
            ttk.Label(acc_frame, text="������ (host:port):").grid(row=0, column=2, padx=5, pady=2, sticky=tk.W)
            proxy_entry = ttk.Entry(acc_frame, width=20)
            proxy_entry.grid(row=0, column=3, padx=5, pady=2, sticky=tk.W)
            
            # ������ �����������
            auth_btn = ttk.Button(acc_frame, text="������������", 
                                 command=lambda idx=i: self.authorize_account(idx),
                                 state=tk.DISABLED)
            auth_btn.grid(row=0, column=4, padx=5, pady=2)
            
            # ������ ���������� (���������� ������)
            refresh_btn = ttk.Button(acc_frame, text="?", width=3,
                                    command=lambda idx=i: self.refresh_account(idx),
                                    state=tk.DISABLED)
            refresh_btn.grid(row=0, column=5, padx=5, pady=2)
            refresh_btn.grid_remove()  # �������� �� �����������
            
            self.account_entries.append({
                'number': number_entry,
                'proxy': proxy_entry,
            })
            
            self.auth_buttons[i] = auth_btn
            self.refresh_buttons[i] = refresh_btn
            self.auth_status[i] = False
    
    def update_account_fields(self):
        self.create_account_fields()
        self.log("������������ ��������� ��� {} ���������".format(self.account_count.get()))
    
    def log(self, message):
        timestamp = time.strftime("%H:%M:%S")
        self.log_queue.put(f"[{timestamp}] {message}\n")
    
    def check_log_queue(self):
        while not self.log_queue.empty():
            try:
                msg = self.log_queue.get_nowait()
                self.log_area.insert(tk.END, msg)
                self.log_area.yview(tk.END)
            except queue.Empty:
                break
        self.root.after(100, self.check_log_queue)
    
    def copy_text(self, event=None):
        self.root.clipboard_clear()
        try:
            text = self.log_area.get(tk.SEL_FIRST, tk.SEL_LAST)
            self.root.clipboard_append(text)
        except tk.TclError:
            pass
    
    def launch_browsers(self):
        self.log("������ ���������...")
        
        # ��������� ������ �������
        self.start_button.config(state=tk.DISABLED)
        
        # ��������� � ��������� ������
        threading.Thread(target=self.initialize_drivers, daemon=True).start()
    
    def initialize_drivers(self):
        for i in range(self.account_count.get()):
            if not self.drivers.get(i):
                try:
                    # ������� ����� ��� �������
                    user_data_dir = os.path.join(os.getcwd(), f"chrome_profile_{i+1}")
                    os.makedirs(user_data_dir, exist_ok=True)
                    
                    # ��������� Chrome
                    options = webdriver.ChromeOptions()
                    options.add_argument(f"--user-data-dir={user_data_dir}")
                    options.add_argument("--no-sandbox")
                    options.add_argument("--disable-dev-shm-usage")
                    options.add_argument("--disable-gpu")
                    
                    # ������������� ������ ����
                    options.add_argument("--window-size=800,600")
                    
                    # ������
                    proxy = self.account_entries[i]['proxy'].get()
                    if proxy:
                        try:
                            options.add_argument(f"--proxy-server={proxy}")
                        except Exception as e:
                            self.log(f"������ ������ ��� �������� #{i+1}: {e}")
                    
                    # �������������� �������� ChromeDriver
                    driver_path = ChromeDriverManager().install()
                    service = Service(executable_path=driver_path)
                    
                    # ������������� ��������
                    driver = webdriver.Chrome(service=service, options=options)
                    self.drivers[i] = driver
                    self.log(f"������� ��� �������� #{i+1} �������")
                    self.auth_buttons[i].config(state=tk.NORMAL)
                    
                except Exception as e:
                    self.log(f"������ ��� ������� �������� ��� �������� #{i+1}: {e}")
    
    def authorize_account(self, account_idx):
        # ���������, ���� �� ������� ��� ����� ��������
        if account_idx not in self.drivers:
            self.log(f"������� ��� �������� #{account_idx+1} �� �������")
            return
        
        # ���������� ���������� ���� �������������
        response = messagebox.askyesno("�����������", 
                                      f"����������� ������� #{account_idx+1} � ����������� ���� ��������.\n"
                                      "����� �������� ����������� ������� '��'.",
                                      parent=self.root)
        
        if not response:
            # ������������ ����� "���"
            try:
                self.drivers[account_idx].quit()
                del self.drivers[account_idx]
                self.log(f"����������� �������� #{account_idx+1} ��������")
            except:
                pass
            return
        
        # ��������� WhatsApp
        try:
            self.drivers[account_idx].get("https://web.whatsapp.com")
            self.log(f"������ WhatsApp ��� �������� #{account_idx+1}. ������ �����������...")
        except Exception as e:
            self.log(f"������ ��� �������� WhatsApp: {e}")
            return
        
        # ���������� ������ ���������� ����
        auth_dialog = tk.Toplevel(self.root)
        auth_dialog.title("�������� �����������")
        auth_dialog.geometry("300x100")
        auth_dialog.transient(self.root)
        auth_dialog.grab_set()
        
        tk.Label(auth_dialog, text=f"����������� ������� #{account_idx+1} � ��������").pack(pady=10)
        
        def confirm_auth():
            auth_dialog.destroy()
            self.auth_status[account_idx] = True
            self.auth_buttons[account_idx].config(state=tk.DISABLED, text="? �����������")
            self.refresh_buttons[account_idx].grid()  # ���������� ������ ����������
            self.refresh_buttons[account_idx].config(state=tk.NORMAL)
            self.log(f"������� #{account_idx+1} ������� �����������")
            
            # ���������, ��� �� �������� ������������
            if all(self.auth_status.values()):
                self.warmup_button.config(state=tk.NORMAL)
                self.log("��� �������� ������������! ������ � ��������")
        
        def cancel_auth():
            auth_dialog.destroy()
            try:
                self.drivers[account_idx].quit()
                del self.drivers[account_idx]
                self.log(f"����������� �������� #{account_idx+1} ��������")
            except:
                pass
        
        tk.Button(auth_dialog, text="OK", command=confirm_auth, width=10).pack(side=tk.LEFT, padx=20, pady=10)
        tk.Button(auth_dialog, text="������", command=cancel_auth, width=10).pack(side=tk.RIGHT, padx=20, pady=10)
    
    def refresh_account(self, account_idx):
        # ��������� ������� �������
        try:
            if account_idx in self.drivers:
                self.drivers[account_idx].quit()
                del self.drivers[account_idx]
        except:
            pass
        
        # ���������� ������ �����������
        self.auth_status[account_idx] = False
        self.auth_buttons[account_idx].config(text="������������", state=tk.NORMAL)
        self.refresh_buttons[account_idx].config(state=tk.DISABLED)
        self.log(f"�������� ����������� ��� �������� #{account_idx+1}")
        
        # ��������� ����� �������
        try:
            # ������� ����� ��� �������
            user_data_dir = os.path.join(os.getcwd(), f"chrome_profile_{account_idx+1}")
            os.makedirs(user_data_dir, exist_ok=True)
            
            # ��������� Chrome
            options = webdriver.ChromeOptions()
            options.add_argument(f"--user-data-dir={user_data_dir}")
            options.add_argument("--no-sandbox")
            options.add_argument("--disable-dev-shm-usage")
            options.add_argument("--disable-gpu")
            options.add_argument("--window-size=800,600")
            
            # ������
            proxy = self.account_entries[account_idx]['proxy'].get()
            if proxy:
                try:
                    options.add_argument(f"--proxy-server={proxy}")
                except Exception as e:
                    self.log(f"������ ������ ��� �������� #{account_idx+1}: {e}")
            
            # �������������� �������� ChromeDriver
            driver_path = ChromeDriverManager().install()
            service = Service(executable_path=driver_path)
            
            # ������������� ��������
            driver = webdriver.Chrome(service=service, options=options)
            self.drivers[account_idx] = driver
            self.log(f"������� ��� �������� #{account_idx+1} �����������")
        except Exception as e:
            self.log(f"������ ��� ����������� �������� ��� �������� #{account_idx+1}: {e}")
    
    def start_warmup(self):
        if not all(self.auth_status.values()):
            messagebox.showerror("������", "�� ��� �������� ������������!")
            return
        
        self.is_running = True
        self.start_button.config(state=tk.DISABLED)
        self.warmup_button.config(state=tk.DISABLED)
        self.stop_button.config(state=tk.NORMAL)
        
        self.log("������ �������� ���������...")
        threading.Thread(target=self.run_warmup, daemon=True).start()
    
    def run_warmup(self):
        account_count = self.account_count.get()
        
        while self.is_running:
            try:
                # ������� ������� �������� ���������
                for sender_idx in range(account_count):
                    for receiver_idx in range(account_count):
                        if sender_idx == receiver_idx:
                            continue  # ���������� �������� ������ ����
                        
                        # �������� ������� �����������
                        sender_driver = self.drivers[sender_idx]
                        
                        # �������� ����� ����������
                        receiver_number = self.account_entries[receiver_idx]['number'].get()
                        
                        if not receiver_number:
                            self.log(f"������: �� ������ ����� ��� �������� #{receiver_idx+1}")
                            continue
                        
                        # �������� ��������� ���������
                        message = random.choice(messages)
                        
                        # ���������� ���������
                        self.send_message(sender_driver, receiver_number, message, sender_idx, receiver_idx)
                        
                        # �������� ����� ����������� �� ������ �������� (5-6 ������)
                        time.sleep(random.uniform(5, 6))
                    
                    # �������� ����� ������� ���������� (1 �������)
                    time.sleep(1)
                
                # ����� ����� ������� �������
                time.sleep(10)
                
            except Exception as e:
                self.log(f"������ � �������� ��������: {e}")
                time.sleep(10)
    
    def send_message(self, driver, to_number, message, from_idx, to_idx):
        try:
            # ��������� ��� � �����������
            driver.get(f"https://web.whatsapp.com/send?phone={to_number}")
            
            # ������� �������� ���� � ����������� �������� ��������
            try:
                WebDriverWait(driver, 30).until(
                    EC.presence_of_element_located((By.XPATH, '//div[@contenteditable="true"][@data-tab="10"]'))
                )
            except:
                # ���� �� ������� ����� �������, ��������� ������ ������
                try:
                    # ���������, ���� �� ��������� � ���, ��� ����� �� ���������������
                    error_element = driver.find_elements(By.XPATH, '//div[contains(text(), "�� ���������������")]')
                    if error_element:
                        self.log(f"������: ����� {to_number} �� ��������������� � WhatsApp")
                        return
                except:
                    pass
                
                self.log(f"�� ������� ��������� ��� ��� ������ {to_number}")
                return
            
            # ������ ���������
            input_box = driver.find_element(By.XPATH, '//div[@contenteditable="true"][@data-tab="10"]')
            input_box.clear()
            
            # ������ ��������� �� ������, ����� �������� ����������
            for char in message:
                input_box.send_keys(char)
                time.sleep(0.05)
            
            # ���������� ���������
            input_box.send_keys(Keys.ENTER)
            
            self.log(f"������� #{from_idx+1} > ������� #{to_idx+1}: {message}")
            
        except Exception as e:
            self.log(f"������ ��������: {e}")
    
    def stop_warmup(self):
        self.is_running = False
        self.stop_button.config(state=tk.DISABLED)
        self.warmup_button.config(state=tk.NORMAL)
        self.log("������� ����������")
    
    def on_closing(self):
        self.stop_warmup()
        for account_idx in list(self.drivers.keys()):
            try:
                self.drivers[account_idx].quit()
                del self.drivers[account_idx]
            except:
                pass
        self.root.destroy()

if __name__ == "__main__":
    root = tk.Tk()
    app = WhatsAppWarmupApp(root)
    root.protocol("WM_DELETE_WINDOW", app.on_closing)
    root.mainloop()