import subprocess
import os

def restart_to_recovery_environment():
    """
    Перезагружает компьютер и открывает меню, 
    из которого можно перейти в среду восстановления Windows.
    """
    print("Эта программа перезагрузит ваш компьютер и откроет меню, где вы сможете перейти в среду восстановления Windows.")
    print("Это полезно для устранения системных неполадок.")
    print("Пожалуйста, сохраните все открытые документы перед началом.")
    
    user_choice = input("Вы уверены, что хотите продолжить и перезагрузить компьютер? (да/нет): ").lower()
    
    if user_choice == 'да':
        try:
            # Запускаем команду shutdown с параметрами
            # /r - перезагрузка (restart)
            # /o - открыть меню параметров загрузки (advanced options)
            # /t 0 - немедленная перезагрузка (timeout 0)
            subprocess.run(["shutdown", "/r", "/o", "/t", "0"], check=True)
            print("Перезагрузка инициирована. Следуйте инструкциям на экране, чтобы попасть в среду восстановления.")
        except FileNotFoundError:
            print("Ошибка: Команда 'shutdown' не найдена. Эта программа предназначена только для Windows.")
        except subprocess.CalledProcessError:
            print("Ошибка при выполнении команды. Убедитесь, что вы запустили программу с правами администратора.")
        except Exception as e:
            print(f"Произошла непредвиденная ошибка: {e}")
    else:
        print("Перезагрузка отменена.")

if __name__ == "__main__":
    restart_to_recovery_environment()