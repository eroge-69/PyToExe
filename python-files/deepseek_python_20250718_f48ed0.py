import time
import webbrowser
import pyautogui
from bs4 import BeautifulSoup
import requests
import winsound

# ?????????
URL = "https://tasks.yandex.ru/"  # ?????? ?? ?????? URL
SEARCH_TEXTS = ["????????????? ????????", "??????????? ?????", "????????"]  # ?????? ??????? ???????
REFRESH_INTERVAL = 180  # 3 ?????? (? ????????)

def refresh_page():
    # ????????? ???????? ? ??????.???????? (???? ??? ?? ???????)
    webbrowser.get("yandex").open_new(URL)
    time.sleep(5)  # ???? ????????
    
    # ????????? ???????? (F5 ??? Ctrl+R)
    pyautogui.hotkey('f5')
    time.sleep(5)  # ???? ??????????

def check_page_for_texts():
    try:
        # ???????? HTML ????????
        response = requests.get(URL)
        soup = BeautifulSoup(response.text, 'html.parser')
        page_text = soup.get_text()

        found_texts = []
        for text in SEARCH_TEXTS:
            if text in page_text:
                found_texts.append(text)

        if found_texts:
            print(f"??????? ??????????: {', '.join(found_texts)}")
            play_alert_sound()
            return True
        else:
            print("?? ???? ?? ??????? ?? ??????.")
            return False
    except Exception as e:
        print(f"??????: {e}")
        return False

def play_alert_sound():
    # ??????????? ???????? ?????? (Windows)
    winsound.Beep(1000, 1000)  # ??????? 1000 ??, ???????????? 1 ???

def main():
    print(f"????????? ????????. ????? ???????: {', '.join(SEARCH_TEXTS)}")
    while True:
        refresh_page()
        if check_page_for_texts():
            break  # ???? ???? ?? ???? ????? ??????, ????????? ????
        time.sleep(REFRESH_INTERVAL)

if __name__ == "__main__":
    main()