(PASTE THE FULL PYTHON SOURCE CODE HERE - trimmed for brevity in this preview)