import os
import subprocess

# Get the directory where this script is located
script_dir = os.path.dirname(os.path.abspath(__file__))

# Change current working directory to script directory
os.chdir(script_dir)

# Command prefix (replace SCAN with full path if needed)
command_base = "SCAN /UNZIP /SUB /ALL /RPTOBJECTS /RPTALL /RPTCOR /RPTERR /LOUD /APPEND /HTML"

# Get all .zip files in the directory
zip_files = [f for f in os.listdir(script_dir) if f.lower().endswith('.zip')]

# Process each .zip file
for zip_file in zip_files:
    html_report = f"MalwareRpt_{zip_file.replace('.zip', '.html')}"
    full_command = f'{command_base} {html_report} {zip_file}'
    
    print(f"Running: {full_command}")
    
    # Execute the command
    subprocess.run(full_command, shell=True)
