import tkinter as tk
from tkinter import ttk, filedialog, messagebox, scrolledtext
import os
import subprocess
import tempfile
import base64
import sys

class BatToExeConverter:
    def __init__(self, root):
        self.root = root
        self.root.title("BAT to EXE Converter v2.1")
        
        # Ekran boyutlarƒ±nƒ± al ve uygun boyut ayarla
        screen_width = self.root.winfo_screenwidth()
        screen_height = self.root.winfo_screenheight()
        
        # Pencere boyutunu ekran boyutuna g√∂re ayarla (maksimum 80% ekran)
        window_width = min(950, int(screen_width * 0.8))
        window_height = min(750, int(screen_height * 0.8))
        
        # Pencereyi ortala
        pos_x = (screen_width // 2) - (window_width // 2)
        pos_y = (screen_height // 2) - (window_height // 2)
        
        self.root.geometry(f"{window_width}x{window_height}+{pos_x}+{pos_y}")
        self.root.configure(bg='#1e1e1e')
        self.root.minsize(800, 600)  # Minimum boyut
        
        # ƒ∞kon ayarla
        try:
            self.root.iconbitmap(default="bat2exe.ico")
        except:
            pass
        
        self.bat_content = ""
        self.version = "2.1"
        self.setup_ui()
        
        # Ba≈ülangƒ±√ßta kontrol et
        self.check_requirements()
    
    def check_requirements(self):
        """Gerekli programlarƒ± kontrol et"""
        missing = []
        
        # PyInstaller kontrol
        try:
            result = subprocess.run(['pyinstaller', '--version'], 
                                  capture_output=True, text=True)
            if result.returncode != 0:
                missing.append("PyInstaller")
        except FileNotFoundError:
            missing.append("PyInstaller")
        
        if missing:
            msg = f"Eksik gereksinimler bulundu:\n\n"
            for item in missing:
                msg += f"‚ùå {item}\n"
            msg += f"\nKurulum i√ßin terminalde ≈üu komutu √ßalƒ±≈ütƒ±rƒ±n:\npip install pyinstaller\n\n"
            msg += "Kurulum tamamlandƒ±ktan sonra programƒ± yeniden ba≈ülatƒ±n."
            
            messagebox.showwarning("Gereksinimler", msg)
            self.status_var.set("‚ùå Gereksinimler eksik - pip install pyinstaller")
        else:
            self.status_var.set("‚úÖ T√ºm gereksinimler mevcut")
    
    def setup_ui(self):
        # Ana scrollable canvas
        canvas = tk.Canvas(self.root, bg='#1e1e1e', highlightthickness=0)
        scrollbar = ttk.Scrollbar(self.root, orient="vertical", command=canvas.yview)
        scrollable_frame = tk.Frame(canvas, bg='#1e1e1e')
        
        scrollable_frame.bind(
            "<Configure>",
            lambda e: canvas.configure(scrollregion=canvas.bbox("all"))
        )
        
        canvas.create_window((0, 0), window=scrollable_frame, anchor="nw")
        canvas.configure(yscrollcommand=scrollbar.set)
        
        # Ana container
        main_container = tk.Frame(scrollable_frame, bg='#1e1e1e')
        main_container.pack(fill=tk.BOTH, expand=True, padx=15, pady=15)
        
        # Header
        header_frame = tk.Frame(main_container, bg='#1e1e1e')
        header_frame.pack(fill=tk.X, pady=(0, 15))
        
        title_label = tk.Label(
            header_frame, 
            text="ü¶á BAT to EXE Converter", 
            font=("Segoe UI", 18, "bold"),
            bg='#1e1e1e', 
            fg='#00ff88'
        )
        title_label.pack()
        
        version_label = tk.Label(
            header_frame,
            text=f"Versiyon {self.version} ‚Ä¢ Batch dosyalarƒ±nƒ±zƒ± executable'a √ßevirin",
            font=("Segoe UI", 10),
            bg='#1e1e1e',
            fg='#888888'
        )
        version_label.pack(pady=(5, 0))
        
        # S√ºr√ºm bilgileri butonu
        info_btn = tk.Button(
            header_frame,
            text="‚ÑπÔ∏è Hakkƒ±nda",
            command=self.show_about,
            bg='#444444',
            fg='white',
            font=("Segoe UI", 8),
            relief='flat',
            cursor='hand2'
        )
        info_btn.pack(pady=(5, 0))
        
        # Dosya se√ßim b√∂l√ºm√º
        file_section = tk.LabelFrame(
            main_container, 
            text=" üìÅ BAT Dosyasƒ± Se√ßin ",
            bg='#1e1e1e', 
            fg='#ffffff',
            font=("Segoe UI", 10, "bold"),
            relief='groove',
            bd=2
        )
        file_section.pack(fill=tk.X, pady=(0, 10))
        
        file_inner = tk.Frame(file_section, bg='#1e1e1e')
        file_inner.pack(fill=tk.X, padx=10, pady=8)
        
        self.file_path_var = tk.StringVar()
        file_entry = tk.Entry(
            file_inner, 
            textvariable=self.file_path_var,
            bg='#2d2d2d', 
            fg='#ffffff', 
            font=("Consolas", 9),
            relief='flat',
            bd=5
        )
        file_entry.pack(side=tk.LEFT, fill=tk.X, expand=True, padx=(0, 8))
        
        browse_btn = tk.Button(
            file_inner,
            text="üìÇ G√∂zat",
            command=self.browse_file,
            bg='#0078d4',
            fg='white',
            font=("Segoe UI", 9, "bold"),
            relief='flat',
            cursor='hand2',
            padx=15
        )
        browse_btn.pack(side=tk.RIGHT)
        
        # Kod edit√∂r√º b√∂l√ºm√º - Y√ºksekliƒüi azalttƒ±k
        editor_section = tk.LabelFrame(
            main_container,
            text=" üìù BAT Kod Edit√∂r√º ",
            bg='#1e1e1e',
            fg='#ffffff',
            font=("Segoe UI", 10, "bold"),
            relief='groove',
            bd=2
        )
        editor_section.pack(fill=tk.X, pady=(0, 10))
        
        editor_inner = tk.Frame(editor_section, bg='#1e1e1e')
        editor_inner.pack(fill=tk.X, padx=10, pady=8)
        
        # Ara√ß √ßubuƒüu
        toolbar = tk.Frame(editor_inner, bg='#1e1e1e')
        toolbar.pack(fill=tk.X, pady=(0, 8))
        
        sample_btn = tk.Button(
            toolbar,
            text="üî• √ñrnek Kod",
            command=self.load_sample,
            bg='#ff6b35',
            fg='white',
            font=("Segoe UI", 8, "bold"),
            relief='flat',
            cursor='hand2'
        )
        sample_btn.pack(side=tk.LEFT, padx=(0, 8))
        
        clear_btn = tk.Button(
            toolbar,
            text="üóëÔ∏è Temizle",
            command=self.clear_editor,
            bg='#dc3545',
            fg='white',
            font=("Segoe UI", 8, "bold"),
            relief='flat',
            cursor='hand2'
        )
        clear_btn.pack(side=tk.LEFT)
        
        # Edit√∂r - Sabit y√ºkseklik
        self.text_editor = scrolledtext.ScrolledText(
            editor_inner,
            bg='#0d1117',
            fg='#c9d1d9',
            font=("Consolas", 10),
            insertbackground='#ffffff',
            selectbackground='#264f78',
            relief='flat',
            bd=5,
            wrap=tk.NONE,
            height=12  # Sabit y√ºkseklik
        )
        self.text_editor.pack(fill=tk.X)
        
        # Se√ßenekler b√∂l√ºm√º
        options_section = tk.LabelFrame(
            main_container,
            text=" ‚öôÔ∏è EXE Se√ßenekleri ",
            bg='#1e1e1e',
            fg='#ffffff',
            font=("Segoe UI", 10, "bold"),
            relief='groove',
            bd=2
        )
        options_section.pack(fill=tk.X, pady=(0, 10))
        
        options_inner = tk.Frame(options_section, bg='#1e1e1e')
        options_inner.pack(fill=tk.X, padx=10, pady=8)
        
        # √úst satƒ±r - Checkboxlar
        top_options = tk.Frame(options_inner, bg='#1e1e1e')
        top_options.pack(fill=tk.X, pady=(0, 5))
        
        self.invisible_var = tk.BooleanVar()
        invisible_check = tk.Checkbutton(
            top_options,
            text="üëª Gizli √ßalƒ±≈üma (konsol gizli)",
            variable=self.invisible_var,
            bg='#1e1e1e',
            fg='#ffffff',
            selectcolor='#2d2d2d',
            font=("Segoe UI", 9),
            activebackground='#1e1e1e',
            activeforeground='#ffffff'
        )
        invisible_check.pack(side=tk.LEFT)
        
        self.admin_var = tk.BooleanVar()
        admin_check = tk.Checkbutton(
            top_options,
            text="üõ°Ô∏è Admin yetkisi iste",
            variable=self.admin_var,
            bg='#1e1e1e',
            fg='#ffffff',
            selectcolor='#2d2d2d',
            font=("Segoe UI", 9),
            activebackground='#1e1e1e',
            activeforeground='#ffffff'
        )
        admin_check.pack(side=tk.LEFT, padx=(20, 0))
        
        # Alt satƒ±r - EXE adƒ±
        bottom_options = tk.Frame(options_inner, bg='#1e1e1e')
        bottom_options.pack(fill=tk.X)
        
        tk.Label(
            bottom_options,
            text="üì¶ EXE Adƒ±:",
            bg='#1e1e1e',
            fg='#ffffff',
            font=("Segoe UI", 9)
        ).pack(side=tk.LEFT)
        
        self.exe_name_var = tk.StringVar(value="program.exe")
        exe_name_entry = tk.Entry(
            bottom_options,
            textvariable=self.exe_name_var,
            bg='#2d2d2d',
            fg='#ffffff',
            font=("Consolas", 9),
            width=25,
            relief='flat',
            bd=5
        )
        exe_name_entry.pack(side=tk.LEFT, padx=(10, 0))
        
        # Ana d√∂n√º≈üt√ºrme butonu
        convert_btn = tk.Button(
            main_container,
            text="üöÄ EXE'YE D√ñN√ú≈ûT√úR",
            command=self.convert_to_exe,
            bg='#28a745',
            fg='white',
            font=("Segoe UI", 12, "bold"),
            relief='flat',
            cursor='hand2',
            height=2
        )
        convert_btn.pack(pady=(0, 10), fill=tk.X)
        
        # Durum √ßubuƒüu - Her zaman altta sabit
        status_frame = tk.Frame(self.root, bg='#2d2d2d', relief='sunken', bd=1)
        status_frame.pack(fill=tk.X, side=tk.BOTTOM)
        
        self.status_var = tk.StringVar(value="Program ba≈ülatƒ±ldƒ±...")
        status_bar = tk.Label(
            status_frame,
            textvariable=self.status_var,
            bg='#2d2d2d',
            fg='#ffffff',
            font=("Segoe UI", 8),
            anchor='w'
        )
        status_bar.pack(fill=tk.X, padx=5, pady=2)
        
        # Canvas'ƒ± pack et
        canvas.pack(side="left", fill="both", expand=True)
        scrollbar.pack(side="right", fill="y")
        
        # Mouse wheel binding
        def _on_mousewheel(event):
            canvas.yview_scroll(int(-1*(event.delta/120)), "units")
        canvas.bind_all("<MouseWheel>", _on_mousewheel)
    
    def show_about(self):
        """Hakkƒ±nda penceresi g√∂ster"""
        about_window = tk.Toplevel(self.root)
        about_window.title("Hakkƒ±nda")
        about_window.geometry("400x350")
        about_window.configure(bg='#1e1e1e')
        about_window.resizable(False, False)
        about_window.transient(self.root)
        about_window.grab_set()
        
        # Pencereyi ortala
        about_window.geometry("+{}+{}".format(
            self.root.winfo_x() + 250, 
            self.root.winfo_y() + 100
        ))
        
        tk.Label(
            about_window,
            text="ü¶á BAT to EXE Converter",
            font=("Segoe UI", 16, "bold"),
            bg='#1e1e1e',
            fg='#00ff88'
        ).pack(pady=(20, 10))
        
        info_text = f"""Versiyon: {self.version}
Geli≈ütirici: Python & Tkinter

üìã √ñzellikler:
‚Ä¢ BAT dosyalarƒ±nƒ± EXE'ye d√∂n√º≈üt√ºr√ºr
‚Ä¢ Gizli √ßalƒ±≈üma se√ßeneƒüi
‚Ä¢ Admin yetkileri desteƒüi
‚Ä¢ √ñzel EXE adlandƒ±rma
‚Ä¢ Kod edit√∂r√º entegreli
‚Ä¢ √ñrnek kod ≈üablonlarƒ±

üîß Gereksinimler:
‚Ä¢ Python 3.6+
‚Ä¢ PyInstaller

üìÖ Son G√ºncelleme: 2025
üåü Tamamen √ºcretsiz ve a√ßƒ±k kaynak"""
        
        tk.Label(
            about_window,
            text=info_text,
            font=("Segoe UI", 9),
            bg='#1e1e1e',
            fg='#ffffff',
            justify='left'
        ).pack(pady=10, padx=20)
        
        tk.Button(
            about_window,
            text="‚úÖ Tamam",
            command=about_window.destroy,
            bg='#0078d4',
            fg='white',
            font=("Segoe UI", 9, "bold"),
            relief='flat',
            cursor='hand2',
            width=15
        ).pack(pady=20)
    
    def browse_file(self):
        """BAT dosyasƒ± se√ß"""
        file_path = filedialog.askopenfilename(
            title="BAT dosyasƒ± se√ßin",
            filetypes=[
                ("Batch files", "*.bat *.cmd"),
                ("All files", "*.*")
            ]
        )
        if file_path:
            self.file_path_var.set(file_path)
            try:
                with open(file_path, 'r', encoding='utf-8', errors='ignore') as f:
                    content = f.read()
                self.text_editor.delete(1.0, tk.END)
                self.text_editor.insert(1.0, content)
                self.status_var.set(f"‚úÖ Dosya y√ºklendi: {os.path.basename(file_path)}")
            except Exception as e:
                messagebox.showerror("Hata", f"Dosya okunamadƒ±: {str(e)}")
                self.status_var.set("‚ùå Dosya okuma hatasƒ±")
    
    def load_sample(self):
        """√ñrnek BAT kodu y√ºkle"""
        sample_code = '''@echo off
title ü¶á BAT to EXE Test Programƒ±
color 0a
mode con cols=80 lines=30

echo.
echo ‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà
echo ‚ñà‚ñà                                                                            ‚ñà‚ñà
echo ‚ñà‚ñà                        BAT to EXE Test Programƒ±                           ‚ñà‚ñà
echo ‚ñà‚ñà                              v1.0                                         ‚ñà‚ñà
echo ‚ñà‚ñà                                                                            ‚ñà‚ñà
echo ‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà
echo.
echo Merhaba %USERNAME%!
echo Bu program BAT to EXE Converter ile olu≈üturulmu≈ütur.
echo.
echo Sistem Bilgileri:
echo ==================
echo üñ•Ô∏è  Bilgisayar Adƒ±: %COMPUTERNAME%
echo üë§ Kullanƒ±cƒ± Adƒ±: %USERNAME%
echo üìÖ Tarih: %DATE%
echo üïê Saat: %TIME%
echo üíª ƒ∞≈ületim Sistemi: %OS%
echo üìÅ Mevcut Klas√∂r: %CD%
echo.

:menu
echo ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
echo                                   MEN√ú
echo ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
echo.
echo [1] üìÅ Dosya listesi g√∂ster
echo [2] üíæ Disk kullanƒ±mƒ±nƒ± g√∂ster  
echo [3] üåê Aƒü baƒülantƒ±larƒ±nƒ± g√∂ster
echo [4] üîç Sistem bilgilerini g√∂ster
echo [5] üìä √áalƒ±≈üan i≈ülemleri g√∂ster
echo [6] üé® Renk deƒüi≈ütir
echo [0] ‚ùå √áƒ±kƒ±≈ü
echo.
set /p "choice=Se√ßiminizi yapƒ±n (0-6): "

if "%choice%"=="1" goto files
if "%choice%"=="2" goto disk
if "%choice%"=="3" goto network
if "%choice%"=="4" goto sysinfo
if "%choice%"=="5" goto processes
if "%choice%"=="6" goto colors
if "%choice%"=="0" goto exit

echo ‚ùå Ge√ßersiz se√ßim! L√ºtfen 0-6 arasƒ±nda bir sayƒ± girin.
ping localhost -n 2 >nul
goto menu

:files
cls
echo üìÅ DOSYA Lƒ∞STESƒ∞
echo ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
dir /b /a
echo.
pause
goto menu

:disk
cls
echo üíæ Dƒ∞SK KULLANIMI
echo ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
wmic logicaldisk get size,freespace,caption
echo.
pause
goto menu

:network
cls
echo üåê Aƒû BAƒûLANTILARI
echo ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
ipconfig
echo.
pause
goto menu

:sysinfo
cls
echo üîç Sƒ∞STEM Bƒ∞LGƒ∞LERƒ∞
echo ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
systeminfo
echo.
pause
goto menu

:processes
cls
echo üìä √áALI≈ûAN ƒ∞≈ûLEMLER
echo ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
tasklist
echo.
pause
goto menu

:colors
cls
echo üé® RENK SE√áƒ∞Mƒ∞
echo ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
echo [1] Ye≈üil    [4] Sarƒ±
echo [2] Mavi     [5] Mor  
echo [3] Kƒ±rmƒ±zƒ±  [6] Beyaz
echo.
set /p "color_choice=Renk se√ßin (1-6): "

if "%color_choice%"=="1" color a
if "%color_choice%"=="2" color 0b
if "%color_choice%"=="3" color 4
if "%color_choice%"=="4" color 0e
if "%color_choice%"=="5" color 0d
if "%color_choice%"=="6" color 0f

goto menu

:exit
cls
echo.
echo ‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà
echo ‚ñà‚ñà                            TE≈ûEKK√úRLER!                                   ‚ñà‚ñà
echo ‚ñà‚ñà                   BAT to EXE Converter kullandƒ±ƒüƒ±nƒ±z i√ßin                 ‚ñà‚ñà
echo ‚ñà‚ñà                              te≈üekk√ºrler!                                 ‚ñà‚ñà
echo ‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà
echo.
echo √áƒ±kƒ±≈ü yapƒ±lƒ±yor...
for /l %%i in (3,-1,1) do (
    echo %%i saniye kaldƒ±...
    ping localhost -n 2 >nul
)
exit'''
        
        self.text_editor.delete(1.0, tk.END)
        self.text_editor.insert(1.0, sample_code)
        self.status_var.set("üî• √ñrnek kod y√ºklendi")
    
    def clear_editor(self):
        """Edit√∂r√º temizle"""
        if messagebox.askyesno("Temizle", "Edit√∂rdeki t√ºm kod silinecek. Emin misiniz?"):
            self.text_editor.delete(1.0, tk.END)
            self.status_var.set("üóëÔ∏è Edit√∂r temizlendi")
    
    def convert_to_exe(self):
        """BAT kodunu EXE'ye d√∂n√º≈üt√ºr"""
        bat_content = self.text_editor.get(1.0, tk.END).strip()
        if not bat_content:
            messagebox.showerror("Hata", "BAT kodu bo≈ü!\n\nL√ºtfen kod yazƒ±n veya dosya y√ºkleyin.")
            return
        
        exe_name = self.exe_name_var.get().strip()
        if not exe_name:
            exe_name = "program.exe"
        elif not exe_name.endswith('.exe'):
            exe_name += '.exe'
        
        try:
            self.status_var.set("üîÑ D√∂n√º≈üt√ºr√ºl√ºyor...")
            self.root.update()
            
            # √áƒ±ktƒ± klas√∂r√º se√ß
            output_dir = filedialog.askdirectory(title="EXE dosyasƒ±nƒ± nereye kaydetmek istiyorsunuz?")
            if not output_dir:
                self.status_var.set("‚ùå ƒ∞≈ülem iptal edildi")
                return
            
            # Python wrapper script olu≈ütur
            python_script = self.create_python_wrapper(bat_content)
            
            # Ge√ßici Python dosyasƒ± olu≈ütur
            with tempfile.NamedTemporaryFile(mode='w', suffix='.py', delete=False, encoding='utf-8') as temp_py:
                temp_py.write(python_script)
                temp_py_path = temp_py.name
            
            # PyInstaller komutu olu≈ütur
            base_name = exe_name.replace('.exe', '')
            cmd = [
                sys.executable, '-m', 'PyInstaller',
                '--onefile',
                '--distpath', output_dir,
                '--workpath', os.path.join(output_dir, 'build'),
                '--specpath', os.path.join(output_dir, 'spec'),
                '--name', base_name,
                '--clean'
            ]
            
            if self.invisible_var.get():
                cmd.append('--windowed')
                
            cmd.append(temp_py_path)
            
            # PyInstaller'ƒ± √ßalƒ±≈ütƒ±r
            self.status_var.set("üîß PyInstaller √ßalƒ±≈üƒ±yor...")
            self.root.update()
            
            result = subprocess.run(cmd, capture_output=True, text=True, cwd=output_dir)
            
            # Ge√ßici dosyayƒ± temizle
            try:
                os.unlink(temp_py_path)
            except:
                pass
            
            if result.returncode == 0:
                exe_path = os.path.join(output_dir, exe_name)
                self.status_var.set(f"‚úÖ Ba≈üarƒ±lƒ±! EXE olu≈üturuldu: {exe_name}")
                
                msg = f"üéâ BAT dosyasƒ± ba≈üarƒ±yla EXE'ye d√∂n√º≈üt√ºr√ºld√º!\n\n"
                msg += f"üìÇ Konum: {output_dir}\n"
                msg += f"üì¶ Dosya: {exe_name}\n\n"
                msg += f"Dosyayƒ± a√ßmak istiyor musunuz?"
                
                if messagebox.askyesno("Ba≈üarƒ±lƒ±!", msg):
                    try:
                        os.startfile(output_dir)
                    except:
                        pass
            else:
                error_msg = result.stderr or result.stdout or "Bilinmeyen hata"
                raise Exception(error_msg)
                
        except FileNotFoundError:
            msg = "‚ùå PyInstaller bulunamadƒ±!\n\n"
            msg += "L√ºtfen terminalde ≈üu komutu √ßalƒ±≈ütƒ±rƒ±n:\n"
            msg += "pip install pyinstaller\n\n"
            msg += "Kurulum tamamlandƒ±ktan sonra tekrar deneyin."
            messagebox.showerror("PyInstaller Bulunamadƒ±", msg)
            self.status_var.set("‚ùå PyInstaller bulunamadƒ±")
        except Exception as e:
            error_msg = str(e)
            messagebox.showerror("D√∂n√º≈üt√ºrme Hatasƒ±", f"Hata olu≈ütu:\n\n{error_msg}")
            self.status_var.set("‚ùå D√∂n√º≈üt√ºrme hatasƒ±")
    
    def create_python_wrapper(self, bat_content):
        """BAT i√ßeriƒüi i√ßin Python wrapper olu≈ütur"""
        # BAT i√ßeriƒüini base64 ile encode et
        encoded_bat = base64.b64encode(bat_content.encode('utf-8')).decode('ascii')
        
        admin_request = ""
        if self.admin_var.get():
            admin_request = '''
import ctypes
import sys

def is_admin():
    try:
        return ctypes.windll.shell32.IsUserAnAdmin()
    except:
        return False

def run_as_admin():
    if is_admin():
        return True
    else:
        ctypes.windll.shell32.ShellExecuteW(None, "runas", sys.executable, " ".join(sys.argv), None, 1)
        return False

if not run_as_admin():
    sys.exit(0)
'''
        
        wrapper_code = f'''#!/usr/bin/env python3
# -*- coding: utf-8 -*-
"""
BAT to EXE Converter - Generated Executable
Created with BAT to EXE Converter v{self.version}
"""

import subprocess
import tempfile
import os
import base64
import sys
{admin_request}

def main():
    """Ana fonksiyon - BAT kodunu √ßalƒ±≈ütƒ±r"""
    try:
        # BAT i√ßeriƒüini decode et
        bat_content = base64.b64decode("{encoded_bat}").decode('utf-8')
        
        # Ge√ßici BAT dosyasƒ± olu≈ütur
        with tempfile.NamedTemporaryFile(mode='w', suffix='.bat', delete=False, encoding='utf-8') as temp_bat:
            temp_bat.write(bat_content)
            temp_bat_path = temp_bat.name
        
        # BAT dosyasƒ±nƒ± √ßalƒ±≈ütƒ±r
        process = subprocess.Popen(
            [temp_bat_path], 
            shell=True,
            cwd=os.path.dirname(os.path.abspath(sys.argv[0]))
        )
        process.wait()
        
    except Exception as e:
        print(f"Hata: {{e}}")
        input("Devam etmek i√ßin Enter'a basƒ±n...")
    finally:
        # Ge√ßici dosyayƒ± temizle
        try:
            if 'temp_bat_path' in locals() and os.path.exists(temp_bat_path):
                os.unlink(temp_bat_path)
        except:
            pass

if __name__ == "__main__":
    main()'''
        
        return wrapper_code

def main():
    """Ana program ba≈ülatƒ±cƒ±"""
    root = tk.Tk()
    app = BatToExeConverter(root)
    
    # Program kapanƒ±rken onay sor
    def on_closing():
        if messagebox.askokcancel("√áƒ±kƒ±≈ü", "Programdan √ßƒ±kmak istediƒüinizden emin misiniz?"):
            root.destroy()
    
    root.protocol("WM_DELETE_WINDOW", on_closing)
    root.mainloop()

if __name__ == "__main__":
    main()